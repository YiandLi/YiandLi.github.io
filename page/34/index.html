<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":20,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="A foolish, slow learner.">
<meta property="og:type" content="website">
<meta property="og:title" content="Yili">
<meta property="og:url" content="http://example.com/page/34/index.html">
<meta property="og:site_name" content="Yili">
<meta property="og:description" content="A foolish, slow learner.">
<meta property="og:locale">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/34/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Yili</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Yili</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Suggest Google Chrome for better math Reading.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/MySQL%20info/mysql%20DCL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/MySQL%20info/mysql%20DCL/" class="post-title-link" itemprop="url">mysql DCL Data Control Language</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-04 22:44:21" itemprop="dateCreated datePublished" datetime="2021-03-04T22:44:21+08:00">2021-03-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>59</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>1 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>DCLï¼šData Control Language æ•°æ®åº“æ§åˆ¶è¯­è¨€ï¼Œç”¨æ¥ç®¡ç†<strong>æ•°æ®åº“ç”¨æˆ·</strong>ï¼Œæ§åˆ¶<strong>æ•°æ®åº“çš„è®¿é—®æƒé™</strong>ã€‚</p>
<h2 id="ç®¡ç†ç”¨æˆ·"><a class="markdownIt-Anchor" href="#ç®¡ç†ç”¨æˆ·"></a> ç®¡ç†ç”¨æˆ·</h2>
<ol>
<li>æŸ¥è¯¢ç”¨æˆ·ï¼Œç›´æ¥æŸ¥è¯¢ user è¡¨</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use mysql</span><br><span class="line">select * from user;</span><br></pre></td></tr></table></figure>
<p>â€¦</p>
<p>ä¸çœ‹äº†ï¼Œè¯¦è§é»‘é©¬ç¨‹åºå‘˜ ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/%E5%A4%9A%E6%A8%A1%E6%80%81/detection-rcnn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/%E5%A4%9A%E6%A8%A1%E6%80%81/detection-rcnn/" class="post-title-link" itemprop="url">detection-rcnn</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-04 22:44:21" itemprop="dateCreated datePublished" datetime="2021-03-04T22:44:21+08:00">2021-03-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MultiModal/" itemprop="url" rel="index"><span itemprop="name">MultiModal</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>45</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>1 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI5MzUyMjcxNA==&amp;mid=2247501349&amp;idx=1&amp;sn=d412f585e8597897bac7aa1a6e2fb249&amp;chksm=ec725a50db05d3464113fb6ef1291632c019055789a052e594afc66723add0b16692cca998fa&amp;token=107209320&amp;lang=zh_CN#rd">Faster R-CNN ä¹‹æ•°æ®å¤„ç†</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI5MzUyMjcxNA==&amp;mid=2247501325&amp;idx=1&amp;sn=6480884d9952baa7f43fc0724882aed1&amp;chksm=ec725a78db05d36e1af470a54b433f7c5a173ed7f6e5cead897eb6183331038bb94d128b3208&amp;token=107209320&amp;lang=zh_CN#rd">äºŒé˜¶æ®µç›®æ ‡æ£€æµ‹ä»‹ç» â€“ äºŒé˜¶æ®µç›®æ ‡æ£€æµ‹ç®—æ³•ï¼ˆRCNN å®¶æ—ï¼‰</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI5MzUyMjcxNA==&amp;mid=2247501191&amp;idx=1&amp;sn=0c701117c7fb78de8b4fcd2aacc25475&amp;chksm=ec7259f2db05d0e4a59bdcb95d88777780aa8848ff462451a81606971a3af1bb028de483241b&amp;token=107209320&amp;lang=zh_CN#rd">Faster RCNN ä¸­æ ¸å¿ƒ RPN åŸç†è§£æ</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43702653/article/details/123973629">https://blog.csdn.net/weixin_43702653/article/details/123973629</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/%E5%A4%9A%E6%A8%A1%E6%80%81/multi-moddal%20backbones/Multi-Modal-backbone/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/%E5%A4%9A%E6%A8%A1%E6%80%81/multi-moddal%20backbones/Multi-Modal-backbone/" class="post-title-link" itemprop="url">Multi-Modal-backbone</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-04 22:44:21" itemprop="dateCreated datePublished" datetime="2021-03-04T22:44:21+08:00">2021-03-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MultiModal/" itemprop="url" rel="index"><span itemprop="name">MultiModal</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>6.3k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>32 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/625926419">å¤šæ¨¡æ€å¤§æ¨¡å‹è¶…è¯¦ç»†è§£è¯» (ç›®å½•)</a></p>
<p><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1728963852075046389&amp;wfr=spider&amp;for=pc">äº”èŠ±å…«é—¨çš„å¤šæ¨¡æ€æ¨¡å‹å¦‚ä½•é€‰æ‹©ï¼Ÿprofile-avatar</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/622220960">[è®ºæ–‡æ¦‚è§ˆ] | å¤šæ¨¡æ€å¤§æ¨¡å‹è¿›å±•æ¦‚è§ˆ</a></p>
<p>ç›®å½•ï¼š<br />
- <a href="#click_me_jump1">Clip - ICML 2021</a><br />
- <a href="#click_me_jump2">ViLT - ICML 2021</a><br />
- <a href="#click_me_jump3">ALBEF - NeurIPS 2021</a><br />
- <a href="#click_me_jump4">Flamingo - CVPR 2022</a><br />
- <a href="#click_me_jump5">METER - CVPR 2022</a><br />
- <a href="#click_me_jump6">CoCa - 2022</a><br />
-</p>
<p><span id="click_me_jump1"></span></p>
<h1 id="clip"><a class="markdownIt-Anchor" href="#clip"></a> Clip</h1>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/625165635">å¤šæ¨¡æ€è¶…è¯¦ç»†è§£è¯» (ä¸€)ï¼šCLIPï¼šå¤§è§„æ¨¡è¯­è¨€-å›¾åƒå¯¹æ¯”é¢„è®­ç»ƒå®ç°ä¸ä¿— Zero-Shot æ€§èƒ½</a></p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2103.00020.pdf">OpenAI : Learning Transferable Visual Models From Natural Language Supervision (ICML 2021)</a><br />
<a target="_blank" rel="noopener" href="https://github.com/OpenAI/CLIP">https://github.com/OpenAI/CLIP</a></p>
<p>åŠ¨æœºï¼šGPT3 çš„å‡ºç°ï¼Œè®© zero-shot nlp tasks æˆä¸ºå¯èƒ½ï¼Œä½†æ˜¯CV ä¸­å¤§å®¶è¿˜åœ¨ä½¿ç”¨é«˜è´¨é‡ï¼Œå¯†é›†æ ‡æ³¨æ•°æ®é›† (å¦‚ ImageNet-1K) è¿›è¡Œé¢„è®­ç»ƒï¼Œ zero-shot æ•ˆæœå·®ã€‚æ‰€ä»¥è¿™é‡Œæå‡ºä½¿ç”¨è‡ªç„¶è¯­è¨€æ¥ç›‘ç£ï¼Œè¿›è¡Œå›¾åƒè¡¨å¾å­¦ä¹ çš„å·¥ä½œã€‚</p>
<p>äº’è”ç½‘ä¸Šå­˜åœ¨å¤§é‡å…¬å¼€å¯ç”¨çš„æ— æ ‡æ³¨æ–‡æœ¬æ•°æ®é›†ï¼Œä½œè€…åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«4äº¿å¯¹ (å›¾åƒï¼Œæ–‡æœ¬) çš„æ–°å›¾åƒåˆ†ç±»æ•°æ®é›†ï¼Œå¹¶é€šè¿‡å¯¹æ¯”è¯­è¨€-å›¾åƒé¢„è®­ç»ƒçš„æ–¹å¼è®­ç»ƒäº† CLIP æ¨¡å‹ã€‚</p>
<h2 id="webimagetext-wit-æ•°æ®é›†"><a class="markdownIt-Anchor" href="#webimagetext-wit-æ•°æ®é›†"></a> WebImageText (WIT) æ•°æ®é›†</h2>
<p>åŒ…å«4äº¿å¯¹ (å›¾åƒï¼Œæ–‡æœ¬) å¯¹ï¼Œè¿™äº›æ•°æ®æ¥è‡ªäº’è”ç½‘ä¸Šå„ç§å…¬å¼€å¯ç”¨çš„èµ„æºã€‚<br />
è€Œä¸”è¿™ä¸ªæ•°æ®æ¸…ç†å¾—éå¸¸å¥½ï¼Œè´¨é‡æ˜¯éå¸¸é«˜çš„ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯ CLIP è¿™ä¹ˆå¼ºå¤§çš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚<br />
ç»“æœæ•°æ®é›†çš„æ€»å­—æ•°ä¸ç”¨äºè®­ç»ƒ GPT-2 çš„ WebText æ•°æ®é›†ç›¸ä¼¼ï¼Œå› æ­¤ä½œè€…å°†æ­¤æ•°æ®é›†ç§°ä¸º WebImageText (WIT)ã€‚</p>
<h2 id="é¢„è®­ç»ƒæ–¹æ³•"><a class="markdownIt-Anchor" href="#é¢„è®­ç»ƒæ–¹æ³•"></a> é¢„è®­ç»ƒæ–¹æ³•</h2>
<p><strong>æ¢ç´¢</strong></p>
<p>ä¸€å¼€å§‹çš„æ–¹æ³•æ˜¯è”åˆè®­ç»ƒäº†ä¸€ä¸ªå¤„ç†å›¾åƒçš„ CNN å’Œä¸€ä¸ªå¤„ç†æ–‡æœ¬çš„ Transformer æ¨¡å‹ï¼Œæ¥é¢„æµ‹å›¾åƒçš„ caption  ï¼Œä½†æ˜¯æ•ˆæœä¸å¥½ï¼Œè¡¨ç°ä¸º Scalability å¾ˆå·®ï¼Œå³æ•ˆç‡ï¼ˆæ¶¨ç‚¹é€Ÿåº¦ï¼‰ä½ã€‚</p>
<p>åŸå› ï¼šè¯•å›¾å»é¢„æµ‹æ¯å¹…å›¾ç‰‡å¯¹åº”çš„æ–‡å­—çš„ç¡®åˆ‡å•è¯æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªä»»åŠ¡æ¯”è¾ƒéš¾ã€‚</p>
<p>å¯ä»¥ä»…é¢„æµ‹æ•´ä¸ªæ–‡æœ¬ä¸å“ªä¸ªå›¾åƒé…å¯¹ï¼Œè€Œä¸æ˜¯è¯¥æ–‡æœ¬çš„ç¡®åˆ‡å•è¯ï¼Œå³å¯¹æ¯”å­¦ä¹ ï¼Œå‘ç°æ•ˆæœå¾ˆå¥½ã€‚</p>
<p><strong>é¢„è®­ç»ƒå¯¹æ¯”å­¦ä¹ </strong></p>
<p>ä¸€ä¸ª size-<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> batch çš„ (å›¾ç‰‡ï¼Œæ–‡æœ¬æè¿°) ï¼Œåˆ†åˆ«ä½¿ç”¨ Image Encoder å’Œ Text Encoder å¾—åˆ°è¡¨å¾ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext>Â </mtext><msub><mi>I</mi><mn>2</mn></msub><mo separator="true">,</mo><mtext>Â </mtext><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mtext>Â </mtext><msub><mi>I</mi><mi>N</mi></msub><mspace linebreak="newline"></mspace><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext>Â </mtext><msub><mi>T</mi><mn>2</mn></msub><mo separator="true">,</mo><mtext>Â </mtext><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mtext>Â </mtext><msub><mi>T</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">I_1,\ I_2,\ ...\ I_N \\
T_1,\ T_2,\ ...\ T_N
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>ç„¶åå¯¹è§’çº¿ä¸ºæ­£æ ·æœ¬å¯¹ï¼Œå…¶ä½™ä¸ºè´Ÿæ ·æœ¬å¯¹ï¼Œè¿›è¡Œ in-batch contrastive learning ï¼š<br />
<img src="https://pic1.zhimg.com/80/v2-65e1dbb935aa7804189dc100783a4940_1440w.webp" alt="" /></p>
<p><img src="https://cdn.mathpix.com/snip/images/ewTuOEvhtKYZ2_i5jnV2wRJxnQLX0GIgUtI9XcidxNU.original.fullsize.png" alt="" /></p>
<p><strong>æ¨¡å‹</strong><br />
Image Encoder: ResNet &gt; ViT<br />
Text Encoder: Transformer , æ–‡æœ¬åºåˆ—ç”¨ [SOS] å’Œ [EOS] ä»¤ç‰Œæ‹¬èµ·æ¥ï¼Œ[EOS] å¤„ Transformer æœ«å±‚çš„è¾“å‡ºè¢«è§†ä¸ºæ–‡æœ¬çš„ç‰¹å¾ ã€‚</p>
<p>ä½œè€…å‘ç° CLIP çš„æ€§èƒ½</p>
<ul>
<li>å¯¹äºæ–‡æœ¬ç¼–ç å™¨çš„å®¹é‡ä¸å¤ªæ•æ„Ÿã€‚</li>
<li>å¯¹äºå›¾åƒç¼–ç å™¨ ResNetï¼ŒåŒæ—¶ç¼©æ”¾å…¶æ·±åº¦ï¼Œå®½åº¦ï¼Œå’Œè¾“å…¥åˆ†è¾¨ç‡çš„æ•ˆæœæ˜¯æœ€ä¼˜çš„ã€‚</li>
</ul>
<p><strong>è®­ç»ƒæ–¹å¼</strong><br />
ä»å¤´è®­ç»ƒ: ä¸é¢„å…ˆåŠ è½½  Image Encoder &amp; Text Encoder ã€‚<br />
ä½¿ç”¨çº¿æ€§æŠ•å½±: æƒé‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub><mo separator="true">,</mo><mtext>Â </mtext><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">W_i,\ W_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œ å°†æ¯ä¸ªç¼–ç å™¨çš„è¡¨å¾æ˜ å°„åˆ°å¤šæ¨¡æ€çš„åµŒå…¥ç©ºé—´ã€‚<br />
<strong>æ•°æ®å¢å¼º: åªä½¿ç”¨éšæœºè£å‰ªï¼Œæ¸©åº¦ç³»æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï„</mi></mrow><annotation encoding="application/x-tex">Ï„</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">Ï„</span></span></span></span> çš„å¯¹æ•°å½¢å¼éšæ•´ä¸ªæ¨¡å‹ä¸€èµ·è®­ç»ƒã€‚</strong></p>
<p><strong>Zero-Shot Transfer</strong><br />
ä½¿ç”¨ CLIP çš„é¢„è®­ç»ƒå¥½çš„ Image Encoder å’Œ Text Encoder æ¥åš Zero-Shot Transferã€‚</p>
<p>Image Encoder æ˜¯æ²¡æœ‰åˆ†ç±»å¤´ (æœ€åçš„ Classifier) çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ²¡æ³•ç›´æ¥å»åšåˆ†ç±»ä»»åŠ¡ï¼Œæ‰€ä»¥è¯´å‘¢ CLIP é‡‡ç”¨äº†ä¸‹é¢çš„ Prompt Template æ¨¡å¼ï¼š</p>
<ul>
<li>å¾…åˆ†ç±»å›¾åƒ ğŸŒ„ï¼šå–‚å…¥ CLIP é¢„è®­ç»ƒå¥½çš„ Image Encoderï¼Œå¾—åˆ°ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></li>
<li>å€™é€‰åˆ†ç±»æ–‡æœ¬æ ‡ç­¾ ğŸ·ï¸ï¼šæŠŠæ‰€æœ‰ç±»åˆ«çš„è¯æ±‡ â€œcatâ€, â€œdogâ€ ç­‰ï¼Œåšæˆä¸€ä¸ª promptï¼š<strong>â€œA photo of a {object}â€</strong> ï¼Œå–‚å…¥ CLIP é¢„è®­ç»ƒå¥½çš„ Text Encoderï¼Œä¾æ¬¡å¾—åˆ°ç‰¹å¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>T</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">T_1, T_2, ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></li>
<li>ç‚¹ä¹˜ç›¸ä¼¼åº¦ ï¼Œå¾—åˆ°åˆ†æ•°æœ€é«˜çš„ä¸€å¯¹ï¼Œå–å…¶æ ‡ç­¾ ã€‚</li>
</ul>
<p>è¿™é‡Œ Prompt æ¨¡ç‰ˆé¿å…äº† OOVï¼Œ åŒæ—¶è®¾è®¡é‡è¦ï¼š</p>
<ul>
<li>å¯¹äºç»†ç²’åº¦å›¾åƒåˆ†ç±»ä»»åŠ¡ï¼Œæ¯”å¦‚ Oxford-IIIT Pets æ•°æ®é›†ï¼Œprompt å°±å¯ä»¥è®¾ç½®ä¸ºï¼š<strong>â€œA photo of a {label}, a type of pet.â€</strong> ã€‚æ¯”å¦‚ Food101 æ•°æ®é›†ï¼Œprompt å°±å¯ä»¥è®¾ç½®ä¸ºï¼š<strong>â€œA photo of a {label}, a type of food.â€</strong> ã€‚<br />
æ¯”å¦‚ FGVC Aircraft æ•°æ®é›†ï¼Œprompt å°±å¯ä»¥è®¾ç½®ä¸ºï¼š&quot;<strong>A photo of a {label}, a type of aircraft.&quot;</strong> ã€‚</li>
<li>å¯¹äº OCR ä»»åŠ¡ï¼ŒåŠ ä¸Šä¸€äº›æ–‡æœ¬æˆ–è€…æ•°å­—çš„å¼•å·å¯ä»¥æå‡æ€§èƒ½ã€‚</li>
<li>å¯¹äºå«æ˜Ÿå›¾åƒåˆ†ç±»æ•°æ®é›†ï¼Œprompt å°±å¯ä»¥è®¾ç½®ä¸ºï¼š<strong>â€œa satellite photo of a {label}.â€</strong> ã€‚</li>
</ul>
<p>ä¹Ÿå¯ä»¥é€‰æ‹©ä¸åŒ prompt æ¨¡ç‰ˆå°†ç»“æœè¿›è¡Œ resemble ã€‚</p>
<p><strong>Zero-Shot CLIP ä¸å®Œå…¨ç›‘ç£çš„åŸºçº¿ ResNet-50 ç›¸æ¯”</strong></p>
<ul>
<li>é€šç”¨æ•°æ®é›†æ•ˆæœå¾ˆå¥½</li>
<li>ä¸€äº›ä¸“ä¸šã€å¤æ‚æˆ–æŠ½è±¡çš„ä»»åŠ¡ä¸Šç›¸å½“å¼±</li>
</ul>
<p><span id="click_me_jump2"></span></p>
<h1 id="vilt"><a class="markdownIt-Anchor" href="#vilt"></a> ViLT</h1>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/626163710">å¤šæ¨¡æ€è¶…è¯¦ç»†è§£è¯» (äºŒ)ï¼šViLTï¼šä¸€ç§æç®€å¤šæ¨¡æ€å­¦ä¹ æ¡†æ¶ Baseline</a><br />
<a target="_blank" rel="noopener" href="https://github.com/NielsRogge/Transformers-Tutorials/blob/master/ViLT/Fine_tuning_ViLT_for_VQA.ipynb">Fine-tuning ViLT For visual question answering (VQA)</a></p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2102.03334.pdf">ViLT: Vision-and-Language Transformer Without Convolution or Region Supervision (ICML 2021)</a><br />
<a target="_blank" rel="noopener" href="https://github.com/dandelin/vilt">https://github.com/dandelin/vilt</a></p>
<p>å¤šæ¨¡æ€èåˆç»å†ä¸¤ä¸ªéƒ¨åˆ† ï¼š</p>
<ol>
<li>ç‰¹å¾æŠ½å–ï¼šåˆ†åˆ«å¾—åˆ° image feature å’Œ text feature</li>
<li>ç‰¹å¾èåˆï¼šå°†  image feature å’Œ text feature è¿›è¡Œèåˆï¼Œå¾—åˆ°èåˆç‰¹å¾ã€‚</li>
</ol>
<p><strong>å¤šæ¨¡æ€æ¨¡å‹åˆ†ç±»ï¼š</strong></p>
<p><img src="https://pic1.zhimg.com/80/v2-eda11a93af82d3d7a17df87631a77e84_720w.webp" alt="" /></p>
<p>VE: Visual Encoder<br />
TE: Text Encoder<br />
MI: Modality Interaction</p>
<p>(a) : VE å å¤§éƒ¨åˆ†ç®—åŠ›ï¼ŒMI ç”¨ç®€å•çš„ç‚¹ç§¯æˆ–æµ…æ³¨æ„å±‚æ¥è¡¨å¾ä¸¤ç§æ¨¡æ€ä¸­ç‰¹å¾çš„ç›¸ä¼¼æ€§ï¼Œi.e. VSE++ , SCAN</p>
<p>(b) : è§†è§‰æ¨¡å‹å’Œæ–‡æœ¬æ¨¡å‹éƒ½ä½¿ç”¨è¾ƒå¤§ç®—åŠ›ï¼Œç”¨ç®€å•çš„ç‚¹ç§¯æˆ–æµ…æ³¨æ„å±‚æ¥è¡¨å¾ä¸¤ç§æ¨¡æ€ä¸­ç‰¹å¾çš„ç›¸ä¼¼æ€§ï¼Œä»£è¡¨æ¨¡å‹æ˜¯ CLIP ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¯¹äºè§†è§‰-è¯­è¨€ä¸‹æ¸¸ä»»åŠ¡æ€§èƒ½å¾ˆå·®ï¼Œæ¯”å¦‚ CLIP åœ¨ NLVR2 æ•°æ®é›†ä¸Šé¢æ€§èƒ½è¾ƒå·®ï¼Œè¯´æ˜çºµä½¿å•ä¸€æ¨¡æ€çš„ç¼–ç å™¨å¾ˆå¥½ï¼Œä½†æ˜¯å¯¹å…¶è¾“å‡ºçš„ç®€å•èåˆå¯èƒ½ä¹Ÿä¸è¶³ä»¥å­¦ä¹ å¤æ‚çš„è§†è§‰å’Œè¯­è¨€ä»»åŠ¡ï¼Œè¿™å¯èƒ½å°±éœ€è¦æˆ‘ä»¬å»ç ”ç©¶æ›´ä¸¥æ ¼çš„è·¨æ¨¡æ€äº¤äº’æ–¹æ¡ˆäº†ã€‚</p>
<p>Â© : è§†è§‰æ¨¡å‹å å¤§éƒ¨åˆ†ç®—åŠ›ï¼Œä½¿ç”¨ Transformer å¯¹å›¾åƒå’Œæ–‡æœ¬ç‰¹å¾çš„äº¤äº’è¿›è¡Œå»ºæ¨¡ï¼Œä»£è¡¨æ¨¡å‹æ˜¯ FiLM å’Œ MoVie</p>
<p>(d) : æœ¬æ–‡çš„ ViLT ï¼Œè§†è§‰æ¨¡å‹å’Œæ–‡æœ¬æ¨¡å‹éƒ½æå…¶ç®€å•ï¼ˆé¦–ä¸ªå°†VEè®¾è®¡çš„å¦‚TEä¸€æ ·è½»é‡çš„æ–¹æ³•ï¼‰ï¼Œå¤§éƒ¨åˆ†è®¡ç®—åŠ›é›†ä¸­åœ¨æ¨¡æ€çš„äº¤äº’ä¸Šé¢ï¼Œä½¿ç”¨ Transformer å¯¹å›¾åƒå’Œæ–‡æœ¬ç‰¹å¾çš„äº¤äº’è¿›è¡Œå»ºæ¨¡ ã€‚</p>
<p><strong>æ¨¡æ€äº¤äº’æ–¹å¼åˆ†ç±»ï¼š</strong></p>
<ol>
<li>å•å¡”äº¤æ¢ï¼šæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç»™åˆ° transformerï¼Œe.g. ViLT &amp; VisualBERT &amp; UNITER</li>
<li>åŒå¡”äº¤äº’ï¼še.g. CLIP &amp; ViLBERT &amp; LXMERT</li>
</ol>
<br>
<p><strong>åŠ¨æœºï¼š</strong><br />
å½“å‰å¸¸ç”¨çš„å¤šæ¨¡æ€èåˆæ¨¡å‹ä¸€èˆ¬éœ€è¦ä½¿ç”¨ä¸€ä¸ª big image encoder æ¥å¤„ç†å›¾ç‰‡ï¼Œæ¯”å¦‚é¢„å…ˆè¿›è¡Œç›®æ ‡æ£€æµ‹ä»»åŠ¡æå– image region feature ï¼Œç›¸æ¯”ä¹‹ä¸‹  text encoder çš„è®¡ç®—é‡å°±æ¯”è¾ƒå°äº†ã€‚</p>
<p>å¹³å¸¸åšå®éªŒçš„æ—¶å€™ï¼Œè§†è§‰ Encoder æå–åˆ°çš„ region feature å¯ä»¥æå‰ç¼“å­˜ï¼Œä»¥å‡å°è®­ç»ƒæ—¶çš„è´Ÿæ‹…ã€‚ä½†æ˜¯åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œåœ¨é¢å¯¹æ–°æ•°æ®é›†çš„æ—¶å€™ï¼Œè¿˜æ˜¯å¿…é¡» <strong>ç»å†ä¸€ä¸ªç¼“æ…¢çš„æå– region feature çš„è¿‡ç¨‹</strong> ã€‚</p>
<p>visual embeddingçš„æ–¹æ³•æ€»å…±æœ‰ä¸‰å¤§ç±»ï¼š</p>
<ul>
<li>region featureæ–¹æ³•é€šå¸¸é‡‡ç”¨Faster R-CNNäºŒé˜¶æ®µæ£€æµ‹å™¨æå–regionçš„ç‰¹å¾</li>
<li>grid featureæ–¹æ³•ç›´æ¥ä½¿ç”¨CNNæå–gridçš„ç‰¹å¾</li>
<li>patch projectionæ–¹æ³•å°†è¾“å…¥å›¾ç‰‡åˆ‡ç‰‡æŠ•å½±æå–ç‰¹å¾ã€‚ViLTæ˜¯é¦–ä¸ªä½¿ç”¨patch projectionæ¥åšvisual embeddingçš„æ–¹æ³•ã€‚</li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-c94fc0e580ad16d68bceb535634d93a5_1440w.webp" alt="" /></p>
<ol>
<li>Convolution-Free Feature Extraction: ç›´æ¥ä½¿ç”¨ Patch Embedding ç¼–ç å›¾åƒï¼Œæ— éœ€ç›®æ ‡æ£€æµ‹ï¼›åŒæ—¶ç›´æ¥ Token Embedding ç¼–ç æ–‡æœ¬ï¼Œå°†æ¯ä¸ªæ¨¡æ€çš„ç‰¹å¾æŠ½å–éƒ¨åˆ†æœ€å°åŒ– ï¼›</li>
<li>ViT based Feature Interaction ï¼šæŠŠä¸»è¦çš„è®¡ç®—é‡éƒ½æ”¾åœ¨äº†ç‰¹å¾èåˆéƒ¨åˆ† ã€‚</li>
</ol>
<h2 id="æ¨¡å‹"><a class="markdownIt-Anchor" href="#æ¨¡å‹"></a> æ¨¡å‹</h2>
<p>å¯¹äºæƒé‡ä»¥ ViT-B/32 çš„é¢„è®­ç»ƒæƒé‡åšåˆå§‹åŒ–æ¨¡å‹ ViLT-B/32, éšç»´åº¦å¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> ä¸º 768 , æ·±åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> ä¸º 12, Patch å¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> ä¸º 32 , MLP ä¸­é—´å°ºå¯¸å¤§å°ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>768</mn><mo>=</mo><mn>3072</mn></mrow><annotation encoding="application/x-tex">4 \times 768=3072</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">7</span><span class="mord">2</span></span></span></span>, æ³¨æ„åŠ› head æ•°ä¸º 12 ã€‚</p>
<p><img src="https://pic3.zhimg.com/v2-796f44eae0f53d548feb46c0787913da_b.jpg" alt="" /></p>
<p>å…¬å¼ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>t</mi><mo>Ë‰</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><msub><mi>t</mi><mtext>classÂ </mtext></msub><mo separator="true">;</mo><msub><mi>t</mi><mn>1</mn></msub><mi>T</mi><mo separator="true">;</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">;</mo><msub><mi>t</mi><mi>L</mi></msub><mi>T</mi><mo fence="true">]</mo></mrow><mo>+</mo><msup><mi>T</mi><mtext>posÂ </mtext></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>v</mi><mo>Ë‰</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><msub><mi>v</mi><mtext>classÂ </mtext></msub><mo separator="true">;</mo><msub><mi>v</mi><mn>1</mn></msub><mi>V</mi><mo separator="true">;</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">;</mo><msub><mi>v</mi><mi>N</mi></msub><mi>V</mi><mo fence="true">]</mo></mrow><mo>+</mo><msup><mi>V</mi><mtext>posÂ </mtext></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>z</mi><mn>0</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mover accent="true"><mi>t</mi><mo>Ë‰</mo></mover><mo>+</mo><msup><mi>t</mi><mtext>typeÂ </mtext></msup><mo separator="true">;</mo><mover accent="true"><mi>v</mi><mo>Ë‰</mo></mover><mo>+</mo><msup><mi>v</mi><mtext>typeÂ </mtext></msup><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mover accent="true"><mi>z</mi><mo>^</mo></mover><mi>d</mi></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">MSA</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><mi mathvariant="normal">LN</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msup><mi>z</mi><mrow><mi>d</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>+</mo><msup><mi>z</mi><mrow><mi>d</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><mtext>Â </mtext><mi>d</mi><mo>=</mo><mn>1...</mn><mi>D</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>z</mi><mi>d</mi></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">MLP</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><mi mathvariant="normal">LN</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msup><mover accent="true"><mi>z</mi><mo>^</mo></mover><mi>d</mi></msup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>+</mo><msup><mover accent="true"><mi>z</mi><mo>^</mo></mover><mi>d</mi></msup><mo separator="true">,</mo><mtext>Â </mtext><mi>d</mi><mo>=</mo><mn>1...</mn><mi>D</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>p</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>tanh</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msubsup><mi>z</mi><mn>0</mn><mi>D</mi></msubsup><msub><mi>W</mi><mtext>poolÂ </mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\bar{t} &amp; =\left[t_{\text {class }} ; t_1 T ; \cdots ; t_L T\right]+T^{\text {pos }} \\
\bar{v} &amp; =\left[v_{\text {class }} ; v_1 V ; \cdots ; v_N V\right]+V^{\text {pos }} \\
z^0 &amp; =\left[\bar{t}+t^{\text {type }} ; \bar{v}+v^{\text {type }}\right] \\
\hat{z}^d &amp; =\operatorname{MSA}\left(\operatorname{LN}\left(z^{d-1}\right)\right)+z^{d-1},\ d=1...D \\
z^d &amp; =\operatorname{MLP}\left(\operatorname{LN}\left(\hat{z}^d\right)\right)+\hat{z}^d,\ d=1...D  \\
p &amp; =\tanh \left(z_0^D W_{\text {pool }}\right)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.193655em;vertical-align:-4.3468275em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8468275em;"><span style="top:-7.0068275em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.75186em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">t</span></span></span><span style="top:-3.18408em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">Ë‰</span></span></span></span></span></span></span></span></span><span style="top:-5.506827499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">Ë‰</span></span></span></span></span></span></span></span></span><span style="top:-3.982719499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span><span style="top:-2.4236114999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-0.8645034999999992em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:0.6868274999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:4.3468275em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8468275em;"><span style="top:-7.0068275em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">classÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">posÂ </span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-5.506827499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">classÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">posÂ </span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.982719499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.75186em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">t</span></span></span><span style="top:-3.18408em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">Ë‰</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">typeÂ </span></span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">Ë‰</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">typeÂ </span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span><span style="top:-2.4236114999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mord mathrm">M</span><span class="mord mathrm">S</span><span class="mord mathrm">A</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mop"><span class="mord mathrm">L</span><span class="mord mathrm">N</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-0.8645034999999992em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mord mathrm">M</span><span class="mord mathrm">L</span><span class="mord mathrm">P</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mop"><span class="mord mathrm">L</span><span class="mord mathrm">N</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:0.6868274999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">tanh</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">poolÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:4.3468275em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>
<p>Text Encoder :  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>Ë‰</mo></mover><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mo stretchy="false">(</mo><mi>L</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>H</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{t} \in \mathbb R ^ {(L+1) \times H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79096em;vertical-align:-0.0391em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.75186em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">t</span></span></span><span style="top:-3.18408em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">Ë‰</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">L</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>bert-base-uncased tokenizer</li>
<li>Word Embedding</li>
<li>add Text cls token :  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{class}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œæ–¹ä¾¿å’Œä¸‹æ¸¸ä»»åŠ¡å¯¹æ¥ã€‚</li>
<li>add Text Positional Embedding <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mtext>posÂ </mtext></msup></mrow><annotation encoding="application/x-tex">T^{\text {pos }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">posÂ </span></span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>
<p>Visual Encoder : <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>Ë‰</mo></mover><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>H</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{v} \in \mathbb R ^ {(N+1)\times H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.60688em;vertical-align:-0.0391em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">Ë‰</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">Ã—</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>Linear Projection Patch Embedding : flatten to 1-d patch vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>Ã—</mo><mo stretchy="false">(</mo><msup><mi>P</mi><mn>2</mn></msup><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N \times (P^2 C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span> , then linear projection <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>Ã—</mo><mo stretchy="false">(</mo><msup><mi>P</mi><mn>2</mn></msup><mi>C</mi><mo stretchy="false">)</mo><mo>â†’</mo><mi>N</mi><mo>Ã—</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">N \times (P^2 C)\rightarrow N \times H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> ï¼Œè¿™é‡Œéœ€è¦è®©æœ€ç»ˆçš„ç»´åº¦å’Œ text embedding ç»´åº¦å¯¹é½ã€‚</li>
<li>add Visual cls token :  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v_{class}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>add Visual Positional Embedding $V^{\text {pos }} $</li>
</ul>
</li>
<li>
<p>Transformer-based Modality Interaction Encoder : ViT-B/32 æƒé‡åˆå§‹åŒ– w/o Patch Projectionåˆå§‹åŒ–ï¼ˆå®éªŒå‘ç° bert åˆå§‹åŒ–æ•ˆæœä¸å¥½ï¼‰</p>
<ul>
<li>add type embedding : åŒºåˆ†ç‰¹å¾ç±»å‹ï¼Œå³è¡¨ç¤ºæ¨¡æ€çš„å˜é‡</li>
<li>concatenate for transformer input  : <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>z</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">z^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></li>
<li>TRM : ä¸€å…± D å±‚ï¼›éµå¾ª bert ç»“æ„ï¼Œæ¯å±‚ MSA + MLP ã€‚</li>
<li>output : è¾“å‡ºçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>z</mi><mn>0</mn><mi>D</mi></msubsup></mrow><annotation encoding="application/x-tex">z_0^D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894389999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span> é€šè¿‡ä¸€ä¸ªä¸€ä¸ªçº¿æ€§å˜æ¢ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>p</mi><mi>o</mi><mi>o</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{pool}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>tanh</mtext></mrow><annotation encoding="application/x-tex">\text{tanh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">tanh</span></span></span></span></span> å‡½æ•°å¾—åˆ°è¾“å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> ã€‚</li>
</ul>
</li>
</ul>
<h2 id="é¢„è®­ç»ƒç›®æ ‡"><a class="markdownIt-Anchor" href="#é¢„è®­ç»ƒç›®æ ‡"></a> é¢„è®­ç»ƒç›®æ ‡</h2>
<ol>
<li>
<p>Image Text Matching (ITM)ï¼š<br />
éšæœºä»¥ 0.5 çš„æ¦‚ç‡å°†æ–‡æœ¬å¯¹åº”çš„å›¾ç‰‡ <strong>æ›¿æ¢æˆä¸åŒçš„å›¾ç‰‡</strong> ï¼Œç„¶åå¯¹æ–‡æœ¬æ ‡å¿—ä½å¯¹åº”è¾“å‡ºä½¿ç”¨ä¸€ä¸ªçº¿æ€§çš„ ITM head å°†è¾“å‡º <strong>Text cls token</strong> æ˜ å°„æˆä¸€ä¸ªäºŒå€¼ logitsï¼Œç”¨æ¥åˆ¤æ–­å›¾åƒæ–‡æœ¬æ˜¯å¦åŒ¹é…ã€‚</p>
</li>
<li>
<p>word patch alignment (WPA) ï¼šè®¡ç®— textual subset å’Œ visual subset çš„å¯¹é½åˆ†æ•°<br />
é€šè¿‡ æœ€ä¼˜è¿è¾“ç†è®º optimal transport æ¥è®¡ç®—æ–‡æœ¬ç‰¹å¾å’Œå›¾åƒç‰¹å¾çš„ç›¸ä¼¼åº¦ï¼ŒæŠŠè¿™é‡Œçš„è¿™äº›æ–‡æœ¬è¾“å‡ºï¼Œå’Œå›¾åƒçš„è¾“å‡ºå½“åšä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œç„¶åè®¡ç®—ä¸€ä¸‹ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œå› ä¸ºè¾“å…¥æ˜¯ä¸€ä¸ªæ–‡æœ¬å›¾åƒå¯¹ï¼Œé‚£ä¹ˆæŒ‰é“ç†æ¥è¯´åº”è¯¥æ˜¯åŒ¹é…çš„ï¼Œæ‰€ä»¥ä½œè€…ä¹Ÿå¸Œæœ› word patch alignmentè¿™é‡Œçš„è·ç¦»ï¼Œè¶Šå°è¶Šå¥½ã€‚</p>
</li>
<li>
<p>Whole Word Masking - Masked Language Modeling (MLM)ï¼šå’Œ BERT ä¸€æ ·ï¼Œéšæœºä»¥ 0.15 çš„æ¦‚ç‡ mask æ‰tokens ã€‚</p>
</li>
</ol>
<p>Trickï¼š</p>
<ul>
<li>Textï¼šwhole word masking<br />
å…¶å®å›¾åƒè¿™é‡Œä½œè€…ä¹Ÿå°è¯•äº†é‡å»º lossï¼Œæ•ˆæœä¸€èˆ¬ã€‚</li>
<li>Imageï¼šæ•°æ®å¢å¼ºï¼Œrand-augment w/o color inversion &amp; cutout ï¼Œä¿è¯äº†å›¾åƒå’Œæ–‡æœ¬è¿˜èƒ½å°½å¯èƒ½çš„åŒ¹é…åœ¨ä¸€èµ·ï¼Œä¸ä¼šæœ‰å¤ªå¤§çš„å‡ºå…¥ã€‚</li>
</ul>
<blockquote>
<p>åœ¨ä¹‹å‰çš„é‚£äº›å¤šæ¨¡æ€çš„æ–¹æ³•é‡Œï¼Œå°¤å…¶æ˜¯å›¾2 cé‡Œç”»çš„é‚£äº›å€Ÿé‰´äºç›®æ ‡æ£€æµ‹çš„å¤šæ¨¡æ€å­¦ä¹ ï¼Œå®ƒäº†æ˜¯æ²¡æ³•ä½¿ç”¨æ•°æ®å¢å¼ºçš„ï¼Œå› ä¸ºä»–ä»¬åœ¨è®­ç»ƒçš„æ—¶å€™äº†ï¼Œéƒ½æ˜¯æå‰æŠŠç‰¹å¾æŠ½å‡ºæ¥ï¼Œå­˜åœ¨æœ¬åœ°ç¡¬ç›˜é‡Œï¼ŒåŸå›¾é•¿ä»€ä¹ˆæ ·ï¼Œç‰¹å¾å°±æ˜¯ä»€ä¹ˆæ ·ï¼Œå¦‚æœä½ éœ€è¦æŠŠåŸå›¾åšæ•°æ®å¢å¼ºï¼Œé‚£ä½ çš„ç‰¹å¾å°±å¾—é‡æ–°æŠ½å–ï¼Œè¿™ä¼šå˜å¾—å¾ˆéº»çƒ¦è€Œä¸”å¾ˆè´µï¼Œæ‰€ä»¥æ²¡äººè¿™ä¹ˆåšè¿‡ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æ‰€æœ‰ä¹‹å‰çš„å·¥ä½œï¼Œå“ªæ€•åˆ°2021å¹´çš„å·¥ä½œï¼Œéƒ½æ²¡æœ‰ç”¨æ•°æ®å¢å¼ºï¼Œè¿™æ˜¯ä¸æ˜¯å¬èµ·æ¥å°±å¾ˆä¸åˆç†ï¼Œæ˜æ˜ä½ çŸ¥é“æ•°æ®å¢å¼ºå¾ˆæœ‰ç”¨ï¼Œé‚£ä½ ä¸ç”¨ã€‚</p>
</blockquote>
<h2 id="å®éªŒ-å¾®è°ƒ"><a class="markdownIt-Anchor" href="#å®éªŒ-å¾®è°ƒ"></a> å®éªŒ &amp; å¾®è°ƒ</h2>
<p>é¢„è®­ç»ƒæ•°æ®é›†åˆï¼šMicrosoft COCO (MSCOCO), Visual Genome (VG), SBU Captions (SBU) , Google Conceptual Captions (GCC) ã€‚è¿™4ä¸ªæ•°æ®é›†åˆèµ·æ¥ä¸€èˆ¬å«åš 4 Million çš„è®¾ç½®ï¼Œå› ä¸ºå®ƒä»¬çš„å›¾ç‰‡æ•°åŠ èµ·æ¥å·®ä¸å¤šæ˜¯ 4 Millionã€‚</p>
<p>å¾®è°ƒæ•°æ®é›†åˆ</p>
<ul>
<li>åˆ†ç±»ä»»åŠ¡ï¼š
<ul>
<li>
<p>Visual Question Answering (VQA) ä»»åŠ¡å€ŸåŠ© VQAv2 æ•°æ®é›†æ¥è¯„ä¼°ã€‚VQA ä»»åŠ¡è¦æ±‚ç»™å®šå›¾åƒå¯¹å’Œè‡ªç„¶è¯­è¨€é—®é¢˜ï¼Œå¯»æ±‚ç­”æ¡ˆã€‚å¸¦æ³¨é‡Šçš„ç­”æ¡ˆæœ€åˆæ˜¯è‡ªç”±å½¢å¼çš„è‡ªç„¶è¯­è¨€ï¼Œä½†å¸¸è§çš„åšæ³•æ˜¯å°†ä»»åŠ¡è½¬æ¢ä¸ºå…·æœ‰ 3,129 ä¸ªç­”æ¡ˆçš„åˆ†ç±»ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>Natural Language for Visual Reasoning (NLVR) ä»»åŠ¡å€ŸåŠ© NLVR2 æ•°æ®é›†æ¥è¯„ä¼°ã€‚NLVR ä»»åŠ¡æ˜¯ç»™å®šä¸¤ä¸ªå›¾åƒçš„ä¸‰å…ƒç»„å’Œè‡ªç„¶è¯­è¨€çš„é—®é¢˜ï¼ŒåšäºŒå…ƒåˆ†ç±»çš„ä»»åŠ¡ã€‚ç”±äºä¸é¢„è®­ç»ƒè®¾ç½®ä¸åŒæœ‰ä¸¤ä¸ªè¾“å…¥å›¾åƒï¼Œå› æ­¤ä¸‹æ¸¸ä»»åŠ¡å­˜åœ¨å¤šç§ç­–ç•¥ã€‚åœ¨ ViLT ä¸­ï¼Œè¾“å‡ºæ˜¯ä¸¤ä¸ªå›¾ç‰‡ï¼Œä¸€ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆåˆ†æˆ (é—®é¢˜ï¼Œå›¾ç‰‡1) å’Œ (é—®é¢˜ï¼Œå›¾ç‰‡2)ï¼Œå¹¶æŠŠå®ƒä»¬åˆ†åˆ«å–‚ç»™ ViLT æ¨¡å‹ï¼Œå¾—åˆ°çš„ä¸¤ä¸ª Pooled Representationï¼Œä¹Ÿå°±æ˜¯ p æ‹¼æ¥èµ·æ¥ï¼Œæœ€åè¾“å‡ºåˆ†ç±»ç»“æœã€‚</p>
</li>
</ul>
</li>
<li>æ£€ç´¢ä»»åŠ¡: MSCOCO å’Œ Flickr30K</li>
</ul>
<p><span id="click_me_jump3"></span></p>
<h1 id="albef"><a class="markdownIt-Anchor" href="#albef"></a> ALBEF</h1>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2107.07651.pdf">Align before Fuse: Vision and Language Representation Learning with Momentum Distillation (NeurIPS 2021)</a><br />
<a target="_blank" rel="noopener" href="https://github.com/salesforce/ALBEF/">https://github.com/salesforce/ALBEF/</a></p>
<p>å¤§éƒ¨åˆ† <strong>è§†è§‰-è¯­è¨€é¢„è®­ç»ƒ (Vision-and-Language Pre-training, VLP)</strong> çš„é—®é¢˜ ï¼š</p>
<ol>
<li>ä½¿ç”¨ä¸€ä¸ªå¤šæ¨¡æ€çš„ Transformer ç¼–ç å™¨èåˆå›¾åƒ token ä¸æ–‡æœ¬ token çš„ä¿¡æ¯èåˆï¼Œä½†æ˜¯å› ä¸º Image Feature å’Œ Text Feature åœ¨è¾“å…¥ç»™ Transformer æ—¶æ˜¯ <strong>æ²¡å¯¹é½çš„</strong> ï¼Œå³åµŒå…¥ç‰¹å¾å„è‡ªåœ¨å„è‡ªçš„ç©ºé—´ä¸­å—ï¼Œå¯¼è‡´è¿™ä¸ªå¤šæ¨¡æ€ Transformer æ— æ³•å‡†ç¡®åœ°å­¦ä¹ åˆ°å›¾æ–‡çš„å…³è”å…³ç³»ã€‚</li>
<li>ç›®æ ‡æ£€æµ‹å™¨è®¡ç®—ä»£ä»·è¾ƒé«˜ä¸”å»¶æ—¶è¾ƒå¤§-&gt; ViLT</li>
<li>é¢„è®­ç»ƒæ‰€ä½¿ç”¨çš„å›¾åƒæ–‡æœ¬æ•°æ®é›†æ˜¯ä»ç½‘ç»œä¸Šæ”¶é›†çš„ï¼Œå†…å®¹ä¸Šæ¯”è¾ƒå˜ˆæ‚ã€‚ç°æœ‰çš„é¢„è®­ç»ƒç›®æ ‡ï¼Œä¾‹å¦‚ MLM å¯èƒ½ä¼šè¿‡æ‹Ÿåˆå™ªå£°æ–‡æœ¬ï¼Œé™ä½æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</li>
</ol>
<p>åŸºäºæ­¤ï¼š</p>
<ol>
<li>å…ˆç”¨å¯¹æ¯”å­¦ä¹ æŸå¤±  image-text contrastive lossï¼Œå¯¹é½ Image Feature å’Œ Text Feature ï¼Œç„¶åå†æ”¾å…¥ Transformer ä¸­èåˆã€‚</li>
<li>Visual Encoder å’Œ  Text Encoder å‡ä¸ä½¿ç”¨ç›®æ ‡æ£€æµ‹å™¨ã€‚</li>
<li>è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨åŸºäº <strong>åŠ¨é‡è’¸é¦ (MoD)</strong> çš„æ–¹æ³•ä½¿æ¨¡å‹èƒ½å¤Ÿåˆ©ç”¨æ›´å¤§çš„å¸¦å™ªå£°æ•°æ®é›†ã€‚<br />
åŸç†ï¼šåœ¨è®­ç»ƒæœŸé—´ï¼Œä½œè€…ç»´æŒä¸€ä¸ªåŠ¨é‡æ¨¡å‹ï¼Œå…¶å‚æ•°å°±æ˜¯ä¹‹å‰æ¨¡å‹å‚æ•°çš„ç§»åŠ¨å¹³å‡ã€‚ç„¶åä½¿ç”¨è¿™ä¸ªåŠ¨é‡æ¨¡å‹ç”Ÿæˆä¼ªç›®æ ‡ä½œä¸ºé¢å¤–çš„ç›‘ç£ã€‚å³è®©ã€Œæ»‘åŠ¨å¹³å‡çš„ modelã€å»é¢„æµ‹ï¼Œæ¢¯åº¦è¿”å›ç»™æœ€æ–°çš„æ¨¡å‹ã€‚<br />
ä½œç”¨ï¼šå½“æ•°æ®ä¸­æœ‰å™ªå£°å¯¼è‡´ç›‘ç£ä¿¡å·ä¸åˆç†æ—¶ï¼ŒåŠ¨é‡æ¨¡å‹å°±å¯ä»¥ç»™å‡ºé¢å¤–çš„ç›‘ç£ä¿¡å·ï¼Œæ”¹å–„æ¨¡å‹çš„é¢„è®­ç»ƒã€‚ä½œè€…è¡¨æ˜ MoD ä¸ä»…é€‚ç”¨äºé¢„è®­ç»ƒæ•°æ®é›†æœ‰å™ªå£°çš„æƒ…å†µï¼Œ <strong>è¿˜é€‚ç”¨äºé¢„è®­ç»ƒæ•°æ®é›†å¾ˆå¹²å‡€çš„æƒ…å†µã€‚</strong></li>
</ol>
<h2 id="æ¨¡å‹-2"><a class="markdownIt-Anchor" href="#æ¨¡å‹-2"></a> æ¨¡å‹</h2>
<p>å¦‚ä¸‹å›¾1æ‰€ç¤ºæ˜¯ ALBEF çš„æ¨¡å‹æ¶æ„ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>ä¸€ä¸ªå›¾åƒç¼–ç å™¨ï¼šå›¾åƒç¼–ç å™¨æ˜¯12å±‚ ViT-B/16, æƒé‡åˆå§‹åŒ–æ¥è‡ªäºåœ¨ ImageNet-1K ä¸Šé¢é¢„è®­ç»ƒçš„ DeiT æ¨¡å‹ï¼ŒæŠŠè¾“å…¥å›¾ç‰‡ç¼–ç æˆ Image token <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><msub><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">v</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">v</mi><mi>N</mi></msub><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left\{\boldsymbol{v}_{\mathrm{cls}}, \boldsymbol{v}_1, \ldots, \boldsymbol{v}_N\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span> ã€‚</li>
<li>ä¸€ä¸ªæ–‡æœ¬ç¼–ç å™¨ï¼šBert-base çš„å‰ 6 å±‚ï¼ŒæŠŠè¾“å…¥æ–‡æœ¬ç¼–ç æˆ Text token <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><msub><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">w</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi mathvariant="bold-italic">w</mi><mi>N</mi></msub><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left\{\boldsymbol{w}_{\mathrm{cls}}, \boldsymbol{w}_1, \ldots, \boldsymbol{w}_N\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span> ã€‚<br />
<strong>è§†è§‰ç¼–ç å™¨çš„ä½“é‡å¤§äºæ–‡æœ¬, ç»éªŒå‘ç°è¿™æ ·åšæ•ˆæœå¥½ã€‚</strong></li>
<li>ä¸€ä¸ªå¤šæ¨¡æ€ç¼–ç å™¨ï¼šæ˜¯ BERT çš„å6å±‚åšå¤šæ¨¡æ€ç¼–ç ã€‚</li>
</ul>
<p>è¿™é‡Œçš„ ckpt å€’æ˜¯å’Œ ViLT ä¸ä¸€æ ·äº†ï¼Œæˆ‘è§‰å¾—ä¹Ÿæ›´ç¬¦åˆç›´è§‰ï¼Œå›¾åƒç”¨ vitï¼Œæ–‡æœ¬ç”¨ bertï¼›è€Œä¸æ˜¯åªä½¿ç”¨ ViT ã€‚</p>
<p><img src="https://pic1.zhimg.com/80/v2-52f2d5cfd5bf5c93bf0fc382daeb12b4_720w.webp" alt="" /></p>
<h2 id="é¢„è®­ç»ƒç›®æ ‡-2"><a class="markdownIt-Anchor" href="#é¢„è®­ç»ƒç›®æ ‡-2"></a> é¢„è®­ç»ƒç›®æ ‡</h2>
<p>ç”¨äºå›¾æ–‡èåˆä¹‹å‰å¯¹é½çš„æŸå¤±å‡½æ•° Image-Text Contrastive Learning (ITC)<br />
å¤šæ¨¡æ€é¢„è®­ç»ƒæ ‡é…çš„å®Œå½¢å¡«ç©ºç›®æ ‡å‡½æ•° masked language modeling (MLM)<br />
ç”¨äºå¤šæ¨¡æ€é¢„è®­ç»ƒçš„å›¾æ–‡åŒ¹é…æŸå¤±å‡½æ•° image-text matching (ITM)</p>
<p><strong>Image-Text Contrastive Learning (ITC) on uni-modal encoders</strong></p>
<p>æ—¨åœ¨ fuse multi-modal feature å‰ï¼Œå¯¹é½ text feature å’Œ image feature ã€‚</p>
<p>åº”ç”¨äº <strong>å•æ¨¡æ€å›¾åƒç¼–ç å™¨å’Œæ–‡æœ¬ç¼–ç å™¨</strong>ï¼ŒITCä»»åŠ¡æ˜¯åœ¨å¤šæ¨¡æ€èåˆä¹‹å‰å°±éœ€è¦é¢„è®­ç»ƒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ITCåªæ¶‰åŠå›¾åƒã€æ–‡æœ¬encoderï¼Œä¸æ¶‰åŠå¤šæ¨¡æ€ç¼–ç å™¨ã€‚</p>
<p>å°†ä¸¤ä¸ª 768d cls token æŠ•å½±ä¸º 256d tokenï¼Œç„¶åè®¡ç®—ç›¸ä¼¼åº¦ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo>=</mo><msub><mi>g</mi><mi>v</mi></msub><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msub><mi>g</mi><mi>w</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">s=g_v\left(\boldsymbol{v}_{\mathrm{cls}}\right)^{\top} g_w\left(\boldsymbol{w}_{\mathrm{cls}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p>åŒæ—¶ä½œè€…è¿™é‡Œå€Ÿé‰´ MoCoï¼Œ</p>
<ul>
<li>
<p>é€šè¿‡æ»‘åŠ¨å¹³å‡ç»´æŠ¤ä¸¤ä¸ªç‹¬ç«‹çš„ momentum uni-modal encoder ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">g&#x27;_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">g&#x27;_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ã€‚</p>
</li>
<li>
<p>ç»´æŠ¤ä¸¤ä¸ªåŠ¨é‡è´Ÿæ ·æœ¬é˜Ÿåˆ—ï¼ˆæ–‡æœ¬è´Ÿæ ·æœ¬é˜Ÿåˆ—ã€å’Œã€Œå›¾ç‰‡è´Ÿæ ·æœ¬é˜Ÿåˆ—ã€ï¼‰ï¼Œå®¹é‡ä¸º M</p>
</li>
<li>
<p>ä½¿ç”¨ momentum uni-modal encoder ç¼–ç åŠ¨é‡è´Ÿæ ·æœ¬é˜Ÿåˆ—ä¸­çš„æ¯ä¸€ä¸ªè´Ÿæ ·æœ¬ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_v^{\prime}\left(\boldsymbol{v}_{\mathrm{cls}}^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_w^{\prime}\left(\boldsymbol{w}_{\mathrm{cls}}^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></p>
</li>
<li>
<p>ç”¨å½“å‰çš„æ¨¡å‹ï¼ˆéåŠ¨é‡æ¨¡å‹ï¼‰ç¼–ç å½“å‰çš„æ­£æ ·æœ¬ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>v</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_v\left(\boldsymbol{v}_{\mathrm{cls}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>w</mi></msub><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_w\left(\boldsymbol{w}_{\mathrm{cls}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></p>
</li>
<li>
<p>å¾—åˆ°ç›¸ä¼¼åº¦ï¼š</p>
</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>g</mi><mi>v</mi></msub><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow><mtext>Â andÂ Â </mtext><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>g</mi><mi>w</mi></msub><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">s(I, T)=g_v\left(\boldsymbol{v}_{\mathrm{cls}}\right)^{\top} g_w^{\prime}\left(\boldsymbol{w}_{\mathrm{cls}}^{\prime}\right)\text { and }  \ s(T, I)=g_w\left(\boldsymbol{w}_{\mathrm{cls}}\right)^{\top} g_v^{\prime}\left(\boldsymbol{v}_{\mathrm{cls}}^{\prime}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">Â andÂ </span></span><span class="mspace">Â </span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<ul>
<li>å¾—åˆ° softmax-normalized image-to-text and text-to-image similarity</li>
</ul>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \
 at position 163: â€¦
\text { and } \Ì²
Ì²p_m^{\mathrm{t}â€¦'>p_m^{\mathrm{i} 2 \mathrm{t}}(I)  =\frac{\exp \left(s\left(I, T_m\right) / \tau\right)}{\sum_{m=1}^M \exp \left(s\left(I, T_m\right) / \tau\right)}
\text { and } \
p_m^{\mathrm{t} 2 \mathrm{i}}(T)  =\frac{\exp \left(s\left(T, I_m\right) / \tau\right)}{\sum_{m=1}^M \exp \left(s\left(T, I_m\right) / \tau\right)}
</p>
<ul>
<li>è®¡ç®— Lossï¼š</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>itcÂ </mtext></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>âˆ¼</mo><mi>D</mi></mrow></msub><mrow><mo fence="true">[</mo><mi mathvariant="normal">H</mi><mrow><mo fence="true">(</mo><msup><mi mathvariant="bold-italic">y</mi><mrow><mi mathvariant="normal">i</mi><mn>2</mn><mi mathvariant="normal">t</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">p</mi><mrow><mi mathvariant="normal">i</mi><mn>2</mn><mi mathvariant="normal">t</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo>+</mo><mi mathvariant="normal">H</mi><mrow><mo fence="true">(</mo><msup><mi mathvariant="bold-italic">y</mi><mrow><mi mathvariant="normal">t</mi><mn>2</mn><mi mathvariant="normal">i</mi></mrow></msup><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">p</mi><mrow><mi mathvariant="normal">t</mi><mn>2</mn><mi mathvariant="normal">i</mi></mrow></msup><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {itc }}=\frac{1}{2} \mathbb{E}_{(I, T) \sim D}\left[\mathrm{H}\left(\boldsymbol{y}^{\mathrm{i} 2 \mathrm{t}}(I), \boldsymbol{p}^{\mathrm{i} 2 \mathrm{t}}(I)\right)+\mathrm{H}\left(\boldsymbol{y}^{\mathrm{t} 2 \mathrm{i}}(T), \boldsymbol{p}^{\mathrm{t} 2 \mathrm{i}}(T)\right)\right]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">itcÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆ¼</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathrm">H</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">t</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">t</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathrm">H</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p>
<p>å…¶å®å°±æ˜¯ä¸¤ä¸ªç‚¹ï¼š</p>
<ul>
<li>é”šç‚¹æ­£æ ·æœ¬æ¥æºäºå½“å‰ batchï¼Œå¹¶ä¸”ä½¿ç”¨å½“å‰çš„ encoder</li>
<li>è´Ÿæ ·æœ¬æ¥æºäºç¼“å­˜çš„åºåˆ—ï¼Œæ¨¡å‹ä¹Ÿæ˜¯åŠ¨é‡æ¨¡å‹</li>
</ul>
<p><strong>Masked Language Modeling (MLM) on the multi-modal encoder</strong><br />
15% çš„ mask ratio</p>
<p><strong>Image-Text Matching Loss (ITM) on the multi-modal encoder</strong><br />
é¢„æµ‹ä¸€å¯¹å›¾åƒå’Œæ–‡æœ¬æ˜¯æ­£æ ·æœ¬è¿˜æ˜¯è´Ÿæ ·æœ¬ã€‚ä½œè€…ä½¿ç”¨å¤šæ¨¡æ€ç¼–ç å™¨çš„è¾“å‡ºåµŒå…¥ [CLS] token ä½œä¸ºå›¾åƒ-æ–‡æœ¬å¯¹çš„è”åˆè¡¨ç¤ºï¼Œå¹¶é€šè¿‡ä¸€ä¸ª FC å±‚å’Œä¸€ä¸ª Softmax æ¥é¢„æµ‹äºŒç±»æ¦‚ç‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><mi>i</mi><mi>t</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">p^{itm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.019104em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>è¿˜ä½¿ç”¨äº† ITC ä¸­è®¡ç®—å¾—åˆ°çš„ç›¸ä¼¼åº¦åœ¨åŒä¸€ä¸ª batch å†…ä¸ºæ¯ä¸€ä¸ªæ­£æ ·æœ¬å¯¹æŒ–æ˜ä¸¤ä¸ªéš¾è´Ÿæ ·æœ¬å¯¹:</p>
<ul>
<li>
<p>å¯¹äºä¸€ä¸ª Batch ä¸­æ¯ä¸ªå›¾åƒï¼ŒALBEF ä¼šé‡‡æ ·æœ€éš¾çš„é‚£ä¸ªæ–‡æœ¬æ ·æœ¬ä½œä¸ºè´Ÿæ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Â hardÂ NÂ text,Â posÂ ImageÂ )</mtext></mrow><annotation encoding="application/x-tex">\text{( hard N  text, pos Image )}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Â hardÂ NÂ text,Â posÂ ImageÂ )</span></span></span></span></span></p>
</li>
<li>
<p>å¯¹äºä¸€ä¸ª Batch ä¸­æ¯ä¸ªæ–‡æœ¬ï¼ŒALBEF ä¼šé‡‡æ ·æœ€éš¾çš„é‚£ä¸ªå›¾åƒæ ·æœ¬ä½œä¸ºè´Ÿæ · <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Â posÂ text,Â hardÂ NÂ ImageÂ )</mtext></mrow><annotation encoding="application/x-tex">\text{( pos text, hard N Image )}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Â posÂ text,Â hardÂ NÂ ImageÂ )</span></span></span></span></span></p>
</li>
<li>
<p>ç„¶åå’Œæ­£æ ·æœ¬ä¸€èµ·æ„æˆå›¾æ–‡åŒ¹é…æŸå¤±ã€‚</p>
</li>
</ul>
<h2 id="momentum-distillation"><a class="markdownIt-Anchor" href="#momentum-distillation"></a> Momentum Distillation</h2>
<p>ä»ç½‘ç»œä¸Šæ”¶é›†çš„å›¾åƒ-æ–‡æœ¬å¯¹å¾€å¾€æ˜¯å¼±ç›¸å…³çš„ï¼šæ–‡æœ¬å¯èƒ½åŒ…å«ä¸å›¾åƒæ— å…³çš„è¯ï¼Œæˆ–è€…å›¾åƒå¯èƒ½åŒ…å«æ–‡æœ¬ä¸­æ²¡æœ‰æè¿°çš„å®ä½“ï¼Œå½±å“äº† ITC å’Œ MLM ã€‚ä¸ºäº†ä»å˜ˆæ‚çš„æ•°æ®ä¸­å­¦ä¹ ï¼Œæˆ‘ä»¬æå‡ºäº†åŠ¨é‡è’¸é¦æ³•ï¼Œå³ä½¿ç”¨åŠ¨é‡æ¨¡å‹ä¸ºå›¾åƒ-æ–‡æœ¬å¯¹æ¯”å­¦ä¹ å’Œæ©ç è¯­è¨€å»ºæ¨¡ç”Ÿæˆä¼ªç›®æ ‡ã€‚</p>
<p>åŒæ—¶ï¼šåŠ¨é‡æç‚¼å¯ä»¥è¢«è§£é‡Šä¸ºï¼ŒåŠ¨é‡æ¨¡å‹çš„é¢„æµ‹ä¸ºæ¯ä¸ªå›¾åƒ-æ–‡æœ¬å¯¹äº§ç”Ÿä¸€ç³»åˆ—æ–°çš„è§†è§’ã€‚</p>
<p><img src="https://cdn.mathpix.com/snip/images/i73ByKIO7wuvrs5pcLaQnxTn1Nv8LNRkOyu_SMhDNhg.original.fullsize.png" alt="" /></p>
<p>ä½œè€…æå‡º <strong>ã€Œlearn from pseudo-targets generated by the momentum modelã€</strong>ï¼Œè®©åŠ¨é‡æ¨¡å‹å……å½“ teacher modelï¼Œç”Ÿæˆä¼ªæ ‡ç­¾ï¼Œä½œä¸º base model çš„ç›‘ç£ä¿¡å·ï¼Œå…·ä½“åœ°ï¼š</p>
<p><strong>å¯¹äº ITC</strong><br />
åŸæœ¬æ­£æ ·æœ¬æ˜¯ current base encoder ç¼–ç ï¼Œè´Ÿæ ·æœ¬æ˜¯ momentum encoder ç¼–ç ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>g</mi><mi>v</mi></msub><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow><mtext>Â andÂ Â </mtext><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>g</mi><mi>w</mi></msub><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">s(I, T)=g_v\left(\boldsymbol{v}_{\mathrm{cls}}\right)^{\top} g_w^{\prime}\left(\boldsymbol{w}_{\mathrm{cls}}^{\prime}\right)\text { and }  \ s(T, I)=g_w\left(\boldsymbol{w}_{\mathrm{cls}}\right)^{\top} g_v^{\prime}\left(\boldsymbol{v}_{\mathrm{cls}}^{\prime}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">Â andÂ </span></span><span class="mspace">Â </span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p>è¿™é‡Œåˆ™å…¨éƒ½äº¤ç»™ momentum encoder è¿›è¡Œç¼–ç ï¼Œå¾—åˆ°æ–°çš„ç›¸ä¼¼åº¦ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow><mtext>Â andÂ </mtext><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">(</mo><mi>T</mi><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><msup><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold-italic">w</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">âŠ¤</mi></msup><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold-italic">v</mi><mrow><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">s^{\prime}(I, T)=g_v^{\prime}\left(\boldsymbol{v}_{\mathrm{cls}}\right)^{\top} g_w^{\prime}\left(\boldsymbol{w}_{\mathrm{cls}}^{\prime}\right) \text { and } s^{\prime}(T, I)=g_w^{\prime}\left(\boldsymbol{w}_{\mathrm{cls}}\right)^{\top} g_v^{\prime}\left(\boldsymbol{v}_{\mathrm{cls}}^{\prime}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">Â andÂ </span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2390079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em;">w</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">c</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p>å¯ä»¥çœ‹åˆ°å·¦è¾¹çš„ç¼–ç å™¨ä»åŸå§‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>w</mi></msub><mo separator="true">,</mo><msub><mi>g</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">g_w, g_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å˜æˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>g</mi><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo separator="true">,</mo><msubsup><mi>g</mi><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">g_w^{\prime}, g_v^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ã€‚</p>
<p>ç„¶åè¿˜æ˜¯ä¸€æ ·åœ°å¾—åˆ° soft pseudo-targets softmax-normalized image-to-text and text-to-image similarity <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="normal">i</mi><mn>2</mn><mi mathvariant="normal">t</mi></mrow></msup><mo separator="true">,</mo><mtext>Â </mtext><msup><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="normal">t</mi><mn>2</mn><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">i</mi></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{q}^{\mathrm{i} 2 \mathrm{t}},\ \boldsymbol{q}^{\mathrm{t} 2 \mathrm{ii}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.024942em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.830502em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">t</span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.830502em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span> ï¼Œä½œä¸º teacher similarityï¼Œè®© base model çš„ç»“æœå’Œè¿™ä¸ª teacher similarity å·®è·å˜å°ï¼Œè¿™é‡Œä½¿ç”¨äº† KL æ•£åº¦ã€‚</p>
<p>æœ€ç»ˆå’ŒåŸå§‹çš„ loss åŠ æƒåœ¨ä¸€èµ·å³å¯ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">c</mi></mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mo stretchy="false">)</mo><msub><mi mathvariant="script">L</mi><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">c</mi></mrow></msub><mo>+</mo><mfrac><mi>Î±</mi><mn>2</mn></mfrac><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo><mo>âˆ¼</mo><mi>D</mi></mrow></msub><mrow><mo fence="true">[</mo><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow><mrow><mo fence="true">(</mo><msup><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="normal">i</mi><mn>2</mn><mi mathvariant="normal">t</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ¥</mi><msup><mi mathvariant="bold-italic">p</mi><mrow><mi mathvariant="normal">i</mi><mn>2</mn><mi mathvariant="normal">t</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow><mrow><mo fence="true">(</mo><msup><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="normal">t</mi><mn>2</mn><mi mathvariant="normal">i</mi></mrow></msup><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ¥</mi><msup><mi mathvariant="bold-italic">p</mi><mrow><mi mathvariant="normal">t</mi><mn>2</mn><mi mathvariant="normal">i</mi></mrow></msup><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{itc}}^{\mathrm{mod}}=(1-\alpha) \mathcal{L}_{\mathrm{itc}}+\frac{\alpha}{2} \mathbb{E}_{(I, T) \sim D}\left[\mathrm{KL}\left(\boldsymbol{q}^{\mathrm{i} 2 \mathrm{t}}(I) \| \boldsymbol{p}^{\mathrm{i} 2 \mathrm{t}}(I)\right)+\mathrm{KL}\left(\boldsymbol{q}^{\mathrm{t} 2 \mathrm{i}}(T) \| \boldsymbol{p}^{\mathrm{t} 2 \mathrm{i}}(T)\right)\right]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.146108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">c</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">c</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆ¼</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathrm">K</span><span class="mord mathrm">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">t</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mord">âˆ¥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">i</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">t</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathrm">K</span><span class="mord mathrm">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mord">âˆ¥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8805019999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">t</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p>
<p><strong>å¯¹äº MLM</strong><br />
ä¹Ÿæ˜¯ä¸€æ ·çš„è®©åŠ¨é‡æ¨¡å‹é¢„æµ‹ä¸€ä¸ª mask token çš„æ¦‚ç‡åˆ†å¸ƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">q</mi><mrow><mi>m</mi><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mover accent="true"><mi>T</mi><mo>^</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{q}^{mask}(I, \hat T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ï¼Œç„¶åæŒ‡å¯¼ base modelï¼Œå¾—åˆ°æœ€ç»ˆçš„åŠ æƒ lossï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>mlmÂ </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mo stretchy="false">)</mo><msub><mi mathvariant="script">L</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">m</mi></mrow></msub><mo>+</mo><mi>Î±</mi><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mover accent="true"><mi>T</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>âˆ¼</mo><mi>D</mi></mrow></msub><mrow><mi mathvariant="normal">K</mi><mi mathvariant="normal">L</mi></mrow><mrow><mo fence="true">(</mo><msup><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">k</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mover accent="true"><mi>T</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ¥</mi><msup><mi mathvariant="bold-italic">p</mi><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">k</mi></mrow></msup><mo stretchy="false">(</mo><mi>I</mi><mo separator="true">,</mo><mover accent="true"><mi>T</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mlm }}^{\mathrm{mod}}=(1-\alpha) \mathcal{L}_{\mathrm{mlm}}+\alpha \mathbb{E}_{(I, \hat{T}) \sim D} \mathrm{KL}\left(\boldsymbol{q}^{\mathrm{msk}}(I, \hat{T}) \| \boldsymbol{p}^{\mathrm{msk}}(I, \hat{T})\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.146108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mlmÂ </span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">m</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34479999999999994em;"><span style="top:-2.382061em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mpunct mtight">,</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span><span style="top:-2.9523300000000003em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord mtight">^</span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">âˆ¼</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49293899999999985em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathrm">K</span><span class="mord mathrm">L</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">q</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">s</span><span class="mord mathrm mtight">k</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">âˆ¥</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">p</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">s</span><span class="mord mathrm mtight">k</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p>
<p><strong>Usage</strong><br />
also apply MoD to the downstream tasks ;<br />
set the weight <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span></span></span></span> for all pre-training and downstream tasks .</p>
<h2 id="å®éªŒ"><a class="markdownIt-Anchor" href="#å®éªŒ"></a> å®éªŒ</h2>
<p>å›¾æ–‡æ£€ç´¢ä»»åŠ¡ (Image-Text Retrieval) åŒ…æ‹¬ä¸¤ä¸ªå­ä»»åŠ¡ï¼šå›¾åƒåˆ°æ–‡æœ¬æ£€ç´¢ (TR) å’Œæ–‡æœ¬åˆ°å›¾åƒæ£€ç´¢ (IR)ã€‚ä½œè€…åœ¨ Flickr30K å’Œ COCO è¿™ä¸¤ä¸ªæ•°æ®é›†ä¸Šåšäº†éªŒè¯ã€‚</p>
<p>è§†è§‰è•´å«ä»»åŠ¡ (Visual Entailment, SNLI-VE) æ˜¯ä¸€ä¸ªç»†ç²’åº¦çš„è§†è§‰æ¨ç†ä»»åŠ¡ï¼Œç”¨äºé¢„æµ‹å›¾åƒå’Œæ–‡æœ¬ä¹‹é—´çš„å…³ç³»æ˜¯è•´æ¶µã€ä¸­æ€§æˆ–çŸ›ç›¾çš„ã€‚å°† VE è§†ä¸ºä¸‰åˆ†ç±»é—®é¢˜ï¼Œå¹¶åœ¨å¤šæ¨¡æ€ç¼–ç å™¨çš„ [CLS] token çš„è¾“å‡ºç»“æœåŠ ä¸Šåˆ†ç±»å¤´å¾—åˆ°æ¯ä¸ªç±»çš„æ¦‚ç‡ã€‚</p>
<p>è§†è§‰é—®ç­”ä»»åŠ¡ (Visual Question Answering, VQA) è¦æ±‚æ¨¡å‹é¢„æµ‹ç»™å®šå›¾åƒå’Œé—®é¢˜çš„ç­”æ¡ˆã€‚ä¸ç°æœ‰çš„å°† VQA åˆ¶å®šä¸ºå¤šç­”æ¡ˆåˆ†ç±»é—®é¢˜çš„æ–¹æ³•ä¸åŒï¼ŒALBEF å°† VQA è§†ä¸ºç­”æ¡ˆç”Ÿæˆé—®é¢˜ã€‚<br />
ä½œè€…ä½¿ç”¨6å±‚çš„ Transformer Decoder æ¥ç”Ÿæˆç­”æ¡ˆã€‚</p>
<p>è‡ªç„¶è¯­è¨€è§†è§‰æ¨ç†ä»»åŠ¡ (Natural Language for Visual Reasoning, NLVR2) è¦æ±‚æ¨¡å‹é¢„æµ‹æ–‡æœ¬æ˜¯å¦æè¿°äº†ä¸€å¯¹å›¾åƒã€‚ä½œè€…æ‰©å±•äº†å¤šæ¨¡æ€ç¼–ç å™¨ï¼Œä»¥å®ç°å¯¹ä¸¤å¹…å›¾åƒçš„æ¨ç†ã€‚</p>
<p><span id="click_me_jump5"></span></p>
<h1 id="meter"><a class="markdownIt-Anchor" href="#meter"></a> Meter</h1>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2111.02387">An Empirical Study of Training End-to-End Vision-and-Language Transformers</a></p>
<p><span id="click_me_jump6"></span></p>
<h1 id="coca"><a class="markdownIt-Anchor" href="#coca"></a> CoCa</h1>
<p>Paper: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2205.01917">CoCa: Contrastive Captioners are Image-Text Foundation Models</a><br />
Code: <a target="_blank" rel="noopener" href="https://github.com/lucidrains/CoCa-pytorch">https://github.com/lucidrains/CoCa-pytorch</a><br />
Blog: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/627702632">å¤šæ¨¡æ€è¶…è¯¦ç»†è§£è¯» (ä¹)ï¼šCoCaï¼šå¯¹æ¯”å­¦ä¹ å’Œç”Ÿæˆå¼ä»»åŠ¡è®­ç»ƒå¤šæ¨¡æ€å¤§æ¨¡å‹</a></p>
<p>Co: Contrastive Loss<br />
Ca: Captioning (Generative) Loss</p>
<p>å¸¸è§„CV å’Œ å¤šæ¨¡æ€ä»»åŠ¡ä¸Šå·²ç»å‡ºç°äº†ä¸€äº›æ¨¡å‹ï¼š</p>
<ol>
<li>CV çš„ç¼–ç æ¨¡å‹ï¼Œåˆ†ç±»æŸå¤±ä¸ºï¼š</li>
</ol>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi></mrow></msub><mo>=</mo><mo>âˆ’</mo><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>â¡</mo><msub><mi>q</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{Cls}}=-p(y) \log q_\theta(x)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight">l</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<ol start="2">
<li>
<p>é€šè¿‡å¯¹æ¯”æŸå¤±é¢„è®­ç»ƒ Dual-Encoder çš„è§†è§‰æ¨¡å‹å’Œè¯­è¨€æ¨¡å‹ï¼š</p>
<ul>
<li>èƒ½å°† image å’Œ text æ½œå…¥åˆ°ç›¸åŒçš„ç©ºé—´ï¼Œæ‹¥æœ‰æ¨¡æ€å¯¹é½çš„èƒ½åŠ›ï¼ˆ cross-modal alignment capabilities ï¼‰ï¼Œæ‰€ä»¥æ¯”è¾ƒé€‚åˆ zero-shot image classification å’Œ image-text retrieval ä»»åŠ¡ ã€‚<br />
æŸå¤±å‡½æ•°ä¸ºï¼š</li>
</ul>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>ConÂ </mtext></msub><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo stretchy="false">(</mo><munder><munder><mrow><mo fence="true">(</mo><munderover><mo>âˆ‘</mo><mi>i</mi><mi>N</mi></munderover><mi>log</mi><mo>â¡</mo><mfrac><mrow><mi>exp</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msubsup><mi>x</mi><mi>i</mi><mi mathvariant="normal">âŠ¤</mi></msubsup><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>Ïƒ</mi><mo fence="true">)</mo></mrow></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>exp</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msubsup><mi>x</mi><mi>i</mi><mi mathvariant="normal">âŠ¤</mi></msubsup><msub><mi>y</mi><mi>j</mi></msub><mi mathvariant="normal">/</mi><mi>Ïƒ</mi><mo fence="true">)</mo></mrow></mrow></mfrac></mrow><mo stretchy="true">âŸ</mo></munder><mtext>image-to-textÂ </mtext></munder><mo>+</mo><munder><munder><mrow><munderover><mo>âˆ‘</mo><mi>i</mi><mi>N</mi></munderover><mi>log</mi><mo>â¡</mo><mfrac><mrow><mi>exp</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msubsup><mi>y</mi><mi>i</mi><mi mathvariant="normal">âŠ¤</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>Ïƒ</mi><mo fence="true">)</mo></mrow></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>exp</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><msubsup><mi>y</mi><mi>i</mi><mi mathvariant="normal">âŠ¤</mi></msubsup><msub><mi>x</mi><mi>j</mi></msub><mi mathvariant="normal">/</mi><mi>Ïƒ</mi><mo fence="true">)</mo></mrow></mrow></mfrac><mo fence="true">)</mo></mrow><mo stretchy="true">âŸ</mo></munder><mtext>text-to-imageÂ </mtext></munder></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {Con }}=-\frac{1}{N}(\underbrace{\left(\sum_i^N \log \frac{\exp \left(x_i^{\top} y_i / \sigma\right)}{\sum_{j=1}^N \exp \left(x_i^{\top} y_j / \sigma\right)}\right.}_{\text {image-to-text }}+\underbrace{\left.\sum_i^N \log \frac{\exp \left(y_i^{\top} x_i / \sigma\right)}{\sum_{j=1}^N \exp \left(y_i^{\top} x_j / \sigma\right)}\right)}_{\text {text-to-image }}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ConÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.586995em;vertical-align:-2.7586590000000006em;"></span><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283359999999995em;"><span style="top:-1.2057849999999994em;"><span class="pstrut" style="height:3.828336em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">image-to-textÂ </span></span></span></span></span><span style="top:-3.8283359999999993em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span class="svg-align" style="top:-1.873287em;"><span class="pstrut" style="height:3.828336em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.828336em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.59001em;"><span style="top:-2.128769em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.830908em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7400100000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.3070490000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9550490000000003em;"><span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7586590000000006em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:4.586995em;vertical-align:-2.7586590000000006em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283359999999995em;"><span style="top:-1.2057849999999994em;"><span class="pstrut" style="height:3.828336em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">text-to-imageÂ </span></span></span></span></span><span style="top:-3.8283359999999993em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span class="svg-align" style="top:-1.873287em;"><span class="pstrut" style="height:3.828336em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.828336em;"><span class="pstrut" style="height:3.828336em;"></span><span class="mord"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.59001em;"><span style="top:-2.128769em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.830908em;"><span style="top:-2.4231360000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7400100000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âŠ¤</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.3070490000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9550490000000003em;"><span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7586590000000006em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>å› ä¸ºåœ¨è®­ç»ƒä¸­æ²¡æœ‰å­¦ä¹ æ¨¡æ€ä¿¡æ¯äº¤äº’çš„æ¨¡å—ï¼ˆ due to missing joint components to learn fused image and text representations ï¼‰ï¼Œæ‰€ä»¥ä¸é€‚ç”¨äº joint vision-language understanding tasksï¼Œæ¯”å¦‚ VQA ã€‚</li>
</ul>
</li>
<li>
<p>ä½¿ç”¨ç”Ÿæˆå¼é¢„è®­ç»ƒæ–¹æ³•çš„ Encoder-Decoder Model ï¼Œåœ¨ Encoder ä¾§ç¼–ç å›¾åƒï¼Œåœ¨ Decoder ä¾§ç”Ÿæˆæ–‡å­— ï¼Œè¿™ç§ä»»åŠ¡è®©æ¨¡å‹å­¦ä¼šå»ºæ¨¡è§†è§‰è¯­è¨€çš„è”åˆè¡¨å¾ï¼Œä»è€Œé€‚ç”¨äº multi-modal understanding tasks ã€‚<br />
ä½†æ˜¯ä¸€äº›è¿™æ ·çš„æ–¹æ³•åˆç¼ºå°‘äº† text-only representations å’Œ image embeddings çš„å¯¹é½ä»»åŠ¡ã€‚<br />
Image Encoder + AG Text Decoder ï¼ŒæŸå¤±ä¸º</p>
</li>
</ol>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>CapÂ </mtext></msub><mo>=</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mi>log</mi><mo>â¡</mo><msub><mi>P</mi><mi>Î¸</mi></msub><mrow><mo fence="true">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>âˆ£</mo><msub><mi>y</mi><mrow><mo>&lt;</mo><mi>t</mi></mrow></msub><mo separator="true">,</mo><mi>x</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {Cap }}=-\sum_{t=1}^T \log P_\theta\left(y_t \mid y_{&lt;t}, x\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CapÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<br>
<h2 id="model"><a class="markdownIt-Anchor" href="#model"></a> Model</h2>
<p>æ‰€ä»¥æœ¬æ–‡å°±æ˜¯æƒ³æå‡ºä¸€ä¸ªæ¨¡å‹ï¼Œæœ‰ä¸‰ç§èƒ½åŠ›ï¼Œè®©æ¨¡å‹ï¼š</p>
<ul>
<li>æœ‰å¾ˆå¥½çš„å›¾åƒç‹¬ç«‹ç¼–ç èƒ½åŠ›  -&gt; single-encoder</li>
<li>æœ‰ä¸¤ä¸ªæ¨¡æ€ç‹¬ç«‹ç¼–ç çš„å¯¹é½èƒ½åŠ› -&gt;  dual-encoder</li>
<li>æœ‰ä¸¤ä¸ªæ¨¡æ€çš„ç†è§£äº¤äº’èƒ½åŠ›  -&gt; encoder-decoder</li>
</ul>
<p><img src="https://cdn.mathpix.com/snip/images/gMaO2CfvyMoxtUFG4F3f39Pl3DPkrvpGAxbHAcNUm5M.original.fullsize.png" alt="" /></p>
<p>å…·ä½“åœ°ï¼Œä½œè€…æå‡ºæ¨¡å‹ CoCa ï¼Œç»“æ„ä¸º encoder-decoderï¼š</p>
<ul>
<li>a single Image Encoder</li>
<li>a two-part Text Decoder
<ul>
<li>a uni-modal decoder: <strong>Self attention</strong> to encode <strong>text-only representations</strong></li>
<li>a multi-modal decoder: <strong>Cross-Attend</strong> image encoder outputs to learn <strong>multi-modal image-text representations</strong></li>
</ul>
</li>
</ul>
<p><strong>a simple encoder-decoder approach that seamlessly combines the three training paradigms.</strong></p>
<h2 id="contrastive-captioners-pretraining"><a class="markdownIt-Anchor" href="#contrastive-captioners-pretraining"></a> Contrastive Captioners Pretraining</h2>
<p><img src="https://cdn.mathpix.com/snip/images/MHOge480Yy6fpCah4iKv-gL8hf6oF6PhIgokcfW-xbQ.original.fullsize.png" alt="Figure 2: Detailed illustration of CoCa architecture and training objectives." /></p>
<p>é¢„è®­ç»ƒç›®æ ‡ä¸º  contrastive loss å’Œ captioning (generative) loss ï¼š</p>
<ul>
<li><strong>the contrastive objective</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>ConÂ </mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {Con }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ConÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> between outputs of the image encoder and uni-modal text decoder , ä½¿å¾—äºŒè€…éƒ½å…·å¤‡ç‹¬ç«‹æå–å›¾åƒç‰¹å¾å’Œæ–‡æœ¬ç‰¹å¾çš„èƒ½åŠ›ï¼Œè€Œä¸”å­¦ä¹ åˆ°çš„æ˜¯åå…¨å±€çš„å›¾æ–‡è¡¨å¾ã€‚<br />
ç¬¬ä¸€ä¸ªå¯¹æ¯”æŸå¤±çš„è¡¨å¾æ¥è‡ªäº Image encoder å’Œç¬¬ä¸€å±‚  uni-modal Text decoder</li>
</ul>
<blockquote>
<p>The single-encoder cross- entropy classification objective can be interpreted as a special case of the generative approach applied on image annotation data, when the vocabulary is the set of all label names.</p>
</blockquote>
<ul>
<li><strong>the captioning objective</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>CapÂ </mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {Cap }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CapÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> at the output of the multi-modal decoder , ä½¿å¾—å…¶å…·æœ‰è”åˆæå–å›¾åƒæ–‡æœ¬è”åˆè¡¨å¾çš„èƒ½åŠ›ï¼Œè€Œä¸”å­¦ä¹ åˆ°çš„æ˜¯åç»†ç²’åº¦çš„å›¾æ–‡è¡¨å¾ã€‚<br />
ç¬¬äºŒä¸ªè‡ªå›å½’æŸå¤±æ¥è‡ªäº Image encoder å’Œç¬¬äºŒå±‚ multi-modal AG Text decoder</li>
</ul>
<p>æ€»æŸå¤±ä¸ºï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>CoCaÂ </mtext></msub><mo>=</mo><msub><mi>Î»</mi><mtext>ConÂ </mtext></msub><mo>â‹…</mo><msub><mi mathvariant="script">L</mi><mtext>ConÂ </mtext></msub><mo>+</mo><msub><mi>Î»</mi><mtext>CapÂ </mtext></msub><mo>â‹…</mo><msub><mi mathvariant="script">L</mi><mtext>CapÂ </mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {CoCa }}=\lambda_{\text {Con }} \cdot \mathcal{L}_{\text {Con }}+\lambda_{\text {Cap }} \cdot \mathcal{L}_{\text {Cap }}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CoCaÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ConÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ConÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">Î»</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CapÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CapÂ </span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>æ•ˆç‡ï¼š</strong><br />
ALBEF åœ¨æ¯ä¸ª iteration è®­ç»ƒçš„æ—¶å€™ï¼Œæ–‡æœ¬éƒ¨åˆ†çš„ Encoder æ¨¡å‹è¦ forward 2æ¬¡ï¼Œä¸€æ¬¡æ˜¯è¾“å…¥å®Œæ•´çš„æ–‡æœ¬åšå›¾æ–‡åŒ¹é…ä»»åŠ¡ï¼Œä¸€æ¬¡æ˜¯è¾“å…¥ mask ä¹‹åçš„æ–‡æœ¬åšå®Œå½¢å¡«ç©ºä»»åŠ¡ã€‚ä½†æ˜¯ CoCa æ–‡æœ¬éƒ¨åˆ†çš„ Decoder æ¨¡å‹åªéœ€è¦ forward 1æ¬¡ï¼Œå³å¯åŒæ—¶è®¡ç®—å¯¹æ¯”å­¦ä¹ çš„æŸå¤±å’Œå›¾ç‰‡å­—å¹•çš„æŸå¤±ã€‚</p>
<p>å³ï¼ša simple decoupled decoder design where we split the decoder into unimodal and multimodal components</p>
<p><strong>Pooler:</strong><br />
åœ¨æ–‡æœ¬ç«¯æœ€ååŠ å…¥ [cls] token ï¼Œæ¥ä½œä¸º text representation</p>
<p>åœ¨å›¾ç‰‡ç«¯ï¼Œä½œè€…è®¤ä¸º more visual tokens æ›´é€‚åˆ multimodal understanding tasks ï¼Œå› ä¸ºå¯ä»¥æä¾› region-level features ã€‚<br />
æ‰€ä»¥è¿™é‡Œä½¿ç”¨äº† <strong>Attentional Pooler</strong> ï¼Œä¸€ç§ task-specific attentional pooling çš„èšåˆæ–¹æ³•ï¼šåœ¨ encoder ä¹‹åï¼ŒåŠ å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{query}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ä¸ªå¯ä»¥å­¦ä¹ çš„ query tokenï¼Œç„¶åå¯¹ encoder output åš attention ã€‚</p>
<ul>
<li>å¯¹äºç”Ÿæˆä»»åŠ¡ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi></mrow></msub><mo>=</mo><mn>256</mn></mrow><annotation encoding="application/x-tex">n_{query}=256</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span></span></span></span></li>
<li>å¯¹äºå¯¹æ¯”å­¦ä¹ ä»»åŠ¡ï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n_{query}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li>
</ul>
<p>è¿™äº› query token è¿˜å¯ä»¥å˜ç›¸åœ°è¢«çœ‹ä½œ adaptor ã€‚</p>
<h2 id="contrastive-captioners-for-downstream-tasks"><a class="markdownIt-Anchor" href="#contrastive-captioners-for-downstream-tasks"></a> Contrastive Captioners for Downstream Tasks</h2>
<p><img src="https://pic1.zhimg.com/80/v2-ba7743d56dcfd61c13883602d0423610_720w.webp" alt="" /></p>
<p>ç¬¬1ç§æ˜¯é›¶æ ·æœ¬è¿ç§» (Zero-Shot Transfer) ä»»åŠ¡ï¼Œå…·ä½“åŒ…æ‹¬ Zero-Shot Image Classification, Zero-Shot Image-Text Cross-Retrieval, Zero-Shot Video-Text Cross-Retrievalã€‚</p>
<p>ç¬¬2ç§æ˜¯å†»ä½ç¼–ç å™¨ç‰¹å¾åšè¯„ä¼° (Frozen-feature Evaluation) ä»»åŠ¡ï¼ŒCoCa æ¨¡å‹è®­ç»ƒå¥½ä¹‹åä¼šå¾—åˆ°ä¸€ä¸ª backbone encoderï¼Œå¯¹äºä¸åŒä»»åŠ¡åªæ˜¯ pooler çš„ query ä¸ä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯åªéœ€è¦é‡æ–°å­¦ query token å³å¯ã€‚</p>
<p>ç¬¬3ç§æ˜¯è§†é¢‘åŠ¨ä½œè¯†åˆ« (Video Action Recognition) ä»»åŠ¡ï¼ŒCoCa æ¨¡å‹åˆ†åˆ«å°†æ¯ä¸€å¸§è¾“å…¥å…±äº«å›¾åƒç¼–ç å™¨ï¼Œå¦‚ä¸‹å›¾6æ‰€ç¤ºã€‚CoCa æ¨¡å‹é¢å¤–ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½å­¦ä¹ äº†ä¸€ä¸ª attentional_poolerï¼Œå®ƒçš„è¾“å…¥æ˜¯1ä¸ª query å’Œæ‰€æœ‰çš„ç©ºé—´å’Œæ—¶é—´ç‰¹å¾ tokenã€‚</p>
<p><img src="https://pic4.zhimg.com/80/v2-01c2da4ea60d7fcd190a0d5a48649dab_720w.webp" alt="" /></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/03/MySQL%20info/mysql%20%E4%BA%8B%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/MySQL%20info/mysql%20%E4%BA%8B%E5%8A%A1/" class="post-title-link" itemprop="url">mysql äº‹åŠ¡ Transaction</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-03 22:49:21" itemprop="dateCreated datePublished" datetime="2021-03-03T22:49:21+08:00">2021-03-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>6 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å®šä¹‰ï¼š</p>
<ul>
<li>æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚</li>
<li>ä¼šæŠŠæ‰€æœ‰çš„æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤æˆ–è€…æ’¤é”€ï¼›å³è¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚</li>
</ul>
<p>åªæœ‰ä½¿ç”¨äº† <strong>Innodb</strong> æ•°æ®åº“å¼•æ“çš„æ•°æ®åº“æˆ–è¡¨æ‰æ”¯æŒäº‹åŠ¡ã€‚</p>
<p>æµç¨‹ï¼š</p>
<ol>
<li>å¼€å¯äº‹åŠ¡</li>
<li>æ‰§è¡Œäº‹åŠ¡å†…éƒ¨æ“ä½œï¼Œå¦‚æœå‘æˆå¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡</li>
<li>æäº¤äº‹åŠ¡ï¼Œæ­¤æ—¶æ•°æ®åº“æ‰ä¼šæ›´æ–°ï¼Œè€Œä¸”æ˜¯ä¸€æ¬¡æ€§æ›´æ–°æ‰€æœ‰äº‹åŠ¡å†…éƒ¨çš„æ“ä½œ</li>
</ol>
<p>å¥½å¤„ï¼šä¿è¯äº†æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§</p>
<h2 id="å›æ»š"><a class="markdownIt-Anchor" href="#å›æ»š"></a> å›æ»š</h2>
<h3 id="æŸ¥çœ‹-è®¾ç½®äº‹åŠ¡æäº¤æ–¹å¼"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹-è®¾ç½®äº‹åŠ¡æäº¤æ–¹å¼"></a> æŸ¥çœ‹ / è®¾ç½®äº‹åŠ¡æäº¤æ–¹å¼</h3>
<p>æŸ¥çœ‹æäº¤æ–¹å¼ï¼Œé»˜è®¤ä¸ºè‡ªåŠ¨æäº¤ã€‚æ‰€æœ‰æŒ‡ä»¤éƒ½ç›´æ¥æäº¤ï¼Œæ‰€ä»¥æ— æ³•å›æ»šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT @@autocommit;</span><br><span class="line">&gt;&gt;&gt; 1</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹æäº¤æ–¹å¼ä¸ºæ‰‹åŠ¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`SET @@autocommit=0;`</span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸¤ç§æ–¹å¼æ”¯æŒå›æ»š</p>
<ol>
<li>è®¾ç½®æäº¤æ–¹å¼ä¸º <strong>æ‰‹åŠ¨</strong>ï¼Œæ— è®ºåšå‡ºä»€ä¹ˆä¿®æ”¹éƒ½è¦<code>commit</code>/<code>rollback</code>ï¼Œå¹¶ä¸”å¯ä»¥å¤šæ¬¡å›æ»šã€‚</li>
<li>å¼€å¯äº‹åŠ¡æ–¹å¼ï¼Œæ”¯æŒå›æ»šä¸€æ¬¡ã€‚</li>
</ol>
<h3 id="æ‰‹åŠ¨æäº¤äº‹åŠ¡"><a class="markdownIt-Anchor" href="#æ‰‹åŠ¨æäº¤äº‹åŠ¡"></a> æ‰‹åŠ¨æäº¤äº‹åŠ¡</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT @@autocommit;</span><br><span class="line">&gt;&gt;&gt; 1</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æ‰‹åŠ¨å›æ»š</span><br><span class="line">SET @@autocommit=0;</span><br><span class="line"></span><br><span class="line"># æäº¤äº‹åŠ¡</span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line"># ... ä¸€äº›sqlæ“ä½œå‘½ä»¤ï¼Œæ•°æ®æ˜¯æ”¹å˜çš„ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æäº¤</span><br><span class="line"></span><br><span class="line"># å›æ»šäº‹åŠ¡</span><br><span class="line">ROLLBACK;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª ROLLBACK ä¸ä¼šæ¸…æ¥šç¼“å­˜ï¼Œå¯ä»¥å›æ»šå¤šæ¬¡ã€‚<br />
è¿™ç§æ–¹å¼ä¸ä¼šè‡ªåŠ¨ä¿®æ”¹æ•°æ®ï¼Œå¿…é¡»è¦ COMMITï¼Œæˆ–è€… ROLLBACKã€‚</p>
<h3 id="è‡ªåŠ¨æäº¤æ¨¡å¼ä¸‹å¼€å¯äº‹åŠ¡"><a class="markdownIt-Anchor" href="#è‡ªåŠ¨æäº¤æ¨¡å¼ä¸‹å¼€å¯äº‹åŠ¡"></a> è‡ªåŠ¨æäº¤æ¨¡å¼ä¸‹å¼€å¯äº‹åŠ¡</h3>
<p><code>START TRANSACTION;</code>æˆ–è€…<code>BEGIN;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SELECT @@autocommit;</span><br><span class="line">&gt;&gt;&gt; 1</span><br><span class="line"></span><br><span class="line"># å¼€å¯äº‹åŠ¡</span><br><span class="line">START TRANSACTION;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ... ä¸€äº›sqlæ“ä½œå‘½ä»¤ï¼Œæ•°æ®æ”¹å˜ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æäº¤</span><br><span class="line"></span><br><span class="line"># å›æ»šäº‹åŠ¡ï¼Œæ­¤æ¬¡ç”Ÿæ•ˆï¼Œå›æ»šæˆåŠŸ</span><br><span class="line">ROLLBACK;</span><br><span class="line"></span><br><span class="line"># æäº¤äº‹åŠ¡ï¼Œå’Œä¸Šé¢çš„å›æ»šäº‹åŠ¡åªèƒ½é€‰ä¸€ä¸ª</span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line"># ... ä¸€äº›sqlæ“ä½œå‘½ä»¤ï¼Œæ•°æ®æ”¹å˜</span><br><span class="line"></span><br><span class="line"># ç¬¬äºŒæ¬¡å›æ»šäº‹åŠ¡ï¼Œæ­¤æ¬¡æ— æ³•ç”Ÿæ•ˆï¼Œç¼“å­˜è¢«æ¸…é™¤äº†</span><br><span class="line">ROLLBACK;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™ç§æ–¹å¼ï¼Œä»ç„¶æ˜¯è‡ªåŠ¨ä¿®æ”¹æ•°æ®ï¼Œä½†æ˜¯æ”¯æŒå›æ»šï¼Œä½†æ˜¯åªèƒ½å›æ»šä¸€æ¬¡ï¼Œå…¶å®å°±æ˜¯äº‹åŠ¡ç»“æŸäº†ã€‚<br />
å¦‚æœæŒ‡å®š<code>START TRANSACTION</code>ï¼Œåˆ™ä¼šç«‹å³å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶ä¸”å¿…é¡»é€šè¿‡æ˜¾å¼<code>COMMIT</code>æˆ–<code>ROLLBACK</code>æ¥ç»“æŸè¯¥äº‹åŠ¡ã€‚</p>
<h2 id="äº‹åŠ¡å››å¤§ç‰¹æ€§acid"><a class="markdownIt-Anchor" href="#äº‹åŠ¡å››å¤§ç‰¹æ€§acid"></a> äº‹åŠ¡å››å¤§ç‰¹æ€§ï¼ˆACIDï¼‰</h2>
<ol>
<li>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡ä¸­çš„æ“ä½œæ˜¯ä¸å¯åˆ†å‰²çš„ï¼Œæ˜¯ä¸€ä¸ªåŸå­ã€‚è¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥ã€‚</li>
<li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡å®Œæˆå‰åï¼Œæ•°æ®éœ€è¦ä¸€è‡´ï¼Œæ¯”å¦‚é‡‘é¢æ€»é¢ä¸€è‡´ã€‚</li>
<li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šä¸¤ä¸ªæ“ä½œå¹¶å‘æ‰§è¡Œæ—¶ï¼Œç›¸äº’ä¸å½±å“ã€‚</li>
<li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤æˆ–è€…å›æ»šå¯¹æ•°æ®åº“çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…çš„ã€‚</li>
</ol>
<h2 id="å¹¶å‘äº‹åŠ¡å¼•å‘çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#å¹¶å‘äº‹åŠ¡å¼•å‘çš„é—®é¢˜"></a> å¹¶å‘äº‹åŠ¡å¼•å‘çš„é—®é¢˜</h2>
<p>åšå®¢ï¼š<a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/concurrency-problems-in-dbms-transactions/">Concurrency problems in DBMS Transactions</a><br />
ä¸¤ä¸ªäº‹åŠ¡ Aï¼ŒBåœ¨åŒæ—¶æ“ä½œä¸€ä¸ªè¡¨æ—¶ï¼Œå¼•å‘çš„é—®é¢˜ã€‚</p>
<p>åˆ†ç±»ï¼š</p>
<ul>
<li>è„è¯»(Temporary Update Problem / Dirty read problem)ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°<strong>å¦ä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤</strong>çš„æ•°æ®ã€‚</li>
<li>ä¸å¯é‡å¤è¯»(Unrepeatable Read Problem)ï¼šä¸€ä¸ªäº‹åŠ¡å…ˆåè¯»å–åŒä¸€æ¡æ•°æ®ï¼Œä½†æ˜¯ä¸¤æ¬¡è¯»å–çš„è®°å½•ä¸åŒã€‚</li>
<li>å¹»è¯»(Phantom Read Problem)ï¼šä¸€ä¸ªäº‹åŠ¡æŸ¥è¯¢æ•°æ®æ—¶ï¼Œæ²¡æœ‰æŸ¥è¯¢åˆ°æ•°æ®è¡Œï¼Œç„¶åå†³å®šæ’å…¥ã€‚ï¼ˆè¿™æ—¶å¦ä¸€ä¸ªå¹¶å‘è¿›ç¨‹åœ¨æ‰§è¡Œæ’å…¥ï¼‰ä½†æ˜¯åœ¨æ’å…¥æ—¶ï¼Œå‘ç°å·²ç»å­˜åœ¨ã€‚</li>
</ul>
<h2 id="äº‹åŠ¡éš”ç¦»ç•Œåˆ«"><a class="markdownIt-Anchor" href="#äº‹åŠ¡éš”ç¦»ç•Œåˆ«"></a> äº‹åŠ¡éš”ç¦»ç•Œåˆ«</h2>
<p>ä¸ºäº†è§£å†³äº‹åŠ¡å¼•å‘çš„é—®é¢˜</p>
<table>
<thead>
<tr>
<th>éš”ç¦»çº§åˆ«åç§°</th>
<th></th>
<th>ä¼šå‡ºç°è„è¯»</th>
<th>ä¼šå‡ºç°ä¸å¯é‡å¤è¯»</th>
<th>ä¼šå‡ºç°å¹»è¯»</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read Uncommitted</td>
<td>å¯ä»¥è¯»åˆ°å…¶ä»–äº‹åŠ¡<strong>ä¿®æ”¹è¿‡ä½†æ˜¯è¿˜æ²¡æœ‰æäº¤</strong>çš„æ•°æ®</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>Read Committed</td>
<td>åªèƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡<strong>å·²ç»æäº¤</strong>çš„æ•°æ®</td>
<td></td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>Repeatable Read <br>(<strong>Default</strong>)</td>
<td>äº‹åŠ¡Båªèƒ½åœ¨äº‹åŠ¡Aä¿®æ”¹å¹¶æäº¤è¿‡æ•°æ®åï¼Œè‡ªå·±ä¹Ÿæäº¤äº‹åŠ¡åï¼Œ<br> æ‰èƒ½è¯»åˆ°äº‹åŠ¡Bä¿®æ”¹çš„æ•°æ®ã€‚</td>
<td></td>
<td></td>
<td>âœ“</td>
</tr>
<tr>
<td>Serializable</td>
<td>äº‹åŠ¡ä¹‹é—´é€šè¿‡ä¸€ä¸ªæ¥ä¸€ä¸ªä¸²è¡Œåœ°æ‰§è¡Œ<br>é€šè¿‡åŠ é”å®ç°ï¼ˆè¯»é”å’Œå†™é”ï¼‰</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="å‘½ä»¤"><a class="markdownIt-Anchor" href="#å‘½ä»¤"></a> å‘½ä»¤</h3>
<p>æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT @@TRANSACTION_ISOLATION</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SET [GLOBAL | SESSION] TRANSACTION</span><br><span class="line">    ISOLATION LEVEL [LEVEL]</span><br><span class="line"></span><br><span class="line">LEVEL: &#123;</span><br><span class="line">     REPEATABLE READ</span><br><span class="line">   | READ COMMITTED</span><br><span class="line">   | READ UNCOMMITTED</span><br><span class="line">   | SERIALIZABLE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>SESSION</code>ï¼š</p>
<ul>
<li>å¯¹å½“å‰ä¼šè¯çš„æ‰€æœ‰åç»­çš„äº‹åŠ¡æœ‰æ•ˆ</li>
<li>è¯¥è¯­å¥å¯ä»¥åœ¨å·²ç»å¼€å¯çš„äº‹åŠ¡ä¸­é—´æ‰§è¡Œï¼Œä½†ä¸ä¼šå½±å“å½“å‰æ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡</li>
<li>å¦‚æœåœ¨äº‹åŠ¡ä¹‹é—´æ‰§è¡Œï¼Œåˆ™å¯¹åç»­çš„äº‹åŠ¡æœ‰æ•ˆã€‚</li>
</ul>
<p><code>GLOBAL</code>ï¼šå…¨å±€çº§åˆ«ï¼Œå¯¹å…¨å±€æ‰€æœ‰çš„å­è§†å›¾éƒ½ä¼šè¢«ä¿®æ”¹ï¼Œä½†æ˜¯å·²ç»å­˜åœ¨çš„è§†å›¾ä¸ä¼šè¢«ä¿®æ”¹ã€‚<br />
ä¸æŒ‡å®šçš„è¯ï¼Œåˆ™è®¾ç½®å½“å‰è§†å›¾ä¸‹çš„ä¸‹ä¸€ä¸ªæ²¡å¼€å§‹çš„äº‹åŠ¡ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/03/MySQL%20info/mysql%20%E7%BA%A6%E6%9D%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/MySQL%20info/mysql%20%E7%BA%A6%E6%9D%9F/" class="post-title-link" itemprop="url">mysql DDL çº¦æŸ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-03 22:49:21" itemprop="dateCreated datePublished" datetime="2021-03-03T22:49:21+08:00">2021-03-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>7 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="mysqlçº¦æŸ"><a class="markdownIt-Anchor" href="#mysqlçº¦æŸ"></a> mysqlçº¦æŸ</h1>
<p>æ˜¯ä»€ä¹ˆï¼šæ˜¯ä½œç”¨äºè¡¨ä¸­å­—æ®µä¸Šçš„è§„åˆ™ï¼Œç”¨äºé™åˆ¶å­˜å‚¨åœ¨è¡¨ä¸­çš„æ•°æ®ï¼Œå±äº DDL çš„é™åˆ¶æ“ä½œã€‚<br />
ä¸ºä»€ä¹ˆï¼šä¿è¯æ•°æ®çš„æ­£ç¡®ï¼Œæœ‰æ•ˆï¼Œå®Œæ•´</p>
<p>åˆ†ç±»ï¼š</p>
<ol>
<li>éç©ºçº¦æŸï¼šç®¡ç†çš„å­—æ®µä¸èƒ½å­˜å‚¨nullå€¼ã€‚<code>sname varchar(10) NOT NULL</code></li>
<li>å”¯ä¸€æ€§çº¦æŸï¼šå­˜å‚¨çš„å­—æ®µå€¼ä¸èƒ½æœ‰é‡å¤å€¼ï¼Œä½†æ˜¯å¯ä»¥å­˜å‚¨nullã€‚<code>email varchar(20) UNIQUE</code>ï¼›å”¯ä¸€ä½†æ˜¯å¯ä»¥ä¸ºç©ºï¼Œå¹¶ä¸”å¯ä»¥æœ‰å¤šä¸ªç©ºå€¼ï¼Œ(ç©ºå’Œç©ºä¸ç›¸ç­‰)ã€‚</li>
<li>ä¸»é”®çº¦æŸ <code>sid int PRIMARY KEY</code> ï¼Œé»˜è®¤éç©ºä¸”å”¯ä¸€</li>
<li>å¤–é”®çº¦æŸï¼šè¦æ±‚å¤–é”®å­—æ®µå€¼åº”è¯¥æ¥æºäºå…³è”è¡¨çš„ä¸»é”®çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥å­˜å‚¨nullå€¼ã€‚</li>
<li>é»˜è®¤çº¦æŸï¼šå¦‚æœæ²¡æœ‰æŒ‡å®šå­—æ®µå€¼ï¼Œåˆ™é‡‡ç”¨é»˜è®¤å€¼ <code>DEFAULT</code></li>
<li>æ£€æŸ¥çº¦æŸï¼ˆ8.0.16ç‰ˆæœ¬åï¼‰ï¼šä¿è¯æ»¡è¶³æŸä¸€æ¡ä»¶ <code>CHECK</code></li>
<li>è‡ªå¢ï¼š<code>AUTO_INCREMENT</code></li>
</ol>
<h2 id="è®¾ç½®æ–¹æ³•"><a class="markdownIt-Anchor" href="#è®¾ç½®æ–¹æ³•"></a> è®¾ç½®æ–¹æ³•</h2>
<ol>
<li>å»ºè¡¨æ—¶ç›´æ¥è®¾ç½®</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE stu</span><br><span class="line">(</span><br><span class="line">    `id`     int PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;ä¸»é”®&#x27;,</span><br><span class="line">    `name`   varchar(10) NOT NULL UNIQUE COMMENT &#x27;å§“å&#x27;,</span><br><span class="line">    `age`    int CHECK ( age &gt; 0 and age &lt;= 120 ),</span><br><span class="line">    `status` char(1) DEFAULT &#x27;1&#x27; COMMENT &#x27;çŠ¶æ€&#x27;,</span><br><span class="line">    `gender` char(1) COMMENT &#x27;æ€§åˆ«&#x27;</span><br><span class="line">) comment &#x27;ç”¨æˆ·è¡¨&#x27;;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å»ºè¡¨æ—¶å€™åœ¨çº¦æŸåŒºè¿›è¡Œè®¾ç½®</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE user2(</span><br><span class="line">    id INT,</span><br><span class="line">    `name` VARCHAR(20),</span><br><span class="line">    PRIMARY KEY (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>å»ºåç›´æ¥è®¾ç½®
<ul>
<li>ä¿®æ”¹ name çš„æ•°æ®ç±»å‹å’Œçº¦æŸ -&gt; <code>modify</code></li>
</ul>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE stu MODIFY å­—æ®µåç§° varchar(10) NOT NULL;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹ name çš„åç§°ï¼Œæ•°æ®ç±»å‹å’Œçº¦æŸ -&gt; <code>change</code></li>
</ul>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `è¡¨åç§°` CHANGE æ—§å­—æ®µåç§° æ–°å­—æ®µåç§° å­—æ®µç±»å‹ çº¦æŸ;</span><br></pre></td></tr></table></figure>
å’Œ <code>modify</code> åŒºåˆ«åªåœ¨äºèƒ½å¤Ÿä¿®æ”¹å­—æ®µåç§°ã€‚
<ul>
<li>å¢åŠ å¤–é”®çº¦æŸï¼š</li>
</ul>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE `è¡¨åç§°` ADD UNIQUE (`å­—æ®µå`)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="check"><a class="markdownIt-Anchor" href="#check"></a> Check</h2>
<p><strong>Mysql å¹¶ä¸æ˜¯å¼ºåˆ¶è¦æ±‚çš„ï¼Œå³å¹¶ä¸æ”¯æŒè¿™ä¸ªæ“ä½œ</strong>ï¼› PostgreSQL æ”¯æŒã€‚<br />
å¦‚æœéè¦è®¾ç½®è¿™ä¸ªæ£€æŸ¥çº¦æŸï¼Œåˆ™è§ <a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtianze/p/6700244.html">MySQLå…³äºcheckçº¦æŸæ— æ•ˆçš„è§£å†³åŠæ³•</a> ã€‚</p>
<h3 id="attribute-based-check"><a class="markdownIt-Anchor" href="#attribute-based-check"></a> Attribute-Based Check</h3>
<p>åœ¨å£°æ˜å˜é‡åä½¿ç”¨è¿™ä¸ª Check é€‰é¡¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE Sells</span><br><span class="line">(</span><br><span class="line">    bar   CHAR(20),</span><br><span class="line">    beer  CHAR(20) CHECK ( beer IN</span><br><span class="line">                           (SELECT name FROM Beers)),</span><br><span class="line">    price REAL CHECK ( price &lt;= 5.00 )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><code>beer</code>éƒ¨åˆ†ä¸­ä½¿ç”¨äº†å­æŸ¥è¯¢ä½œä¸º check çš„éƒ¨åˆ† ï¼Œå¯¹è±¡å¯ä»¥æ˜¯æœ¬è¡¨ï¼Œæˆ–è€…å…¶ä»–çš„å¤–éƒ¨è¡¨ ã€‚</p>
<p>åªæœ‰åœ¨æ•°æ®è¢«æ’å…¥æˆ–è€…æ›´æ–°æ—¶ï¼Œæ‰ä¼š check ã€‚</p>
<p>å¦‚æœåœ¨ Beers è¡¨æ ¼ä¸­æœ‰ä¸ªå…ƒç»„è¢«åˆ é™¤äº†ï¼Œé‚£ä¹ˆè¿™ä¸ª check çº¦æŸæ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œæ˜¯ä¸ä¼šè‡ªåŠ¨æ£€æŸ¥çš„ï¼Œå’Œå¤–é”®ä¸åŒã€‚</p>
<h3 id="tuple-based-check"><a class="markdownIt-Anchor" href="#tuple-based-check"></a> Tuple-Based Check</h3>
<p><code>CHECK</code> è¿˜å¯ä»¥ç”¨æ¥çº¦æŸå¤šä¸ªå­—æ®µï¼Œå³ç›´æ¥å¯¹æ•´ä¸ª tuple è¿›è¡Œçº¦æŸï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE Sells</span><br><span class="line">(</span><br><span class="line">    bar   CHAR(20),</span><br><span class="line">    beer  CHAR(20),</span><br><span class="line">    price REAL,</span><br><span class="line">    CHECK (bar = &#x27;Joe&#x27; OR price &lt;= 5.00)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="ä¸»é”®çº¦æŸ"><a class="markdownIt-Anchor" href="#ä¸»é”®çº¦æŸ"></a> ä¸»é”®çº¦æŸ</h2>
<ul>
<li>è®¾ç½®æ–¹æ³•è§ä¸Šæ–‡</li>
</ul>
<h3 id="åˆ é™¤æ–¹æ³•"><a class="markdownIt-Anchor" href="#åˆ é™¤æ–¹æ³•"></a> åˆ é™¤æ–¹æ³•</h3>
<p><code>ALTER TABLE user1 DROP PRIMARY KEY;</code></p>
<p>åˆ é™¤æœ‰ä¸¤ç§æ“ä½œï¼Œ<code>DELETE</code> å’Œ <code>TRUNCATE</code> çš„åŒºåˆ«ï¼š</p>
<ul>
<li><code>DELETE</code> åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œä¸é‡ç½® <code>AUTO_INCREMENT</code> çš„å€¼</li>
<li><code>TRUNCATE</code> æ‘§æ¯è¡¨ï¼Œé‡å»ºè¡¨ï¼Œ <code>AUTO_INCREMENT</code> é‡ç½®ä¸º 1</li>
</ul>
<p>å¦‚æœæƒ³è‡ªå®šä¹‰idçš„å€¼,å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„sqlè¿›è¡Œè®¾ç½®ï¼š<br />
<code>ALTER TABLE è¡¨å AUTO_INCREMENT=èµ·å§‹å€¼;</code></p>
<h3 id="è”åˆçº¦æŸ"><a class="markdownIt-Anchor" href="#è”åˆçº¦æŸ"></a> è”åˆçº¦æŸ</h3>
<p>è”åˆå¤šä¸ªå­—æ®µè®¾ç½®ä¸ºä¸»é”®çº¦æŸ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE user4(</span><br><span class="line">    id INT,</span><br><span class="line">    `name` VARCHAR(20),</span><br><span class="line">    PRIMARY KEY (id,`name`)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- ä¿è¯idå’Œnameå­—æ®µä¸ä¸ºç©º,ç„¶åè”åˆåˆ¤æ–­å”¯ä¸€æ€§</span><br><span class="line">INSERT INTO user4 VALUES(1,&#x27;tom&#x27;); -- æ­£å¸¸æ’å…¥</span><br><span class="line">INSERT INTO user4 VALUES(2,&quot;tom&quot;); -- æ­£å¸¸æ’å…¥</span><br><span class="line">INSERT INTO user4 VALUES(1,&quot;rose&quot;); -- æ­£å¸¸æ’å…¥</span><br><span class="line">INSERT INTO user4 VALUES(2,&quot;rose&quot;); -- æ­£å¸¸æ’å…¥</span><br><span class="line">INSERT INTO user4 VALUES(1,&quot;tom&quot;); -- æ’å…¥å¼‚å¸¸:Duplicate entry &#x27;1-tom&#x27; for key &#x27;PRIMARY&#x27;</span><br><span class="line">INSERT INTO user4 VALUES(NULL,&quot;jack&quot;); -- æ’å…¥å¼‚å¸¸:Column &#x27;id&#x27; cannot be null</span><br><span class="line">INSERT INTO user4 VALUES(3,NULL); -- æ’å…¥å¼‚å¸¸:Column &#x27;name&#x27; cannot be null</span><br></pre></td></tr></table></figure>
<p>è”åˆ uniqueï¼š<br />
<code>create table Test (a int, b int, unique(a, b));</code></p>
<h1 id="å¤–é”®çº¦æŸ"><a class="markdownIt-Anchor" href="#å¤–é”®çº¦æŸ"></a> å¤–é”®çº¦æŸ</h1>
<p>è¢«å¤–é”®ç´¢å¼•çš„ä¸»è¡¨çš„é”®å¿…é¡»è¦æ˜¯ï¼š1.PRIMARY KEY æˆ–è€… 2.UNIQUE ã€‚<br />
ç»™ ä¸¤å¼ è¡¨ å»ºç«‹è¿æ¥ï¼Œä»è€Œä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚<br />
<strong>å­è¡¨</strong>çš„å¤–é”®å…³è”äº†<strong>çˆ¶è¡¨</strong>çš„ä¸»é”®ã€‚</p>
<p>æœ‰ä¸¤ç§å†²çªæƒ…å†µï¼š</p>
<ol>
<li>æ’å…¥å¤–é”®è¡¨æ ¼çš„æ•°æ®ï¼Œä¸»é”®è¡¨ä¸­æ²¡æœ‰ç›¸å¯¹åº”çš„æ•°æ®ã€‚ -ã€‹ æ•°æ®åº“ä¼šç›´æ¥æ‹’ç»</li>
<li>å½“åˆ é™¤ä¸»é”®è¡¨æ ¼ä¸­çš„æ•°æ®æ—¶ï¼Œç›¸è¿æ¥çš„å¤–é”®æ•°æ®ä¼šå˜æˆæ— ä¸»çš„å…ƒç»„ã€‚<br />
å¯ä»¥è®¾ç½®çº¦æŸï¼Œç”¨æ¥å®ç°ï¼šå¦‚æœå­è¡¨æœ‰å¤–é”®å…³è”ä¸€ä¸ªçˆ¶è¡¨ï¼Œé‚£ä¹ˆçˆ¶è¡¨ï¼š
<ol>
<li>æ— æ³•éšæ„åˆ é™¤å…¶è®°å½•ï¼ˆé»˜è®¤ï¼‰</li>
<li>åˆ é™¤åå­è¡¨è®¾ç½® Null</li>
<li>åˆ é™¤åå­è¡¨è®¾ç½®é»˜è®¤å€¼</li>
<li>å­è¡¨ä¹Ÿåˆ é™¤/æ›´æ–°ç›¸åº”è®°å½•ã€‚</li>
</ol>
</li>
</ol>
<p>å»ºç«‹ï¼š</p>
<ol>
<li>åˆ›å»ºæ—¶åœ¨å£°æ˜å®Œå˜é‡ï¼Œtableæ‹¬å·å†…ï¼Œé‡èµ·ä¸€è¡Œæ·»åŠ ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONSTRAINT å¤–é”®çº¦æŸå¯¹è±¡å FOREIGN KEY (å¤–é”®å­—æ®µå) REFERENCES ä¸€æ–¹è¡¨/ä¸»è¡¨(ä¸»é”®å­—æ®µå)</span><br></pre></td></tr></table></figure>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE student_class(</span><br><span class="line">    `id` int PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    `studentid` int not null,</span><br><span class="line">    `classid` int not null,</span><br><span class="line">    &lt; CONSTRAINT fkstudentid &gt; FOREIGN KEY (studentid) REFERENCES student(id),</span><br><span class="line">    &lt; CONSTRAINT fkcourseid &gt; FOREIGN KEY (classid) REFERENCES course(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><code>&lt; CONSTRAINT fkstudentid &gt;</code> å¯ä»¥ä¸åŠ ï¼Œæˆ–è€…ä½¿ç”¨ <code>beer CHAR(20) REFERENCES Beers(name)</code> å£°æ˜åç›´æ¥å»ºç«‹å¤–é”®ã€‚</p>
<p>åŒæ—¶ä¹Ÿæ”¯æŒå¤šä¸ªå­—æ®µå»ºç«‹å¤–é”®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table F(</span><br><span class="line">    a int, b int,</span><br><span class="line">    foreign key (a, b)references P (a, b)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å»ºåç›´æ¥è®¾ç½®</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE å¤šæ–¹è¡¨</span><br><span class="line">ADD CONSTRAINT å¤–é”®çº¦æŸå¯¹è±¡å FOREIGN KEY(å¤–é”®å­—æ®µå)</span><br><span class="line">REFERENCE ä¸€æ–¹è¡¨/ä¸»è¡¨(ä¸»é”®å­—æ®µ)</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤å¤–é”®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE å¤šæ–¹è¡¨</span><br><span class="line">DROP FOREIGN KEY å¤–é”®çº¦æŸå¯¹è±¡å;</span><br></pre></td></tr></table></figure>
<h2 id="å¤–é”®çº¦æŸçš„åˆ é™¤å’Œæ›´æ–°è¡Œä¸º"><a class="markdownIt-Anchor" href="#å¤–é”®çº¦æŸçš„åˆ é™¤å’Œæ›´æ–°è¡Œä¸º"></a> å¤–é”®çº¦æŸçš„åˆ é™¤å’Œæ›´æ–°è¡Œä¸º</h2>
<ul>
<li>NO ACTION / RESTRICT ï¼šå½“åœ¨ã€Œä¸€æ–¹è¡¨/çˆ¶è¡¨ã€ä¸­æ›´æ–°/åˆ é™¤å¯¹åº”è®°å½•æ—¶å€™ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰å¤–é”®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ã€Œä¸å…è®¸æ›´æ–°ã€ã€‚</li>
<li>CASCADEï¼šåœ¨ã€Œä¸€æ–¹è¡¨/çˆ¶è¡¨ã€ä¸­ã€Œæ›´æ–°/åˆ é™¤ã€å¯¹åº”è®°å½•æ—¶å€™ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰å¤–é”®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¹Ÿä¼šã€Œæ›´æ–°/åˆ é™¤ã€å­è¡¨è®°å½•ã€‚</li>
<li>SET NULLï¼šåœ¨ã€Œä¸€æ–¹è¡¨/çˆ¶è¡¨ã€ä¸­ã€Œåˆ é™¤ã€å¯¹åº”è®°å½•æ—¶å€™ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰å¤–é”®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¼šå°†ã€Œå­è¡¨ã€ä¸­çš„å¯¹åº”å€¼è®¾ç½®ä¸º nullã€‚</li>
<li>SET DEFAULTï¼šåœ¨ã€Œä¸€æ–¹è¡¨/çˆ¶è¡¨ã€ä¸­ã€Œåˆ é™¤ã€å¯¹åº”è®°å½•æ—¶å€™ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰å¤–é”®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¼šå°†ã€Œå­è¡¨ã€ä¸­çš„å¯¹åº”å€¼è®¾ç½®ä¸ºã€ŒDEFAULT å€¼ã€ï¼ˆInnodb ä¸æ”¯æŒï¼‰ã€‚</li>
</ul>
<p>è®¾ç½®æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE å­è¡¨å</span><br><span class="line">ADD CONSTRAINT å¤–é”®çº¦æŸå¯¹è±¡å</span><br><span class="line">FOREIGN KEY (å¤–é”®å­—æ®µ) REFERENCES ä¸€æ–¹è¡¨/çˆ¶è¡¨å (ä¸»è¡¨å­—æ®µå)</span><br><span class="line">ON [UPDATE, DELETE] [æ›´æ–°è¡Œä¸ºåç§° e.g. CASCADE]</span><br></pre></td></tr></table></figure>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE Sells (</span><br><span class="line">    bar CHAR(20),</span><br><span class="line">    beer CHAR(20),</span><br><span class="line">    price REAL,</span><br><span class="line">    FOREIGN KEY(beer) REFERENCES Beers(name)</span><br><span class="line">    ON DELETE SET NULL ON UPDATE CASCADE );</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/03/MySQL%20info/mysql%20DDL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/MySQL%20info/mysql%20DDL/" class="post-title-link" itemprop="url">mysql DDL Data Definition Language</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-03 22:44:21" itemprop="dateCreated datePublished" datetime="2021-03-03T22:44:21+08:00">2021-03-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>2.2k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>11 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>DDL (Data Definition Language) æ•°æ®åº“å®šä¹‰è¯­è¨€<br />
ç”¨äºå®šä¹‰SQLæ¨¡å¼ã€åŸºæœ¬è¡¨ã€è§†å›¾å’Œç´¢å¼•çš„åˆ›å»ºå’Œæ’¤æ¶ˆæ“ä½œï¼Œåœ¨å»ºè¡¨çš„æ—¶å€™ä½¿ç”¨ã€‚</p>
<ul>
<li>CREATE</li>
<li>ALTER</li>
<li>DROP</li>
<li>TRUNCATE</li>
<li>COMMIT</li>
<li>RENAME</li>
</ul>
<h3 id="æ‰“å¼€ä¸é€€å‡º"><a class="markdownIt-Anchor" href="#æ‰“å¼€ä¸é€€å‡º"></a> æ‰“å¼€ä¸é€€å‡º</h3>
<p>å‘½ä»¤è¡Œï¼šè¾“å…¥ <code>mysql -u root -p</code>ï¼Œè¿˜å¯ä»¥é€‰æ·» <code>-P 3306</code> æ¥è®¾ç½®ç«¯å£å·<br />
è¿›å…¥åï¼š<code>quit</code>é€€å‡º</p>
<h3 id="æ•°æ®åº“ç®¡ç†å‘½ä»¤"><a class="markdownIt-Anchor" href="#æ•°æ®åº“ç®¡ç†å‘½ä»¤"></a> æ•°æ®åº“ç®¡ç†å‘½ä»¤</h3>
<ul>
<li>æ‰€æœ‰çš„è¡¨æ–‡ä»¶éƒ½å­˜æ”¾åœ¨dataæ–‡ä»¶å¤¹ä¸­</li>
<li>æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“åï¼š<code>show databases;</code></li>
<li>information_schema å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ¯æ¬¡éƒ½ä¼šè‡ªåŠ¨é”€æ¯</li>
<li>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼š
<ol>
<li><code>create database [if not exists] æ•°æ®åº“å [default charset utf8mb4];</code><br />
<code>[if not exists]</code>æ˜¯å¯é€‰æ‹©çš„ï¼Œç”¨æ¥é˜²æ­¢æŠ¥é”™ã€‚<br />
<code>[default charset utf8]</code>ä¸ºæŒ‡å®šçš„é»˜è®¤å­—ç¬¦é›†ã€‚</li>
<li>ç›®å½•ä¸‹æ‰‹åŠ¨æ–°å»ºæ–‡ä»¶å¤¹ä¹Ÿå¯ä»¥</li>
</ol>
</li>
<li>åˆ é™¤ä¸€ä¸ªæ•°æ®åº“ï¼š<code>drop database æ•°æ®åº“å;</code><br />
å¦‚æœè¡¨å­˜åœ¨åˆ™åˆ é™¤è¡¨ï¼ˆç”¨äºé‡æ–°åˆ›å»ºï¼‰ï¼š<code>drop table if exists suspects;</code></li>
<li>ä½¿ç”¨æ•°æ®åº“ <code>use database æ•°æ®åº“å;</code></li>
<li>æŸ¥è¯¢å½“å‰çš„æ•°æ®åº“ <code>select database();</code> æ³¨æ„åŠ ä¸ªæ‹¬å·</li>
</ul>
<h3 id="è¡¨æ–‡ä»¶ç®¡ç†å‘½ä»¤"><a class="markdownIt-Anchor" href="#è¡¨æ–‡ä»¶ç®¡ç†å‘½ä»¤"></a> è¡¨æ–‡ä»¶ç®¡ç†å‘½ä»¤</h3>
<ul>
<li>
<p>æŸ¥çœ‹æŒ‡å®šçš„æ•°æ®åº“ä¸‹æ‰€æœ‰çš„è¡¨æ–‡ä»¶åï¼š</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use æ•°æ®åº“å;</span><br><span class="line">show tables;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>åœ¨æŒ‡å®šæ•°æ®åº“ä¸‹åˆ›å»ºè¡¨æ–‡ä»¶ï¼š</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use æ•°æ®åº“å;</span><br><span class="line">create table è¡¨æ–‡ä»¶å(</span><br><span class="line">    å­—æ®µå æ•°æ®ç±»å‹å [comment å­—æ®µæ³¨é‡Š],</span><br><span class="line">    å­—æ®µå æ•°æ®ç±»å‹å  &lt;--æœ€åä¸€ä¸ªå­—æ®µä¸è¦åŠ &quot;,&quot;</span><br><span class="line">) [comment è¡¨æ³¨é‡Š];</span><br></pre></td></tr></table></figure>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database bjpowernode;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; use bjpowernode;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table stu(</span><br><span class="line">    -&gt; sid int,</span><br><span class="line">    -&gt; sname varchar(10),</span><br><span class="line">    -&gt; age int</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œé¢ï¼Œå­—ç¬¦ä¸²ç±»å‹ä½¿ç”¨ <strong>varchar(5)</strong>ï¼Œæ‹¬å·å†…æ”¾ç½®æœ€å¤§å­—ç¬¦é•¿åº¦ã€‚<br />
å¯ä»¥ä½¿ç”¨<code> [comment å­—æ®µæ³¨é‡Š]/[comment è¡¨æ³¨é‡Š]</code> è¿›è¡Œæ³¨é‡Šã€‚</p>
  <details>
  <summary>è¯¦ç»†çš„ char-us-varcharï¼Œå„ç§æ•°å€¼ç±»å‹å¯¹æ¯”</summary>
<table>
<thead>
<tr>
<th style="text-align:center">Value</th>
<th style="text-align:center">CHAR(4)</th>
<th style="text-align:center">CHAR(4)-Storage</th>
<th style="text-align:center">VARCHAR(4)</th>
<th style="text-align:center">VARCHAR(4)-Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">â€œâ€</td>
<td style="text-align:center">â€™    â€™</td>
<td style="text-align:center">4 bytes</td>
<td style="text-align:center">&quot;</td>
<td style="text-align:center">1 byte</td>
</tr>
<tr>
<td style="text-align:center">â€˜abâ€™</td>
<td style="text-align:center">'ab  â€™</td>
<td style="text-align:center">4 bytes</td>
<td style="text-align:center">â€˜abâ€™</td>
<td style="text-align:center">3 bytes</td>
</tr>
<tr>
<td style="text-align:center">â€˜abcdâ€™</td>
<td style="text-align:center">â€˜abcdâ€™</td>
<td style="text-align:center">4 bytes</td>
<td style="text-align:center">â€˜abcdâ€™</td>
<td style="text-align:center">5 bytes</td>
</tr>
<tr>
<td style="text-align:center">â€˜abcdefghâ€™</td>
<td style="text-align:center">â€˜abcdâ€™</td>
<td style="text-align:center">4 bytes</td>
<td style="text-align:center">â€˜abcdâ€™</td>
<td style="text-align:center">5 bytes</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">Type</th>
<th style="text-align:left">Storage</th>
<th style="text-align:left">Minimum Value</th>
<th style="text-align:left">Maximum Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">(Bytes)</td>
<td style="text-align:left">(Signed/Unsigned)</td>
<td style="text-align:left">(Signed/Unsigned)</td>
</tr>
<tr>
<td style="text-align:left">TINYINT</td>
<td style="text-align:left">1</td>
<td style="text-align:left">-128</td>
<td style="text-align:left">127</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">255</td>
</tr>
<tr>
<td style="text-align:left">SMALLINT</td>
<td style="text-align:left">2</td>
<td style="text-align:left">-32768</td>
<td style="text-align:left">32767</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">65535</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMINT</td>
<td style="text-align:left">3</td>
<td style="text-align:left">-8388608</td>
<td style="text-align:left">8388607</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">16777215</td>
</tr>
<tr>
<td style="text-align:left">INT</td>
<td style="text-align:left">4</td>
<td style="text-align:left">-2147483648</td>
<td style="text-align:left">2147483647</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">4294967295</td>
</tr>
<tr>
<td style="text-align:left">BIGINT</td>
<td style="text-align:left">8</td>
<td style="text-align:left">-9223372036854775808</td>
<td style="text-align:left">9223372036854775807</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">18446744073709551615</td>
</tr>
</tbody>
</table>
  </details>
<ul>
<li>æ•°æ®ç±»å‹ï¼š
<ul>
<li>CHAR(n) å­˜å‚¨æ—¶å³è¾¹ä¼šä½¿ç”¨ç©ºæ ¼è¿›è¡Œå ä½</li>
<li>VARCHAR() å¯å˜é•¿åº¦å­—ç¬¦ä¸²ï¼Œä¸è¿›è¡Œå ä½ï¼Œå­˜å‚¨æ—¶ä¼šå°†é•¿åº¦å­˜å‚¨ä¸º prefix</li>
<li>INT</li>
<li>FLOAT / REAL</li>
<li>YEAR: YYYY</li>
<li>TIME: HH:MM:SS</li>
<li>DATE: YYYY-MM-DD</li>
<li>DATETIME: YYYY-MM-DD HH:MM:SS<br />
æ¯”å¦‚ï¼š<code>insert into test values('2016-1-1', '2016- 1-1 3:10:10')</code>ï¼Œåˆ†åˆ«å¯¹åº” <code>date</code> å’Œ <code>datetime</code> ã€‚</li>
<li>TIMESTAMP: YYYY-MM-DD HH:MM:SS æè¿°çš„æ—¶é—´åœ¨ä¸åŒæ—¶åŒºç´¢å¼•å‡ºæ¥å¯èƒ½æ˜¯ä¸åŒçš„ï¼ŒåŠ¨æ€è®¡ç®—å‡ºå¯¹åº”æ—¶åŒºæ—¶é—´ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>åˆ é™¤è¡¨æ–‡ä»¶ï¼š <code>drop table è¡¨æ–‡ä»¶å;</code></p>
</li>
<li>
<p>æŸ¥çœ‹è¡¨æ–‡ä»¶ä¸­çš„å­—æ®µä¿¡æ¯ï¼š <code>desc è¡¨æ–‡ä»¶åç§°;</code></p>
</li>
<li>
<p>æŸ¥çœ‹è¡¨æ–‡ä»¶ä¸­æ›´è¯¦ç»†çš„ä¿¡æ¯/åˆ›å»ºçš„å‘½ä»¤ï¼š <code>show create table è¡¨æ–‡ä»¶åç§°;</code></p>
</li>
<li>
<p>ä¸ºè¡¨æ–‡ä»¶æ·»åŠ å­—æ®µï¼š <code>alter table è¡¨æ–‡ä»¶å add æ–°å­—æ®µå æ•°æ®ç±»å‹åç§° &lt;attribute declaration&gt;;</code></p>
</li>
<li>
<p>ä¿®æ”¹æ•°æ®ç±»å‹ï¼š <code>alter table è¡¨æ–‡ä»¶å modify å­—æ®µå æ–°æ•°æ®ç±»å‹;</code></p>
</li>
<li>
<p>åˆ é™¤è¡¨æ–‡ä»¶å­—æ®µï¼š <code>alter table è¡¨æ–‡ä»¶å drop å­—æ®µå;</code></p>
</li>
</ul>
<h3 id="è¡¨æ–‡ä»¶æ•°æ®è¡Œç®¡ç†å‘½ä»¤"><a class="markdownIt-Anchor" href="#è¡¨æ–‡ä»¶æ•°æ®è¡Œç®¡ç†å‘½ä»¤"></a> è¡¨æ–‡ä»¶æ•°æ®è¡Œç®¡ç†å‘½ä»¤</h3>
<ul>
<li>æ’å…¥å‘½ä»¤ï¼šè¦æ±‚mysqlæœåŠ¡å™¨å‘æŒ‡å®šçš„è¡¨æ–‡ä»¶ä¸­æ·»åŠ æ•°æ®è¡Œ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into è¡¨æ–‡ä»¶å (å­—æ®µå1,å­—æ®µå2,å­—æ®µå3)</span><br><span class="line">values(å€¼1,å€¼2,å€¼3);        &lt;-å­—ç¬¦ä¸²å’Œæ—¥æœŸçš„å€¼ä½¿ç”¨å•å¼•å·æ‰©èµ·æ¥</span><br></pre></td></tr></table></figure>
<ul>
<li>æ‰¹é‡æ’å…¥ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insert into è¡¨æ–‡ä»¶å(å­—æ®µ1,å­—æ®µ2,å­—æ®µ3)</span><br><span class="line">values</span><br><span class="line">(å€¼1,å€¼2,å€¼3),</span><br><span class="line">(å€¼1,å€¼2,å€¼3),</span><br><span class="line">(å€¼1,å€¼2,å€¼3);</span><br></pre></td></tr></table></figure>
<ul>
<li>ç®€åŒ–ç‰ˆæœ¬æ’å…¥å‘½ä»¤ï¼š<code>insert into è¡¨æ–‡ä»¶å values(å€¼1,å€¼2,å€¼3);</code><br />
å¦‚æœæ’å…¥æ•°æ®æ—¶ï¼Œæ¯ä¸€ä¸ªå­—æ®µéƒ½å¯ä»¥èµ‹å€¼ï¼Œæ­¤æ—¶æ’å…¥å‘½ä»¤ä¸éœ€è¦æŒ‡å®šå­—æ®µåï¼Œæ•°æ®é¡ºåºæ­¤æ—¶è¦ä¸è¡¨æ–‡ä»¶å­—æ®µé¡ºåºç›¸åŒ</li>
<li>åˆ é™¤å‘½ä»¤ï¼š
<ol>
<li><code>delete from è¡¨æ–‡ä»¶å;</code>åˆ é™¤æ‰€æœ‰æ•°æ®</li>
<li><code>delete from è¡¨æ–‡ä»¶å where åˆ¤æ–­æ¡ä»¶;</code>åˆ é™¤æ»¡è¶³æ¡ä»¶çš„æ•°æ®è¡Œæ•°æ®ã€‚åˆ¤æ–­æ•°æ®ä¸€èˆ¬æ”¾ç½®å…³ç³»æ¡ä»¶æˆ–è€…é€»è¾‘æ¡ä»¶ã€‚(ç­‰äºä½¿ç”¨å•ç­‰å·=)</li>
</ol>
</li>
<li>æ›´æ–°å‘½ä»¤ï¼šè¦æ±‚mysqlæœåŠ¡å™¨å°†æŒ‡å®šçš„è¡¨æ–‡ä»¶æ•°æ®è¿›è¡Œæ›´æ–°
<ol>
<li>å¯¹æ‰€æœ‰æ•°æ®è¡Œ<code>update è¡¨æ–‡ä»¶å set å­—æ®µå1=å€¼,å­—æ®µå2=å€¼ [WHERE æ¡ä»¶];</code></li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; update stu set age=age+3;</span><br><span class="line">Query OK, 2 rows affected (0.00 sec)</span><br><span class="line">Rows matched: 2  Changed: 2  Warnings: 0</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å¯¹æŒ‡å®šæ•°æ®è¡Œ<code>update è¡¨æ–‡ä»¶å set å­—æ®µå1=å€¼,å­—æ®µå2=å€¼ where åˆ¤æ–­æ¡ä»¶;</code>ä½¿ç”¨whereæ¥é€‰æ‹©</li>
</ol>
</li>
<li>æ•°æ®è¡Œå¤åˆ¶å‘½ä»¤ï¼š<code>insert into B select * from A</code>å¯ä»¥å°†è¡¨Aä¸­çš„æ•°æ®è¡Œå¤åˆ¶åˆ°è¡¨B(è¦æ±‚è¡¨Aä¸è¡¨Bå­—æ®µç»“æ„å®Œå…¨ä¸€è‡´)</li>
<li>è¡¨æ–‡ä»¶å¤‡ä»½å‘½ä»¤ï¼š<code>create table B select * from A</code>å°†è¡¨Aè¿›è¡Œä¸€æ¬¡å¤‡ä»½ï¼Œå¤‡ä»½ç”Ÿæˆè¡¨B</li>
</ul>
<h3 id="æŸ¥è¯¢å‘½ä»¤-dql"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢å‘½ä»¤-dql"></a> æŸ¥è¯¢å‘½ä»¤ DQL</h3>
<ul>
<li>æŸ¥è¯¢å‘½ä»¤ï¼š<code>select * from è¡¨æ–‡ä»¶å;</code>è¦æ±‚mysqlæœåŠ¡å™¨å°†æŒ‡å®šçš„è¡¨æ–‡ä»¶æ•°æ®è¿›è¡Œå±•ç¤º</li>
<li>è¯­æ³•ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT å­—æ®µåˆ—è¡¨</span><br><span class="line">FROM è¡¨å</span><br><span class="line">WHERE æ¡ä»¶åˆ—è¡¨</span><br><span class="line">GROUP BY åˆ†ç»„å­—æ®µåˆ—è¡¨</span><br><span class="line">HAVING åˆ†ç»„åæ¡ä»¶åˆ—è¡¨</span><br><span class="line">ORDER BY æ’åºå­—æ®µåˆ—è¡¨</span><br><span class="line">LIMIT åˆ†é¡µå‚æ•°</span><br></pre></td></tr></table></figure>
<h3 id="mqlæ‰§è¡Œè®¡åˆ’explain"><a class="markdownIt-Anchor" href="#mqlæ‰§è¡Œè®¡åˆ’explain"></a> mqlæ‰§è¡Œè®¡åˆ’(explain)</h3>
<ol>
<li>å‘½ä»¤æ ¼å¼ï¼šexplain æŸ¥è¯¢å‘½ä»¤</li>
<li>å‘½ä»¤ä½œç”¨ï¼šå±•ç¤ºå½“å‰æŸ¥è¯¢å¾—åˆ°çš„ç»“æœæ˜¯å¦é€šè¿‡ç´¢å¼•æ¥è¿›è¡Œå®šä½</li>
<li>ä¾‹å­ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM emp WHERE ename=&#x27;smith&#x27;</span><br><span class="line">--&gt; EXPLAIN SELECT * FROM emp WHERE ename=&#x27;smith&#x27;</span><br><span class="line">--&gt; type: ref(ç´¢å¼•æŸ¥è¯¢) rows:1(æŸ¥è¯¢æ¬¡æ•°)</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>åˆ¤æ–­ï¼štypeå±æ€§è¡¨ç¤ºæ‰§è¡Œæ•ˆç‡ã€‚<br />
<strong>all</strong>(å¯¹æ‰€æœ‰æ•°æ®è¡Œè¿›è¡Œéå†)<br />
<strong>type</strong>(WHEREå¯¹æ‰€æœ‰æ•°æ®è¡Œè¿›è¡Œéå†ï¼ŒSELECTä»ç´¢å¼•ä¸­æŠ“å–)<br />
<strong>range</strong>(WHEREç›´æ¥é€šè¿‡ç´¢å¼•æ¥æŸ¥è¯¢ï¼Œä½†æ˜¯ä¸ç¨³å®šï¼Œå› ä¸ºå­—æ®µå˜åŒ–æ—¶ä¼šå¯¼è‡´å¤±æ•ˆ)<br />
<strong>ref</strong>(WHEREç›´æ¥é€šè¿‡ç´¢å¼•æ¥æŸ¥è¯¢ï¼Œä¸€æ¬¡åªå¾—åˆ°ä¸€è¡Œæ•°æ® --&gt; è¯¥è¡Œæ•°æ®æ²¡æœ‰é‡å¤)<br />
<strong>const</strong>(é€šè¿‡ä¸»é”®ç´¢å¼•æ¥è¿›è¡Œå®šä½)</li>
</ol>
<p><strong>mysqlå¦‚æœå‘ç°é€šè¿‡ç´¢å¼•å¾—åˆ°æ•°æ®è¡Œæ•°&gt;1/3æ˜¯ï¼Œä¼šè‡ªåŠ¨æ”¾å¼ƒç´¢å¼•æŸ¥è¯¢ï¼Œtypeä¾ç„¶æ˜¯all</strong></p>
<h3 id="è§†å›¾"><a class="markdownIt-Anchor" href="#è§†å›¾"></a> è§†å›¾</h3>
<ol>
<li>å®šä¹‰ï¼šMysqlå¯¹è±¡ï¼Œç”¨äºå­˜å‚¨ <strong>æŸ¥è¯¢è¯­å¥</strong> ã€‚</li>
<li>ç›®çš„ï¼šæé«˜æŸ¥è¯¢è¯­å¥ä½¿ç”¨æ•ˆç‡ï¼Œå¯å¤ç”¨æ€§ã€‚</li>
<li>å‘½ä»¤ï¼š<code>CREATE VIEW è§†å›¾å¯¹è±¡å AS æŸ¥è¯¢è¯­å¥;</code></li>
<li>è°ƒç”¨ï¼š<code>SELECT * FROM è§†å›¾å¯¹è±¡å;</code>ï¼Œè¿˜å¯ä»¥é€šè¿‡è§†å›¾å¯¹è±¡å…³è”è¡¨æ–‡ä»¶æ•°æ®è¡Œè¿›è¡Œæ’å…¥ï¼Œåˆ é™¤ï¼Œæ›´æ–°æ“ä½œã€‚</li>
<li>ä½œç”¨ï¼š<strong>éšè—ä¸šåŠ¡ä¸­æ¶‰åŠè¡¨å…³ç³»ï¼Œå¼€å‘äººå‘˜é€šè¿‡è§†å›¾è¿›è¡Œæ“ä½œæ—¶ä¸ä¼šçŸ¥é“å…·ä½“æ“ä½œçš„è¡¨ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- åˆ›å»ºè§†å›¾</span><br><span class="line">CREATE VIEW CanDrink AS</span><br><span class="line">SELECT distinct drinker, beer</span><br><span class="line">FROM Frequents, Sells</span><br><span class="line">WHERE Frequents.bar = Sells.bar;</span><br><span class="line"></span><br><span class="line">-- ä½¿ç”¨è§†å›¾</span><br><span class="line">select beer from CanDrink</span><br><span class="line">where drinker = &#x27;Bill&#x27;;</span><br></pre></td></tr></table></figure>
<p>DBMS ä¼šå°†è§†å›¾å…ˆå­˜å‚¨èµ·æ¥ï¼Œç„¶åäº¤ç»™ä¸‹é¢çš„æŸ¥è¯¢è¯­å¥ç»§ç»­è°ƒç”¨ã€‚<br />
å…·ä½“åœ°ï¼ŒDBMS å¹¶ <strong>ä¸æ˜¯å­˜å‚¨äº†è§†å›¾è¡¨æ ¼</strong>ï¼Œè€Œæ˜¯å­˜å‚¨äº†ä»–çš„ <strong>æŸ¥è¯¢è¯­å¥</strong>ï¼ˆæœ‰ç‚¹åƒå…³ç³»ä»£æ•°ï¼‰ï¼Œåœ¨åé¢è°ƒç”¨è§†å›¾æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥è¯­å¥è¿›è¡Œå†…åµŒã€‚</p>
<blockquote>
<p>The queries defining any views used by the query are also replaced by their algebraic equivalents, and â€œspliced intoâ€ the expression tree for the query.</p>
</blockquote>
<br>
<p><strong>What Happens When We Query a View ?</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- build view</span><br><span class="line">CREATE VIEW LA- view AS</span><br><span class="line">SELECT buyer, seller, product, store</span><br><span class="line">FROM Person, Purchase</span><br><span class="line">WHERE Person.city = â€˜LAâ€™</span><br><span class="line">  AND Person.name = Purchase.buyer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- query on view</span><br><span class="line">SELECT name, LA-view.store</span><br><span class="line">FROM LA-view, Product</span><br><span class="line">WHERE LA-view.product = Product.name AND Product.category = &#x27;shoes&#x27;</span><br></pre></td></tr></table></figure>
<p>åº•å±‚çš„å®ç°ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT name, Purchase.store</span><br><span class="line">FROM Person, Purchase, Product</span><br><span class="line">WHERE   Person.city = &#x27;LA&#x27; AND</span><br><span class="line">        Person.name = Purchase.buyer AND</span><br><span class="line">        Purchase.product = Product.name AND</span><br><span class="line">        Product.category = &#x27;shoes&#x27;;</span><br></pre></td></tr></table></figure>
<br>
<p>åŒæ—¶ï¼Œå†…åµŒä¹‹åï¼ŒDBMS ä¼šè‡ªåŠ¨ä¼˜åŒ–ç»„åˆèµ·æ¥çš„æŸ¥è¯¢è¯­å¥ï¼Œå®ç°æŸ¥è¯¢åŠ å¿«çš„æ•ˆæœã€‚<br />
<img src="https://pica.zhimg.com/80/v2-ab12768d5bd8a5992b05bfad83634406_1440w.png" alt="" /></p>
<p>ä¸»è¦æ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å°† select æ“ä½œå‘åº•å±‚æ¨ï¼Œè¿™æ ·éœ€è¦ join çš„æ¡ç›®å°±å°‘äº†</li>
<li>å°† project æ“ä½œå‘ä¸Šæ¨ï¼Œå…ˆè¿ç®—ï¼Œå†æŠ•å½±</li>
</ol>
<h3 id="å­˜å‚¨å¼•æ“"><a class="markdownIt-Anchor" href="#å­˜å‚¨å¼•æ“"></a> å­˜å‚¨å¼•æ“</h3>
<ol>
<li>å®šä¹‰ï¼šæ˜¯mysqlæœåŠ¡å™¨å¯¹è¡¨æ–‡ä»¶å†…å®¹çš„ç®¡ç†æ–¹å¼ï¼Œç›®å‰ä¸»è¦é‡‡ç”¨INNODBï¼ŒMyisam.</li>
<li>ç®¡ç†å‘½ä»¤ï¼š
<ul>
<li>æŸ¥çœ‹æ”¯æŒå­˜å‚¨å¼•æ“ç§ç±»ï¼š<code>show engines</code>ï¼Œé»˜è®¤ä½¿ç”¨innodbå¼•æ“</li>
<li>ä¿®æ”¹å¼•æ“ï¼Œ<code>my.cnfæ–‡ä»¶</code>ï¼Œåœ¨<code>/etc</code>é…ç½®æ–‡ä»¶å¤¹ä¸‹ï¼Œ<code>default-storage-engine=INNODB</code></li>
<li>è®¾ç½®è¡¨æ–‡ä»¶å‘¢ä¾èµ–çš„å­˜å‚¨å¼•æ“ï¼š<code>alter TABLE è¡¨å ENGINE=å­˜å‚¨å¼•æ“</code></li>
</ul>
</li>
<li>å­˜å‚¨å¼•æ“ç‰¹å¾ï¼š
<ul>
<li>Myisamï¼š
<ul>
<li>ä¿®æ”¹è¡¨æ—¶ï¼Œä¸ä¼šå¤‡ä»½ã€‚æé«˜æ•ˆç‡ï¼Œæ“ä½œåæ— æ³•å–æ¶ˆæœ¬æ“ä½œã€‚</li>
<li>ä½¿ç”¨ä¸‰ä¸ªè¡¨å­˜å‚¨ä¿¡æ¯ï¼š<strong>test1.frm</strong>å‚¨å­˜è¡¨æ–‡ä»¶å­—æ®µä¿¡æ¯ï¼Œ<strong>test1.myd</strong>å‚¨å­˜è¡¨æ–‡ä»¶æ•°æ®è¡Œä¿¡æ¯ï¼Œ<strong>test1.myi</strong>å­˜å‚¨è¡¨æ–‡ä»¶å­—æ®µå…³è”çš„ç´¢å¼•ä¿¡æ¯ã€‚</li>
</ul>
</li>
<li>INNODBï¼š
<ul>
<li>å¯¹è¡¨å†…å®¹ä¿®æ”¹æ—¶ï¼Œé¦–å…ˆè¿›è¡Œä¸€æ¬¡å¤‡ä»½ï¼Œå› æ­¤æ•ˆç‡è¾ƒæ…¢ã€‚</li>
<li>ä½†æ˜¯æ‰§è¡Œå®Œæ¯•åï¼Œå¯ä»¥ä½¿ç”¨å¤‡ä»½å–æ¶ˆå½“å‰æ“ä½œï¼Œå¢åŠ å®‰å…¨æ€§ã€‚</li>
<li>ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶<strong>test1.frm</strong>å­˜å‚¨æ‰€æœ‰ä¿¡æ¯ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="äº‹ç‰©transaction"><a class="markdownIt-Anchor" href="#äº‹ç‰©transaction"></a> äº‹ç‰©(transaction)</h3>
<ol>
<li>ä»‹ç»ï¼šç”¨äºå¯¹å½“å‰è¡¨æ–‡ä»¶å¤‡ä»½è¿›è¡Œç®¡ç†ã€‚</li>
<li>å‘½ä»¤æ ¼å¼ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">start transaction #é€šè¿‡æœåŠ¡å™¨æä¾›ä¸€ä¸ªäº‹ç‰©å¯¹è±¡æ¥ç®¡ç†å¤‡ä»½æ¥ä¸‹æ¥çš„æ“ä½œ</span><br><span class="line">delete from emp where deptno=30 #ç”Ÿæˆemp.bak</span><br><span class="line">delete from dept where deptno=30 #ç”Ÿæˆemp.bak</span><br><span class="line">ROLLBACK #å–æ¶ˆæœ¬æ¬¡æ“ä½œ</span><br><span class="line">COMMIT #æäº¤æ“ä½œï¼šå°†æœ¬æ¬¡æ“ä½œçš„æ‰€æœ‰å¤‡ä»½ä¿¡æ¯åˆ é™¤</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/03/MySQL%20info/mysql%20%E7%B4%A2%E5%BC%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/MySQL%20info/mysql%20%E7%B4%A2%E5%BC%95/" class="post-title-link" itemprop="url">mysql ç´¢å¼•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-03 22:44:21" itemprop="dateCreated datePublished" datetime="2021-03-03T22:44:21+08:00">2021-03-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>9 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>mysqlç´¢å¼•(index)</strong></p>
<p>ä¸åŠ ç´¢å¼•çš„æ—¶å€™ï¼Œåœ¨åŒ¹é…æŸä¸ªå±æ€§æ—¶ï¼Œæ˜¯ä¸€ä¸ªä¸€ä¸ªè¿›è¡ŒåŒ¹é…æ‰«æçš„ã€‚</p>
<ul>
<li>ä¼˜ç‚¹
<ul>
<li>ä½¿ç”¨å¹³è¡¡æ ‘æ¥å­˜å‚¨æ•°æ®ï¼Œé™ä½æŸ¥è¯¢æ—¶é—´ -&gt; io æˆæœ¬</li>
<li>é™ä½æ•°æ®æ’åºçš„æˆæœ¬ -&gt; cpu æˆæœ¬</li>
</ul>
</li>
<li>ç¼ºç‚¹
<ul>
<li>é™ä½æ›´æ–°è¡¨çš„æ•ˆç‡ï¼š<br />
å¢åˆ æ”¹æ•°æ®éƒ½ä¼šæ”¹å˜å¹³è¡¡æ ‘å„èŠ‚ç‚¹ä¸­çš„ç´¢å¼•æ•°æ®å†…å®¹ï¼Œç ´åæ ‘ç»“æ„ã€‚<br />
å› æ­¤ï¼Œåœ¨æ¯æ¬¡æ•°æ®æ”¹å˜æ—¶ï¼Œ DBMSå¿…é¡»å»é‡æ–°æ¢³ç†æ ‘ï¼ˆç´¢å¼•ï¼‰çš„ç»“æ„ä»¥ç¡®ä¿å®ƒçš„æ­£ç¡®ï¼Œ</li>
<li>ç´¢å¼•åˆ—é¢å¤–å ç”¨ç£ç›˜ç©ºé—´ -&gt; b+æ ‘</li>
</ul>
</li>
</ul>
<p>ç´¢å¼•å‘½ä»¤è¯­æ³•ï¼š</p>
<ul>
<li>æ·»åŠ ç´¢å¼•ï¼š<code>CREATE INDEX ç´¢å¼•å ON è¡¨å(å­—æ®µ, ...)</code></li>
<li>æŸ¥çœ‹ç´¢å¼•ï¼š<code>SHOW INDEX FROM è¡¨å</code><br />
è¿™æ—¶ä¼šçœ‹åˆ°ä¸‰ä¸ªç´¢å¼•ï¼Œå› ä¸ºæœåŠ¡å™¨ä¼šé»˜è®¤ä¸º<strong>ä¸»é”®çº¦æŸ</strong>ï¼Œ<strong>å¤–é”®çº¦æŸ</strong>ï¼Œ<strong>å”¯ä¸€æ€§çº¦æŸ</strong>ç»‘å®šç´¢å¼•ã€‚</li>
<li>åˆ é™¤ç´¢å¼•ï¼š<code>DROP INDEX ç´¢å¼•å ON è¡¨å</code>ã€</li>
</ul>
<p>å¸¸ç”¨çš„å­˜å‚¨ç´¢å¼•çš„æ•°æ®ç»“æ„ï¼šhashmap , b+ tree , R-tree , Ful-text</p>
<p>ç´¢å¼•åˆ†ç±»ï¼š</p>
<ol>
<li>ä¸»é”®ç´¢å¼•ï¼šé»˜è®¤è‡ªåŠ¨åˆ›å»ºï¼Œå”¯ä¸€</li>
<li>å”¯ä¸€ç´¢å¼•ï¼šé»˜è®¤è‡ªåŠ¨åˆ›å»ºï¼Œå¯ä»¥æœ‰å¤šä¸ª</li>
<li>å¸¸è§„ç´¢å¼•ï¼šä¸ºäº†å¿«é€Ÿå®šä½æ•°æ®ï¼Œå¯ä»¥æœ‰å¤šä¸ª</li>
<li>å…¨æ–‡ç´¢å¼•<code>FULLTEXT</code>ï¼šæŸ¥æ‰¾æ–‡æœ¬å…³é”®å€¼ï¼Œè€Œä¸æ˜¯æ¯”è¾ƒç´¢å¼•å€¼ï¼Œå¯ä»¥æœ‰å¤šä¸ª</li>
</ol>
<p>ç´¢å¼•ç±»å‹ï¼š</p>
<ul>
<li>
<p>èšé›†ç´¢å¼•ï¼ˆClustered Indexï¼‰ï¼š</p>
<ul>
<li>è¡¨ä¸­å¿…é¡»æœ‰ï¼Œå¹¶ä¸”åªèƒ½æœ‰ä¸€ä¸ª</li>
<li>å°†æ•°æ®åº“è¡¨çš„æ•°æ®è¡ŒæŒ‰ç…§æŒ‡å®š search key çš„é¡ºåºè¿›è¡Œæ’åºå¹¶å­˜å‚¨</li>
<li>å°†æ•°æ®å­˜å‚¨å’Œç´¢å¼•æ”¾åœ¨ä¸€èµ·ï¼Œå…¶å¯¹åº”çš„æ ‘çš„ <strong>å¶å­èŠ‚ç‚¹æŒ‡å‘ç‰©ç†æ•°æ®</strong>ï¼Œéå¶å­èŠ‚ç‚¹å°±æ˜¯ç´¢å¼•</li>
<li>åŠ äº†ç´¢å¼•ä¹‹åï¼Œæ•´ä¸ªè¡¨å°±å˜æˆäº†ä¸€ç§ å¹³è¡¡æ ‘ ç»“æ„ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ•´ä¸ªè¡¨å°±å˜æˆäº†ä¸€ä¸ªç´¢å¼•ï¼Œå­˜å‚¨é¡ºåºä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œå³ã€Œèšé›†ç´¢å¼•ã€ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œå› ä¸ºåªèƒ½æœ‰ä¸€ç§ç‰©ç†å­˜å‚¨æ–¹å¼ã€‚</li>
<li>[Coding, MySQL] ä¼šè‡ªåŠ¨åˆ›å»ºèšé›†ç´¢å¼•ï¼š
<ol>
<li>primary key if exists</li>
<li>otherwise 1st unique key</li>
<li>if no unique key , use the hidden row ID (we cant see)</li>
</ol>
</li>
</ul>
</li>
<li>
<p>äºŒçº§ç´¢å¼•/éèšé›†ç´¢å¼•ï¼ˆSecondary / Non-Clustered Indexï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶ç»å¸¸æèµ·å’Œä½¿ç”¨çš„ å¸¸è§„ç´¢å¼•ã€‚</p>
<ul>
<li>å¯ä»¥æ²¡æœ‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª</li>
<li>å¶å­èŠ‚ç‚¹æŒ‡å‘çš„æ˜¯å¯¹åº”çš„ä¸»é”®å€¼</li>
</ul>
</li>
</ul>
<p>ä¸¤ç§ç´¢å¼•æ–¹å¼çš„éƒ½æ˜¯é‡‡ç”¨å¹³è¡¡æ ‘ä½œä¸ºæ•°æ®ç»“æ„ã€‚ç´¢å¼•æ ‘ç»“æ„ä¸­å„èŠ‚ç‚¹çš„å€¼æ¥è‡ªäºè¡¨ä¸­çš„ç´¢å¼•å­—æ®µã€‚<br />
å¦‚æœç»™è¡¨ä¸­å¤šä¸ªå­—æ®µåŠ ä¸Šç´¢å¼•ï¼Œ é‚£ä¹ˆå°±ä¼šå‡ºç°å¤šä¸ªç‹¬ç«‹çš„ç´¢å¼•ç»“æ„ï¼Œæ¯ä¸ªç´¢å¼•ï¼ˆéèšé›†ç´¢å¼•ï¼‰äº’ç›¸ä¹‹é—´ä¸å­˜åœ¨å…³è”ã€‚<br />
æ¯æ¬¡ç»™å­—æ®µå»ºä¸€ä¸ªæ–°ç´¢å¼•ï¼Œ å­—æ®µä¸­çš„æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½å‡ºæ¥ï¼Œ ç”¨äºç”Ÿæˆç´¢å¼•ã€‚ å› æ­¤ï¼Œ ç»™è¡¨æ·»åŠ ç´¢å¼•ï¼Œä¼šå¢åŠ è¡¨çš„ä½“ç§¯ï¼Œ å ç”¨ç£ç›˜å­˜å‚¨ç©ºé—´ã€‚</p>
<p>æŸ¥è¯¢éèšé›†ç´¢å¼•å’Œèšé›†ç´¢å¼•çš„åŒºåˆ«åœ¨äº</p>
<ul>
<li>èšé›†ç´¢å¼•ï¼šå¯ä»¥ç›´æ¥é€šè¿‡å¯¹åº”çš„å¹³è¡¡æ ‘æŸ¥åˆ°éœ€è¦æŸ¥æ‰¾çš„æ•°æ®</li>
<li>éèšé›†ç´¢å¼• - å›è¡¨æŸ¥è¯¢ï¼šé¦–å…ˆé€šè¿‡èšé›†ç´¢å¼•å¹³è¡¡æ ‘æŸ¥åˆ°è®°å½•å¯¹åº”çš„ä¸»é”®å€¼ï¼Œå†ä½¿ç”¨ä¸»é”®çš„å€¼é€šè¿‡èšé›†ç´¢å¼•å¹³è¡¡æ ‘æŸ¥æ‰¾åˆ°éœ€è¦çš„æ•°æ®</li>
</ul>
<p><img src="https://pic1.zhimg.com/v2-ef9b5d5d6407d80b937ca19d6be9dadc_b.jpg" alt="" /></p>
<p>ä¸ç®¡ä»¥ä»»ä½•æ–¹å¼æŸ¥è¯¢è¡¨ï¼Œ æœ€ç»ˆéƒ½ä¼šåˆ©ç”¨ä¸»é”®é€šè¿‡èšé›†ç´¢å¼•æ¥å®šä½åˆ°æ•°æ®ï¼Œ èšé›†ç´¢å¼•ï¼ˆä¸»é”®ï¼‰æ˜¯é€šå¾€çœŸå®æ•°æ®æ‰€åœ¨çš„å”¯ä¸€è·¯å¾„ã€‚</p>
<p>æˆ‘ä»¬åœ¨å»ºç«‹ç´¢å¼•ä¹‹åï¼Œæ¯”å¦‚å»ºç«‹äº† <code>birthday</code> çš„ç´¢å¼•ï¼Œç„¶åé€šè¿‡ <code>where birthday= ..</code> æ¥æŸ¥è¯¢æ—¶ï¼š</p>
<ol>
<li>é€šè¿‡éèšé›†ç´¢å¼•index_birthdayæŸ¥æ‰¾birthdayç­‰äº1991-11-1çš„æ‰€æœ‰è®°å½•çš„ä¸»é”®IDå€¼</li>
<li>é€šè¿‡å¾—åˆ°çš„ä¸»é”®IDå€¼æ‰§è¡Œèšé›†ç´¢å¼•æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ä¸»é”®IDå€¼å¯¹å°±çš„çœŸå®æ•°æ®ï¼ˆæ•°æ®è¡Œï¼‰å­˜å‚¨çš„ä½ç½®</li>
<li>ä»å¾—åˆ°çš„çœŸå®æ•°æ®ä¸­å–å¾— select å­—æ®µçš„å€¼è¿”å›</li>
</ol>
<p>B+Tree å¯¹åº”ä¸¤ç§æœç´¢æ–¹å¼ï¼š</p>
<ol>
<li>Equality searchï¼š<code>Where age = 25</code>ä»æ ¹èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æ‰¾ï¼Œç›´åˆ°ç›®æ ‡å¶èŠ‚ç‚¹</li>
<li>Range query
<ul>
<li>[a, b]ï¼š<code>Where 20 &lt;= age and age &lt;= 30</code>ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå‘ä¸‹æ‰¾ï¼Œå…ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å¶èŠ‚ç‚¹ï¼Œç„¶åå‘åé¡ºåºéå†ï¼Œç›´åˆ°ä¸ç¬¦åˆè¦æ±‚ã€‚</li>
<li>[-, b]ï¼š<code>Where age &lt;= 30</code>ï¼Œå…ˆæ‰¾åˆ°å·¦ä¸‹è§’å¶èŠ‚ç‚¹ï¼Œç„¶åéå†ã€‚</li>
<li>[a, -]ï¼š<code>Where 20 &lt;= age</code> å…ˆæ‰¾åˆ°å·¦è¾¹ç¬¬ä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œç„¶åéå†æ‰“æœ€å³è¾¹èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
</ol>
<h1 id="æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#æ•°æ®ç»“æ„"></a> æ•°æ®ç»“æ„</h1>
<h2 id="btree"><a class="markdownIt-Anchor" href="#btree"></a> B+Tree</h2>
<p>åŸå§‹ B+Tree çš„å¶å­èŠ‚ç‚¹ç»„æˆä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œåœ¨ MySQL ä¸­åˆä¸ºå…¶æ·»åŠ äº†ä¸€ä¸ªåå‘æŒ‡é’ˆï¼Œå¶å­èŠ‚ç‚¹æ„æˆäº†ä¸€ä¸ªåŒå‘é—­ç¯é“¾è¡¨ï¼Œæ¥å¢åŠ æ•°æ®è®¿é—®é€Ÿåº¦ã€‚<br />
å†…éƒ¨èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯ç´¢å¼•ï¼Œæ•°æ®å­˜æ”¾åœ¨å¶å­èŠ‚ç‚¹å¤„ã€‚</p>
<p>max-Degreeï¼šä¸€ä¸ªèŠ‚ç‚¹çš„æœ€å¤§å­èŠ‚ç‚¹ä¸ªæ•°ï¼Œå³æŒ‡é’ˆçš„ä¸ªæ•°ï¼Œkeyçš„æ•°é‡ä¸º æŒ‡é’ˆæ•°é‡-1 ã€‚</p>
<p>æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ç‹¬ç«‹å­˜æ”¾åœ¨å•ç‹¬çš„ é¡µ/block ä¸­ã€‚</p>
<p>ä¼˜åŠ¿ï¼š</p>
<ol>
<li>æ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹å¯¹åº”çš„ block ä¸å­˜æ”¾æ•°æ®ï¼Œè¿›è€Œå¯ä»¥å­˜æ”¾æ›´å¤šé”®å’ŒæŒ‡é’ˆï¼Œå¯ä»¥é™ä½å±‚æ•°ï¼Œæ£€ç´¢æ•ˆç‡é«˜ã€‚</li>
<li>ç›¸è¾ƒäº bæ ‘ï¼Œå¶å­èŠ‚ç‚¹å½¢æˆäº†é“¾è¡¨ï¼Œä¾¿äºèŒƒå›´æœç´ å’Œæ’åºã€‚</li>
<li>ç›¸è¾ƒäº hashï¼Œhash åªæ”¯æŒç­‰å€¼åŒ¹é…ï¼Œä¸æ”¯æŒèŒƒå›´åŒ¹é…å’Œæ’åºã€‚</li>
</ol>
<h2 id="hash-index"><a class="markdownIt-Anchor" href="#hash-index"></a> Hash Index</h2>
<p>é‡‡ç”¨ä¸€å®š hash ç®—æ³•ï¼Œå°†é”®å€¼æ¢ç®—æˆä¸ºæ–°çš„ hash å€¼ï¼Œæ˜ å°„åˆ° hash è¡¨å¯¹åº”çš„æ§½ä½ä¸Šã€‚</p>
<p>åªç”¨äºç­‰å€¼åŒ¹é…ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚å®ç°æ—¶ï¼Œæ¯”å¦‚<code>where name='lyl'</code> ï¼Œå…ˆå¾—åˆ° <code>'lyl'</code> çš„ hash å€¼ï¼Œç„¶åç›´æ¥å»hashè¡¨è¯»å–å…¶åœ°å€ï¼Œå¾—åˆ°æ•°æ®ã€‚</p>
<p>æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œåœ¨æ²¡æœ‰ hashå†²çª çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦ä¸€æ¬¡æ£€ç´¢å³å¯ï¼Œä¸€èˆ¬æ¯” B+Tree æŸ¥è¯¢è¦å¿«ã€‚</p>
<h1 id="sql-æ€§èƒ½åˆ†æ"><a class="markdownIt-Anchor" href="#sql-æ€§èƒ½åˆ†æ"></a> SQL æ€§èƒ½åˆ†æ</h1>
<ol>
<li>
<p>æŸ¥è¯¢æ‰§è¡Œé¢‘æ¬¡ï¼š<br />
<code>SHOW GLOBAL STATUS LIKE 'COM_______'</code> ï¼šæŸ¥çœ‹å½“å‰æ•°æ®åº“å¢åˆ æ”¹æŸ¥çš„è®¿é—®é¢‘æ¬¡ï¼Œå››ä¸ªå‘½ä»¤æ­£å¥½éƒ½æ˜¯å…­ä¸ªå­—æ¯ï¼Œæ‰€ä»¥æ˜¯1+6ä¸ªä¸‹åˆ’çº¿ã€‚</p>
</li>
<li>
<p>æ…¢æŸ¥è¯¢æ—¥å¿—ï¼šç”¨äºå®šä½å“ªäº› sql è¯­å¥æ—¶é—´æ¯”è¾ƒé•¿<br />
æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šå‚æ•° (long_query_timeï¼Œ å•ä½ï¼šç§’ï¼Œé»˜è®¤10ç§’) çš„æ‰€æœ‰SQLè¯­å¥çš„æ—¥å¿—ã€‚<br />
MySQLçš„æ…¢æŸ¥è¯¢æ—¥å¿—é»˜è®¤æ²¡æœ‰å¼€å¯ï¼Œéœ€è¦åœ¨MySQLçš„é…ç½®æ–‡ä»¶ <code>/etc/my.cnf</code> ä¸­é…ç½®ã€‚</p>
<ul>
<li><code>show variables  like '%slow_query_log%';</code> æŸ¥çœ‹æ˜¯å¦å¼€å¯</li>
<li><code>show variables/global like 'long_query_time%';</code> æŸ¥çœ‹é¢„è®¾æ—¶é—´ï¼Œvariablesæ˜¯å½“å‰ä¼šè¯çš„ï¼Œglobalæ˜¯å…¨å±€çš„ï¼ˆæ–‡ä»¶ä¸­çš„ï¼‰ã€‚</li>
<li><code>show variables like 'slow_query_log_file';</code> æ—¥å¿—å­˜æ”¾åœ°å€ï¼Œå¯ä»¥é€šè¿‡ <code>tail -f</code> å‘½ä»¤å®æ—¶æŸ¥çœ‹</li>
<li><code>set global slow_query_log=1;</code> å¼€å¯ï¼Œåªå¯¹å½“å‰æ•°æ®åº“ç”Ÿæ•ˆï¼Œå¦‚æœMySQLé‡å¯ååˆ™ä¼šå¤±æ•ˆã€‚</li>
<li><code>set global long_query_time=4;</code> è®¾ç½®æ—¶é—´ï¼Œéœ€è¦é‡æ–°è¿æ¥æˆ–æ–°å¼€ä¸€ä¸ªä¼šè¯æ‰èƒ½çœ‹åˆ°ä¿®æ”¹å€¼ã€‚</li>
<li><code>/etc/my.cnf</code> -&gt; <code>slow_query_log=1</code>ï¼Œ<code>long_query_time=10</code>ï¼Œ<code>slow_query_log_file=/tmp/mysql_slow.log</code> æ°¸ä¹…å¼€å¯</li>
</ul>
</li>
<li>
<p>MySQLæä¾›äº†æ—¥å¿—åˆ†æå·¥å…· <code>mysqldumpslow</code></p>
</li>
<li>
<p><code>show profile</code> å¯ä»¥å‘Šè¯‰æˆ‘ä»¬æ“ä½œè€—æ—¶</p>
<ul>
<li>é¦–å…ˆé€šè¿‡<code>SELECT @@have_profiling;</code> æŸ¥çœ‹æ˜¯å¦æ”¯æŒè¯¥åŠŸèƒ½</li>
<li>å¦‚æœå…³é—­ï¼Œåˆ™é€šè¿‡ <code>SET profiling=1;</code> è¿›è¡Œå¼€å¯</li>
<li>æŸ¥çœ‹æ¯ä¸€æ¡SOLçš„è€—æ—¶: <code>show profiles;</code></li>
<li>æŸ¥çœ‹æŒ‡å®š query_id çš„SQLè¯­å¥å„ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µ <code>show profile for query [query _id];</code></li>
<li>æŸ¥çœ‹æŒ‡å®š query_id çš„SQLè¯­å¥CPUçš„ä½¿ç”¨æƒ…å†µ: <code>show profile cpu for query [query id];</code></li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/03/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/CQL%20%E8%AF%AD%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/03/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/CQL%20%E8%AF%AD%E8%A8%80/" class="post-title-link" itemprop="url">CQL è¯­è¨€</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-03 18:41:24" itemprop="dateCreated datePublished" datetime="2021-03-03T18:41:24+08:00">2021-03-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Knowledge-Graph/" itemprop="url" rel="index"><span itemprop="name">Knowledge Graph</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>8 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://neo4j.com/docs/cypher-manual/current/clauses/">https://neo4j.com/docs/cypher-manual/current/clauses/</a></p>
<p>A Cypher query part can either read and match on the graph, or make updates on it, <strong>not both simultaneously.</strong></p>
<p>When performing <strong>Reading</strong> performance, Cypher will <strong>not match</strong> the pattern <strong>until</strong> you ask for the results.</p>
<p>In an updating query, all the <strong>reading</strong> will be <strong>firstly</strong> done totally, followed by all the <strong>writing</strong> performance.</p>
<p>These parts are separated by the statement <code>WITH</code>.<br />
<code>WITH</code> is like an event horizonâ€‰â€”â€‰itâ€™s <strong>a barrier</strong> between <strong>a plan</strong> and <strong>the finished execution</strong> of that plan.</p>
<p>Using <code>WITH</code>, you specify how you want the aggregation to happen, and that the aggregation has to be finished before Cypher can start filtering.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MATCH (n &#123;name: &#x27;John&#x27;&#125;)-[:FRIEND]-(friend)</span><br><span class="line">WITH n, count(friend) AS friendsCount</span><br><span class="line">WHERE friendsCount &gt; 3</span><br><span class="line">RETURN n, friendsCount</span><br></pre></td></tr></table></figure>
<h2 id="introduction-to-cypher"><a class="markdownIt-Anchor" href="#introduction-to-cypher"></a> Introduction to Cypher</h2>
<ul>
<li>Basic mode:  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(nodes)-[:ARE_CONNECTED_TO]-&gt;(otherNodes)</span><br></pre></td></tr></table></figure>
<ul>
<li>rounded brackets <code>(nodes)</code> to include the node</li>
<li>arrow <code>-[:ARE_CONNECTED_TO]-&gt;</code> to declare the relationship</li>
</ul>
</li>
</ul>
<h3 id="nodes"><a class="markdownIt-Anchor" href="#nodes"></a> Nodes</h3>
<ul>
<li><strong>Nodes</strong> and <strong>relationships</strong> are the simple components of the <strong>pattern</strong>, which are the most valuable and powerful piece of the property graph model.</li>
</ul>
<br>
<ul>
<li>
<p>Cypher comments: <code>//</code></p>
</li>
<li>
<p>could use the nickname for a node like <code>(p)</code> for a person</p>
</li>
<li>
<p>also could use <code>()</code> for an anonymous node. This means that you are not be able to return this node later in the query.</p>
</li>
<li>
<p>assigning a node label, e.g. Person, Technology, and Company.<br />
It is like a class, and it likes we are telling the Cypher to only check those labels for that label.<br />
This helps Cypher distinguish between entities and optimize execution for your queries. It is always better to use node labels in your queries, where possible.</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">()                  //anonymous node (no label or variable) can refer to any node in the database</span><br><span class="line">(p:Person)          //using variable p and label Person</span><br><span class="line">(:Technology)       //no variable, label Technology</span><br><span class="line">(work:Company)      //using variable work and label Company</span><br></pre></td></tr></table></figure>
<h3 id="relationships"><a class="markdownIt-Anchor" href="#relationships"></a> Relationships</h3>
<p>Directed relationships: <code>--&gt;</code>or <code>&lt;--</code> between two nodes<br />
Undirected relationships: <code>--</code> between two nodes</p>
<p>Additional information, such as <strong>relationship type</strong> and <strong>relationship properties</strong> could be added.</p>
<p>When using un-directional relationships <code>--</code> for query, Cypher would <strong>ignores any particular direction</strong> and <strong>retrieves the relationship and connected nodes</strong>, no matter what the physical direction is.<br />
In this case, user neednâ€™t know the specific relationship.</p>
<p>But when using directional relationships <code>--&gt; / &lt;--</code> for query. The wrong direction will not return any results.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//data stored with this direction</span><br><span class="line">CREATE (p:Person)-[:LIKES]-&gt;(t:Technology)</span><br><span class="line"></span><br><span class="line">//query relationship backwards will not return results</span><br><span class="line">MATCH (p:Person)&lt;-[:LIKES]-(t:Technology)</span><br><span class="line"></span><br><span class="line">//better to query with undirected relationship unless sure of direction</span><br><span class="line">MATCH (p:Person)-[:LIKES]-(t:Technology)</span><br></pre></td></tr></table></figure>
<h3 id="node-or-relationship-properties"><a class="markdownIt-Anchor" href="#node-or-relationship-properties"></a> Node or relationship properties</h3>
<p>properties are <code>name-value</code> pairs</p>
<p>Node property: <code>(p:Person &#123;name: 'Sally'&#125;)</code><br />
Relationship property: <code>-[rel:IS_FRIENDS_WITH &#123;since: 2018&#125;]-&gt;</code></p>
<h3 id="patterns-in-cypher"><a class="markdownIt-Anchor" href="#patterns-in-cypher"></a> Patterns in Cypher</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(p:Person &#123;name: &quot;Sally&quot;&#125;)-[rel:LIKES]-&gt;(g:Technology &#123;type: &quot;Graphs&quot;&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="patterns"><a class="markdownIt-Anchor" href="#patterns"></a> Patterns</h2>
<h3 id="node-syntax"><a class="markdownIt-Anchor" href="#node-syntax"></a> Node syntax</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">() // an anonymous, uncharacterized node</span><br><span class="line">(matrix) // every node with a variable</span><br><span class="line">(:Movie) // every node with a type/label</span><br><span class="line">(matrix:Movie)</span><br><span class="line">(matrix:Movie &#123;title: &#x27;The Matrix&#x27;&#125;) // every node with a property</span><br><span class="line">(matrix:Movie &#123;title: &#x27;The Matrix&#x27;, released: 1997&#125;)</span><br></pre></td></tr></table></figure>
<p>For the Type name, we are used to assign an all-upper-format; and if there is space, we use to use <code>_</code> in place of the blank.<br />
For the property value, if it is a char type, we should use quotation marks <code>' / &quot;</code> around it.</p>
<h3 id="relationship-syntax"><a class="markdownIt-Anchor" href="#relationship-syntax"></a> Relationship syntax</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--&gt;</span><br><span class="line">-[role]-&gt;  // variable</span><br><span class="line">-[:ACTED_IN]-&gt; // type/label</span><br><span class="line">-[role:ACTED_IN]-&gt;</span><br><span class="line">-[role:ACTED_IN &#123;roles: [&#x27;Neo&#x27;]&#125;]-&gt;</span><br></pre></td></tr></table></figure>
<h3 id="pattern-syntax"><a class="markdownIt-Anchor" href="#pattern-syntax"></a> Pattern syntax</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(keanu:Person:Actor &#123;name: &#x27;Keanu Reeves&#x27;&#125;)</span><br><span class="line">    -[role:ACTED_IN &#123;roles: [&#x27;Neo&#x27;]&#125;]-&gt;</span><br><span class="line">    (matrix:Movie &#123;title: &#x27;The Matrix&#x27;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="pattern-variables"><a class="markdownIt-Anchor" href="#pattern-variables"></a> Pattern variables</h3>
<p>Cypher allows patterns to be assigned to variables.<br />
This allows the matching paths to be inspected, used in other expressions.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acted_in = (:Person)-[:ACTED_IN]-&gt;(:Movie)</span><br></pre></td></tr></table></figure>
<p>Then, this variable would contain the matched paths (2 nodes and 1 relationship).<br />
Later we could use a number of functions to access details of a path, like <code>nodes(path)</code>, <code>relationships(path)</code>, and <code>length(path)</code>.</p>
<h3 id="clauses"><a class="markdownIt-Anchor" href="#clauses"></a> Clauses</h3>
<p>There are multiple clauses, each performs a specific task.<br />
like:</p>
<ul>
<li>create and match patterns in the graph</li>
<li>filter, project, sort, or paginate results</li>
<li>compose partial statements</li>
</ul>
<h2 id="patterns-in-practice"><a class="markdownIt-Anchor" href="#patterns-in-practice"></a> Patterns in practice</h2>
<h3 id="creating-and-returning-data"><a class="markdownIt-Anchor" href="#creating-and-returning-data"></a> Creating and Returning data</h3>
<h4 id="create"><a class="markdownIt-Anchor" href="#create"></a> CREATE</h4>
<p>The simplest clause is called <code>CREATE</code>. It creates the patterns (nodes and relationship) that you specify.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE (:Movie &#123;title: &#x27;The Matrix&#x27;, released: 1997&#125;)</span><br></pre></td></tr></table></figure>
<p>After running this statement, Cypher returns <strong>the number of changes</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Created Nodes: 1</span><br><span class="line">Added Labels: 1</span><br><span class="line">Set Properties: 2</span><br><span class="line">Rows: 0</span><br></pre></td></tr></table></figure>
<h3 id="return"><a class="markdownIt-Anchor" href="#return"></a> RETURN</h3>
<p>to return the created data</p>
<p>The <code>RETURN</code> clause in Cypher specifies <strong>what values or results</strong> to return from a Cypher query:</p>
<ul>
<li>node</li>
<li>relationships</li>
<li>node and relationship properties</li>
<li>patterns</li>
</ul>
<p><code>RETURN</code> is not required when doing write procedures, but <strong>is needed for reads</strong>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE (a:Person &#123;name: &#x27;Tom Hanks&#x27;, born: 1956&#125;)-[r:ACTED_IN &#123;roles: [&#x27;Forrest&#x27;]&#125;]-&gt;(m:Movie &#123;title: &#x27;Forrest Gump&#x27;, released: 1994&#125;)</span><br><span class="line">CREATE (d:Person &#123;name: &#x27;Robert Zemeckis&#x27;, born: 1951&#125;)-[:DIRECTED]-&gt;(m)</span><br><span class="line">RETURN a, d, r, m</span><br></pre></td></tr></table></figure>
<h3 id="matching-patterns"><a class="markdownIt-Anchor" href="#matching-patterns"></a> Matching patterns</h3>
<p>assign the pattern to <code>MATCH</code> to describe what you are looking for.</p>
<p>A <code>MATCH</code> statement searches for the patterns you specify and return one row per successful pattern match.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// all nodes labeled with the Movie label.</span><br><span class="line">MATCH (m:Movie)</span><br><span class="line">RETURN m</span><br><span class="line"></span><br><span class="line">// look for a specific person, like Keanu Reeves.</span><br><span class="line">MATCH (p:Person &#123;name: &#x27;Keanu Reeves&#x27;&#125;)</span><br><span class="line">RETURN p</span><br><span class="line"></span><br><span class="line">// the movies&#x27; titles that Tom Hanks acted in and roles he played.</span><br><span class="line">MATCH (p:Person &#123;name: &#x27;Tom Hanks&#x27;&#125;)-[r:ACTED_IN]-&gt;(m:Movie)</span><br><span class="line">RETURN m.title, r.roles</span><br></pre></td></tr></table></figure>
<h3 id="aliasing-return-values"><a class="markdownIt-Anchor" href="#aliasing-return-values"></a> Aliasing return values</h3>
<p>Sometimes the return name or property is complex, so we could also alias the property with a cleaner name using <code>AS</code> at the <code>RETURN</code> line.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MATCH (tom:Person &#123;name:&#x27;Tom Hanks&#x27;&#125;)-[rel:DIRECTED]-(movie:Movie)</span><br><span class="line">RETURN tom.name AS name, tom.born AS `Year Born`, movie.title AS title, movie.released AS `Year Released`</span><br></pre></td></tr></table></figure>
<p>If there is a space in the nickname, we should use the backtick character `.<br />
And if there is a space in in the Type name, or property value, we could use <code>''</code>.</p>
<h2 id="attaching-structure"><a class="markdownIt-Anchor" href="#attaching-structure"></a> Attaching structure</h2>
<p>extend the graph based on some existing nodes:</p>
<ol>
<li>first <code>MATCH</code> the existing connection points</li>
<li>attach the newly created nodes with relationships using <code>CREATE</code></li>
</ol>
<p>It is also possible to <code>CREATE</code> a node and a relationship simultaneously, but weâ€™d better <code>CREATE</code> one by one for better readability.</p>
<blockquote>
<p>If the <code>MATCH</code> command return many rows, we could move <code>CREATE</code> before the <code>MATCH</code> line, so that it neednâ€™t create new node for each line.</p>
</blockquote>
<h2 id="completing-patterns"><a class="markdownIt-Anchor" href="#completing-patterns"></a> Completing patterns</h2>
<p>Sometimes when we do <code>CREATE</code> command, we are not sure whether the node/relationship has existed.</p>
<p>In this case, we could use <code>MERGE</code> command to express a repeatable update operation.</p>
<p>It would check for the existence of the data before <code>CREATE</code>. Also we could <strong>add</strong> some properties using the <code>ON CREATE</code>.<br />
But <code>ON CREATE SET</code> <strong>could only add a property</strong>, if the property has existed, <strong>no changing</strong> would be performed.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MERGE (m:Movie &#123;title: &#x27;Cloud Atlas&#x27;&#125;)</span><br><span class="line">ON CREATE SET m.released = 2012</span><br><span class="line">RETURN m</span><br></pre></td></tr></table></figure>
<p>It comes with large cost check for existing matches first, especially on large graphs. So if we are sure to <strong>not create duplicate</strong> data use <code>CREATE</code> over <code>MERGE</code>.</p>
<p>Also, <code>MERGE</code> works for relationships:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MATCH (m:Movie &#123;title: &#x27;Cloud Atlas&#x27;&#125;)</span><br><span class="line">MATCH (p:Person &#123;name: &#x27;Tom Hanks&#x27;&#125;)</span><br><span class="line">MERGE (p)-[r:ACTED_IN]-&gt;(m)</span><br><span class="line">ON CREATE SET r.roles =[&#x27;Zachry&#x27;]</span><br><span class="line">RETURN p, r, m</span><br></pre></td></tr></table></figure>
<p>if the relationship direction is arbitrary, we could use <code>-[r:ACTED_IN]-</code>.</p>
<p>If we only pass one node for <code>MERGE</code> in a relationship, it would <code>CREATE</code> both the relationship and the other node.</p>
<h2 id="getting-the-correct-results"><a class="markdownIt-Anchor" href="#getting-the-correct-results"></a> Getting the correct results</h2>
<h3 id="filtering-results"><a class="markdownIt-Anchor" href="#filtering-results"></a> Filtering results</h3>
<p>After <code>MATCH</code>, using <code>WHERE</code> clause to use any number of boolean expressions, predicates, combined with <code>AND</code>, <code>OR</code>, <code>XOR</code> and <code>NOT</code>.</p>
<p>Actually it is equivalent to the query with the condition in the pattern.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MATCH (m:Movie)</span><br><span class="line">WHERE m.title = &#x27;The Matrix&#x27;</span><br><span class="line">RETURN m</span><br><span class="line"></span><br><span class="line">==</span><br><span class="line">MATCH (m:Movie &#123;title: &#x27;The Matrix&#x27;&#125;)</span><br><span class="line">RETURN m</span><br></pre></td></tr></table></figure>
<p>There are optional conditions:</p>
<ol>
<li>property matching: <code>node.property_key = &quot;value&quot;</code></li>
<li>numeric comparisons: <code>node.property_key &gt;&lt;= int</code></li>
<li>matching regular expressions: <code>p.name =~ 'K.+'</code></li>
<li>the existence of values within a list: <code>&quot;target_str&quot; IN node.property_key</code></li>
<li>a pattern predicate restricts:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MATCH (p:Person)-[:ACTED_IN]-&gt;(m)</span><br><span class="line">WHERE NOT (p)-[:DIRECTED]-&gt;()  // has never directed any movies</span><br><span class="line">RETURN p, m</span><br></pre></td></tr></table></figure>
<h4 id="querying-ranges-of-values"><a class="markdownIt-Anchor" href="#querying-ranges-of-values"></a> Querying ranges of values</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MATCH (p:Person)</span><br><span class="line">WHERE 3 &lt;= p.yearsExp &lt;= 7</span><br><span class="line">RETURN p</span><br></pre></td></tr></table></figure>
<h4 id="testing-if-a-property-exists"><a class="markdownIt-Anchor" href="#testing-if-a-property-exists"></a> Testing if a property exists</h4>
<p>In Neo4j, a property <strong>only exists (is stored) if it has a value</strong>. A null property is not stored.<br />
we could use <code>IS NOT NULL</code> for these nodes with the property.</p>
<h4 id="checking-strings-partial-values-fuzzy-searches"><a class="markdownIt-Anchor" href="#checking-strings-partial-values-fuzzy-searches"></a> Checking stringsâ€‰â€”â€‰partial values, fuzzy searches</h4>
<p><code>p.name STARTS WITH 'M'</code><br />
<code>p.name CONTAINS 'a'</code><br />
<code>p.name ENDS WITH 'n'</code></p>
<p>use regular expressions: <code>WHERE p.name =~ 'Jo.*'</code></p>
<h4 id="in-a-list"><a class="markdownIt-Anchor" href="#in-a-list"></a> in a list</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WHERE p.yearsExp IN [1, 5, 6]</span><br></pre></td></tr></table></figure>
<h4 id="filtering-on-patterns-inner-join"><a class="markdownIt-Anchor" href="#filtering-on-patterns-inner-join"></a> Filtering on patterns ( Inner join )</h4>
<p>can also filter results based on relationships or patterns</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//Query1: find which people are friends of someone who works for Neo4j</span><br><span class="line">MATCH (p:Person)-[r:IS_FRIENDS_WITH]-&gt;(friend:Person)</span><br><span class="line">WHERE exists((p)-[:WORKS_FOR]-&gt;(:Company &#123;name: &#x27;Neo4j&#x27;&#125;))</span><br><span class="line">RETURN p, r, friend;</span><br><span class="line"></span><br><span class="line">//Query2: find Jennifer&#x27;s friends who do not work for a company</span><br><span class="line">MATCH (p:Person)-[r:IS_FRIENDS_WITH]-&gt;(friend:Person)</span><br><span class="line">WHERE p.name = &#x27;Jennifer&#x27;</span><br><span class="line">AND NOT exists((friend)-[:WORKS_FOR]-&gt;(:Company))</span><br><span class="line">RETURN friend.name;</span><br></pre></td></tr></table></figure>
<h4 id="optional-patterns-outre-join"><a class="markdownIt-Anchor" href="#optional-patterns-outre-join"></a> Optional patterns( Outre join )</h4>
<p>In Cypher, you can use an <code>OPTIONAL MATCH</code> pattern to try to match it, but if it doesnâ€™t find results, those rows will return null for those values.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//Find all people whose name starts with J and who may work for a company.</span><br><span class="line">MATCH (p:Person)</span><br><span class="line">WHERE p.name STARTS WITH &#x27;J&#x27;</span><br><span class="line">OPTIONAL MATCH (p)-[:WORKS_FOR]-(other:Company)</span><br><span class="line">RETURN p.name, other.name;</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">+--------------------------------+</span><br><span class="line">| p.name      | other.name       |</span><br><span class="line">+--------------------------------+</span><br><span class="line">| &#x27;Jennifer&#x27;  | &#x27;Neo4j&#x27;          |</span><br><span class="line">| &#x27;John&#x27;      | &#x27;XYZ&#x27;            |</span><br><span class="line">| &#x27;Joe&#x27;       | null             |</span><br><span class="line">+--------------------------------+</span><br></pre></td></tr></table></figure>
<h4 id="more-complex-patterns"><a class="markdownIt-Anchor" href="#more-complex-patterns"></a> More complex patterns</h4>
<p>we could expand our pattern to perform more complex relationships:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//Query2: find who likes graphs besides Jennifer that she is also friends with</span><br><span class="line">MATCH (j:Person &#123;name: &#x27;Jennifer&#x27;&#125;)-[:LIKES]-&gt;(:Technology &#123;type: &#x27;Graphs&#x27;&#125;)&lt;-[:LIKES]-(p:Person),</span><br><span class="line">      (j)-[:IS_FRIENDS_WITH]-(p)</span><br><span class="line">RETURN p.name;</span><br></pre></td></tr></table></figure>
<p>Also, we could use <code>,</code> to use multiple conditional patterns. It is also a good way to replace <code>WHERE exists(&lt;pattern&gt;)</code>.</p>
<h3 id="returning-results"><a class="markdownIt-Anchor" href="#returning-results"></a> Returning results</h3>
<p>after <code>RETURN</code>,  we could add some simple expressions to operate the returned value:</p>
<ol>
<li>index: <code>names[0]</code>, <code>movies[1..-1]</code>, <code>substring('2014-07-01', 0, 4)</code></li>
<li>length(array)</li>
<li>toInteger(â€˜12â€™)</li>
<li>coalesce(p.nickname, â€˜n/aâ€™)</li>
</ol>
<p><code>UNIQUE</code> could trim out duplicate entities.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//Query: find people who have a twitter or like graphs or query languages</span><br><span class="line">MATCH (user:Person)</span><br><span class="line">WHERE user.twitter IS NOT null</span><br><span class="line">WITH user</span><br><span class="line">MATCH (user)-[:LIKES]-(t:Technology)</span><br><span class="line">WHERE t.type IN [&#x27;Graphs&#x27;,&#x27;Query Languages&#x27;]</span><br><span class="line">RETURN DISTINCT user.name</span><br></pre></td></tr></table></figure>
<h4 id="limiting-number-of-results"><a class="markdownIt-Anchor" href="#limiting-number-of-results"></a> Limiting number of results</h4>
<p><code>LIMIT</code> keyword takes the output of the query and limits the volume returned based on the number you specify.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//Query: find the top 3 people who have the most friends</span><br><span class="line">MATCH (p:Person)-[r:IS_FRIENDS_WITH]-(other:Person)</span><br><span class="line">RETURN p.name, count(other.name) AS numberOfFriends</span><br><span class="line">ORDER BY numberOfFriends DESC</span><br><span class="line">LIMIT 3</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://neo4j.com/docs/getting-started/current/cypher-intro/results/#cypher-intro-results-aggregating">https://neo4j.com/docs/getting-started/current/cypher-intro/results/#cypher-intro-results-aggregating</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/02/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/py2neo%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/02/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/py2neo%E4%BB%8B%E7%BB%8D/" class="post-title-link" itemprop="url">py2neoä»‹ç»</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-02 18:41:24" itemprop="dateCreated datePublished" datetime="2021-03-02T18:41:24+08:00">2021-03-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Knowledge-Graph/" itemprop="url" rel="index"><span itemprop="name">Knowledge Graph</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>1.4k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>7 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="http://codewithzhangyi.com/2019/04/23/knowledge-graph-intro/">http://codewithzhangyi.com/2019/04/23/knowledge-graph-intro/</a></p>
<p>çº¢æ¥¼æ¢¦é—®ç­”ï¼š <a target="_blank" rel="noopener" href="https://piqiandong.blog.csdn.net/article/details/125697786">https://piqiandong.blog.csdn.net/article/details/125697786</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/meiqi0538/category_11901623.html?spm=1001.2014.3001.5482">https://blog.csdn.net/meiqi0538/category_11901623.html?spm=1001.2014.3001.5482</a></p>
<h2 id="neo4j-é…ç½®"><a class="markdownIt-Anchor" href="#neo4j-é…ç½®"></a> neo4j é…ç½®</h2>
<p>mac é…ç½®neo4jç¤¾åŒºç‰ˆï¼š<a target="_blank" rel="noopener" href="https://www.jiyik.com/w/neo4j/neo4j-install">Neo4j Mac ç³»ç»Ÿä¸­å®‰è£…</a></p>
<p>è§£å‹çš„æ–‡ä»¶å¤¹çš„binç›®å½•ä¸‹ï¼Œæœ‰ä¸ª<code>neo4j</code>ï¼Œå°±æ˜¯å¯åŠ¨æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥åœ¨<code>~/.bashrc</code>ä¸­ä¿®æ”¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export NEO4J_HOME=/Users/liuyilin/Downloads/NLP_project/neo4j-community-4.4.16 # ä¸‹è½½çš„è§£å‹æ–‡ä»¶</span><br><span class="line">export PATH=$PATH:$NEO4J_HOME/bin</span><br></pre></td></tr></table></figure>
<p>ç”¨æˆ·å <code>neo4j</code>ï¼Œæ–°å¯†ç ä¸º  <code>neo4j123</code>ã€‚<br />
ç„¶åä»¥åç›´æ¥åœ¨åå°è¿›ç¨‹ä¸­ä½¿ç”¨<code>neo4j</code>å³å¯ï¼š<code>neo4j start</code><br />
å¯åŠ¨åå¯ä»¥åœ¨å‘½ä»¤è¡ŒæŸ¥çœ‹åˆ°åœ°å€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Started neo4j (pid:34617). It is available at http://localhost:7474</span><br></pre></td></tr></table></figure>
<h2 id="py2neo-ç‰ˆæœ¬"><a class="markdownIt-Anchor" href="#py2neo-ç‰ˆæœ¬"></a> py2neo ç‰ˆæœ¬</h2>
<p>v4 ç‰ˆæœ¬ï¼š <a target="_blank" rel="noopener" href="https://py2neo.org/v4/#library-reference">https://py2neo.org/v4/#library-reference</a> ï¼Œä¸å…¼å®¹</p>
<p>2021.1 ç‰ˆæœ¬ï¼š<a target="_blank" rel="noopener" href="https://py2neo.org/2021.1/">https://py2neo.org/2021.1/</a></p>
<br>
<p>å¯¼å…¥ py2neo åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --user  -i https://pypi.tuna.tsinghua.edu.cn/simple py2neo==2021.1</span><br></pre></td></tr></table></figure>
<h2 id="å»ºç«‹è¿æ¥"><a class="markdownIt-Anchor" href="#å»ºç«‹è¿æ¥"></a> å»ºç«‹è¿æ¥</h2>
<ul>
<li>
<p><strong>é¦–å…ˆéœ€è¦æ‰“å¼€ neoo4j</strong></p>
</li>
<li>
<p>ä¸ç½‘ç«™å»ºç«‹è¿æ¥ï¼špy2neo.graph å‡½æ•°ï¼Œå‚æ•°ä¸ºç”¨æˆ·åä»¥åŠå¯†ç ï¼Œä¼šè¿”å›ä¸€ä¸ª<code>py2neo.Graph</code>é“¾æ¥å¯¹è±¡</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graph = Graph(&quot;http://localhost:7474&quot;, auth=(&quot;neo4j&quot;,&quot;neo4j123&quot;))</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¸…ç©ºåŸæ•°æ®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graph.delete_all()</span><br></pre></td></tr></table></figure>
<ul>
<li>CQL è¯­è¨€æŸ¥è¯¢<br />
<code>graph.run()</code> é‡Œé¢æ”¾å‘½ä»¤å­—ç¬¦ä¸²</li>
</ul>
<h2 id="graph-å¯¹è±¡æ–¹æ³•"><a class="markdownIt-Anchor" href="#graph-å¯¹è±¡æ–¹æ³•"></a> Graph å¯¹è±¡æ–¹æ³•</h2>
<p>Graph objectsï¼š<a target="_blank" rel="noopener" href="https://py2neo.org/2021.1/workflow.html#graph-objects">https://py2neo.org/2021.1/workflow.html#graph-objects</a></p>
<ul>
<li>
<p><code>match(nodes=None, r_type=None, limit=None)[source]</code><br />
è¿”å›æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„ <code>py2neo.matching.RelationshipMatch</code> å¯¹è±¡</p>
<ul>
<li>nodesï¼šSequence or Set of start and end nodes (None means any node);</li>
<li>r_typeï¼štype of relationships to match (None means any type)</li>
<li>limitï¼šmaximum number of relationships to match (None means unlimited)</li>
</ul>
</li>
<li>
<p><code>match_one(nodes=None, r_type=None)</code><br />
åªè¿”å›ä¸€ä¸ªå…³ç³»</p>
</li>
<li>
<p><code>merge(subgraph, label=None, *property_keys)[source]</code>ï¼š<br />
å½“<code>merge</code>è°ƒç”¨æ—¶ï¼Œæ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„ä¸€ä¸ªè§†å›¾ï¼Œç”¨äºæ–°å»ºæˆ–è€…æ›´æ–° subgraph ä¸­çš„èŠ‚ç‚¹å’Œå…³ç³»ï¼Œæ³¨æ„<strong>åªèƒ½å¢ä¸èƒ½åˆ ã€‚</strong><br />
subgraph ä¸­çš„èŠ‚ç‚¹å’Œå…³ç³»æ˜¯ç‹¬ç«‹æ›´æ–°çš„ï¼ŒèŠ‚ç‚¹å…ˆæ›´æ–°ï¼Œå…³ç³»å†æ›´æ–°ã€‚<br />
å¯¹äºsubgraphä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œé¦–å…ˆæ¯”è¾ƒ label å’Œ propertyï¼ˆè¾“å…¥å‚æ•°æŒ‡å®šï¼‰ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…é€‰é¡¹ï¼Œåˆ™åˆ›å»ºï¼Œå¦‚æœæœ‰åŒ¹é…é€‰é¡¹ï¼Œåˆ™æ›´æ–°ã€‚<br />
å¯¹äºsubgraphä¸­çš„æ¯ä¸ªå…³ç³»ï¼Œæ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹å’Œå…³ç³»type/ç±»å‹ï¼Œæ²¡æœ‰åˆ™æ–°å»ºï¼Œæœ‰åˆ™æ›´æ–°ã€‚</p>
<ul>
<li>subgraphï¼šä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…³ç³»ï¼Œæˆ–è€…å­å›¾</li>
<li>labelï¼šç”¨äºåŒ¹é…èŠ‚ç‚¹çš„type/labelã€‚ä»…ç”¨äºåŒ¹é…èŠ‚ç‚¹ï¼ŒåŒ¹é…æˆåŠŸåå¯èƒ½ä¼šè¢«é‡å†™ã€‚</li>
<li>property_keysï¼šç”¨äºåŒ¹é…èŠ‚ç‚¹çš„å±æ€§å€¼ã€‚ä»…ç”¨äºåŒ¹é…èŠ‚ç‚¹ï¼ŒåŒ¹é…æˆåŠŸåå¯èƒ½ä¼šè¢«é‡å†™ã€‚</li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from py2neo import Graph, Node, Relationship</span><br><span class="line">&gt;&gt;&gt; g = Graph()</span><br><span class="line">&gt;&gt;&gt; a = Node(&quot;Person&quot;, name=&quot;Alice&quot;, age=33)</span><br><span class="line">&gt;&gt;&gt; b = Node(&quot;Person&quot;, name=&quot;Bob&quot;, age=44)</span><br><span class="line">&gt;&gt;&gt; KNOWS = Relationship.type(&quot;KNOWS&quot;)</span><br><span class="line">&gt;&gt;&gt; g.merge(KNOWS(a, b), &quot;Person&quot;, &quot;name&quot;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>delete(subgraph)</code>ï¼šåˆ é™¤ä¸€ä¸ªå­å›¾ï¼Œæ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è§†å›¾ã€‚</p>
</li>
<li>
<p>property <code>nodes</code><br />
è¿”å›ä¸€ä¸ª <code>NodeMatcher</code> å¯¹è±¡</p>
</li>
</ul>
<h2 id="èŠ‚ç‚¹æ“ä½œ"><a class="markdownIt-Anchor" href="#èŠ‚ç‚¹æ“ä½œ"></a> èŠ‚ç‚¹æ“ä½œ</h2>
<p><strong>Nodeå’ŒRelationshipåœ¨è¿™ä¸ªé©±åŠ¨ä¸­éƒ½ç»§æ‰¿äº†PropertyDictè¿™ä¸ªç±»ï¼Œè€Œè¿™ä¸ªç±»ç»§æ‰¿ç±»pythoné‡Œé¢çš„dictï¼Œæ‰€ä»¥æ“ä½œå’Œpythonæœ¬èº«çš„dictä¸€æ¨¡ä¸€æ ·</strong></p>
<p>èŠ‚ç‚¹çš„ <code>(:value)</code> æ˜¯å‚æ•° labelï¼Œè€Œå…³ç³»çš„  <code>(:value)</code> æ˜¯å‚æ•° <code>type</code>ã€‚</p>
<h3 id="å¢åˆ æ”¹"><a class="markdownIt-Anchor" href="#å¢åˆ æ”¹"></a> å¢åˆ æ”¹</h3>
<ul>
<li>
<p>æ–°å»ºèŠ‚ç‚¹ï¼š<code>py2neo.Node</code> ç±»ï¼Œ<br />
å‚æ•°ä¸ºæ ‡ç­¾ label å’Œå±æ€§ propertyï¼Œè¿”å›ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = Node(&quot;yili&quot;, gender=&quot;male&quot;)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°èŠ‚ç‚¹ä¸º <code>(:yili &#123;gender: 'male'&#125;)</code>ï¼Œè¿™é‡Œçš„ label å°±æ˜¯ <code>yili</code></p>
</li>
<li>
<p>æ”¾ç½®èŠ‚ç‚¹ï¼š<code>graph.create</code> å‡½æ•°</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graph.create(a)</span><br></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•ä¸ä¼šè‡ªå·±æ£€æŸ¥è¯¥èŠ‚ç‚¹æ˜¯å¦å·²ç»åˆ›å»ºï¼Œæ‰€ä»¥åœ¨å®é™…ä½¿ç”¨ï¼Œåº”å…ˆæ£€æŸ¥è¦åˆ›å»ºçš„èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ã€‚æˆ–è€…ä½¿ç”¨ <code>Merge</code> æ–¹æ³•ã€‚</p>
</li>
<li>
<p>åˆ é™¤èŠ‚ç‚¹ï¼š<code>graph.delete</code> å‡½æ•°</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graph.delete(node_a)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>è·å–nodeçš„å±æ€§ï¼š<code>x=test_node_2[key]</code></p>
</li>
<li>
<p>è®¾ç½®nodeçš„å±æ€§ï¼š<code>test_node_2[key] = value</code> + <code>graph.push(test_node_2)</code></p>
</li>
<li>
<p>åˆ é™¤nodeçš„å±æ€§ï¼š<code>del node[key]</code></p>
</li>
<li>
<p>è¿”å›nodeé‡Œé¢propertyçš„ä¸ªæ•°ï¼š<code>len(node)</code></p>
</li>
<li>
<p>è¿”å›æ‰€æœ‰å’Œè¿™ä¸ªèŠ‚ç‚¹æœ‰å…³çš„labelï¼š<code>node.labels</code></p>
</li>
<li>
<p>å°†nodeçš„æ‰€æœ‰propertyä»¥dictionaryçš„å½¢å¼è¿”å›ï¼š<code>dic(node)</code></p>
</li>
</ul>
<p>ä½¿ç”¨ <code>py2neo</code> ä¿®æ”¹ Node æˆ–è€… Relation æ—¶ï¼Œå½“æˆ‘ä»¬ç›´æ¥ç”¨è¯­æ³•ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œç»‘å®šï¼Œå°±ä¼šä»…ä»…æ˜¯å¯¹æœ¬åœ°ç«¯çš„æ•°æ®è¿›è¡Œäº†å¤„ç†ï¼Œè€Œæ²¡æœ‰ä½œç”¨åˆ°æ•°æ®åº“ä¸Šå»ã€‚</p>
<p><strong>ä¿®æ”¹èŠ‚ç‚¹æ—¶æœ‰ä¸¤ä¸ªå¿…è¦æ¡ä»¶ï¼š</strong></p>
<ol>
<li>èŠ‚ç‚¹å·²ç»å’Œ <code>Graph</code>ç±»æ³¨å†Œï¼Œé€šå¸¸æ˜¯<code>create()</code>æ–¹æ³•æˆ–è€…<code>match()</code>æ–¹æ³•å¾—åˆ°çš„ï¼Œå³ã€Œè‡ªå·±æ¨ä¸Šå»ã€çš„å’Œã€Œè‡ªå·±æŸ¥è¯¢åˆ°çš„ã€ã€‚</li>
<li>ä¿®æ”¹èŠ‚ç‚¹åéœ€è¦è°ƒç”¨æ–¹æ³• <code>graph.push(node_object)</code> æŠŠå®ƒæäº¤ä¸Šå»ã€‚</li>
</ol>
<h3 id="æŸ¥è¯¢èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢èŠ‚ç‚¹"></a> æŸ¥è¯¢èŠ‚ç‚¹</h3>
<h4 id="æ ¹æ®å±æ€§æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#æ ¹æ®å±æ€§æŸ¥è¯¢"></a> æ ¹æ®å±æ€§æŸ¥è¯¢</h4>
<ul>
<li>
<p>åŒ¹é…/é“¾æ¥ èŠ‚ç‚¹ï¼Œä½¿ç”¨åˆ°èŠ‚ç‚¹åŒ¹é…å™¨ <code>py2neo.matching.NodeMatcher</code> ç±»</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from py2neo.matching import *</span><br><span class="line">matcher = NodeMatcher(graph)  # åˆ›å»ºèŠ‚ç‚¹åŒ¹é…å™¨</span><br><span class="line"></span><br><span class="line">result = matcher.match(&#x27;åˆ¤å†³æ–‡ä¹¦&#x27;, name = &#x27;XXXåˆ‘äº‹åˆ¤å†³ä¹¦&#x27;).exists()  # ç¬¦åˆæ¡ä»¶çš„æ˜¯å¦å­˜åœ¨</span><br><span class="line"></span><br><span class="line">node = matcher.match(&#x27;åˆ¤å†³æ–‡ä¹¦&#x27;).where(name = &#x27;XXXåˆ‘äº‹åˆ¤å†³ä¹¦&#x27;).first()ã€€# è¯„ä¼°åŒ¹é…å¹¶è¿”å›åŒ¹é…çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span><br></pre></td></tr></table></figure>
<p><code>matcher.match('åˆ¤å†³æ–‡ä¹¦', name = 'XXXåˆ‘äº‹åˆ¤å†³ä¹¦')</code> å’Œ <code>matcher.match('åˆ¤å†³æ–‡ä¹¦').where(name = 'XXXåˆ‘äº‹åˆ¤å†³ä¹¦')</code> æ˜¯ä¸¤ç§åŒ¹é…æ–¹å¼ã€‚<br />
whereå¯ä»¥è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œå¯ä»¥ç”¨è¡¨è¾¾å¼è¿›è¡Œè¾ƒå¤æ‚çš„åŒ¹é…ï¼Œæ¯”å¦‚ <code>where(&quot;_.name=&quot; + &quot;'&quot; + *åç§° + &quot;'&quot;)</code>ï¼Œé»˜è®¤ç”¨<code>_</code>è¡¨ç¤ºèŠ‚ç‚¹ã€‚</p>
</li>
<li>
<p>æŸ¥è¯¢èŠ‚ç‚¹ï¼š</p>
<ul>
<li>å‘½ä»¤ç›´æ¥æŸ¥è¯¢ï¼š<code>graph.run('MATCH (a:äºº) RETURN a')</code>ï¼Œè¿”å›ä¸€ä¸ª <code>Node list</code></li>
<li><code>graph.nodes.match('äºº')</code>ï¼Œæ ¹æ®typeæŸ¥è¯¢èŠ‚ç‚¹ï¼Œè¿”å›ä¸€ä¸ª <code>py2neo.matching.NodeMatch</code> ç±»å‹æ•°æ®ã€‚<br />
å‚æ•°ä¸º<code>*labels, **properties</code>ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æŒ‡å®šå±æ€§ï¼š<code>graph.nodes.match('äºº', name='å°çº¢')</code><br />
<code>type(graph.nodes)=py2neo.matching.NodeMatcher object</code>ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª <code>matcher</code>å¯¹è±¡ï¼Œæ‰€ä»¥åç»­ä¹Ÿæ˜¯ä½¿ç”¨ <code>match()</code> æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
<p><code>NodemMatcher.match()</code> å‡½æ•°è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ª <code>NodeMatch</code> ç±»å‹æ•°æ®ï¼Œå¯ä»¥ç”¨<code>list()</code>è¿›è¡Œå¼ºåˆ¶è½¬æ¢ã€‚<br />
åŒæ—¶ï¼Œè¿™ä¸ª<code>NodeMatch</code>å¯¹è±¡åå¯ä»¥æ¥ä¸Šä¸€äº›æ–¹æ³•ï¼š</p>
<ul>
<li><code>where()</code>ï¼šè¿›è¡ŒäºŒæ¬¡ç­›é€‰</li>
<li><code>first()</code>ï¼šè¾“å‡ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹</li>
<li><code>exists()</code>ï¼šæ˜¯å¦å­˜åœ¨</li>
<li><code>limit()</code>ï¼šé™åˆ¶æ•°é‡</li>
</ul>
<h4 id="æ ¹æ®-id-æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#æ ¹æ®-id-æŸ¥è¯¢"></a> æ ¹æ® id æŸ¥è¯¢</h4>
<p>è·å–èŠ‚ç‚¹çš„ id ï¼šè°ƒç”¨èŠ‚ç‚¹çš„<code>identity</code>å±æ€§ï¼š<code>node.identity</code></p>
<p>é€šè¿‡ id å¾—åˆ°èŠ‚ç‚¹ ï¼š<code>created_node = matcher[node_id]</code></p>
<h2 id="å…³ç³»æ“ä½œ"><a class="markdownIt-Anchor" href="#å…³ç³»æ“ä½œ"></a> å…³ç³»æ“ä½œ</h2>
<p><a target="_blank" rel="noopener" href="https://py2neo.org/2021.1/data/index.html#py2neo.data.Relationship">py2neo.data.Relationship</a></p>
<h3 id="å¢åˆ æ”¹-2"><a class="markdownIt-Anchor" href="#å¢åˆ æ”¹-2"></a> å¢åˆ æ”¹</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ab = Relationship(a, &quot;KNOWS&quot;, b)</span><br><span class="line">graph.create(ab)</span><br></pre></td></tr></table></figure>
<p>å…³ç³»åŒæ ·ä¹Ÿæœ‰ç±»ä¼¼çš„æ“ä½œï¼š</p>
<ul>
<li>åˆ›å»ºrelationshipï¼š<code>Relationship(start_node, type, end_node, properties)</code></li>
<li>è¿”å›Relationshipçš„propertyï¼š<code>Relationship[key]</code></li>
<li>åˆ é™¤æŸä¸ªpropertyï¼š<code>del Relationship[key]</code></li>
<li>å°†propertyä»¥å­—å…¸å½¢å¼è¿”å›ï¼š<code>dict(relationship)</code></li>
</ul>
<h3 id="æŸ¥è¯¢å…³ç³»"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢å…³ç³»"></a> æŸ¥è¯¢å…³ç³»</h3>
<ul>
<li>ä½¿ç”¨å…³ç³»æŸ¥è¯¢å™¨ï¼Œ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">relation_matcher = RelationshipMatcher(graph)</span><br><span class="line">result = relation_matcher.match(&#123;first_node, second_node&#125;, r_type = None, key = value).first()</span><br></pre></td></tr></table></figure>
<p>å‚æ•°ä¸ºï¼š<code>nodes=None, r_type=None, **properties</code><br />
- nodes ï¼šä¸€èˆ¬ä¸º <code>&#123;start-node, end-node&#125;</code> æ ¼å¼<br />
- r_typeï¼šå…³ç³»type<br />
- propertiesï¼šå…³ç³»å±æ€§ï¼Œ<code>key = value</code>æ ¼å¼</p>
<ul>
<li>å›¾è‡ªå¸¦æŸ¥è¯¢ï¼š<code>graph.match(r_type=&quot;å–œæ¬¢&quot;)</code></li>
</ul>
<h2 id="node-and-relationship-matching"><a class="markdownIt-Anchor" href="#node-and-relationship-matching"></a> Node and relationship matching</h2>
<p><a target="_blank" rel="noopener" href="https://py2neo.org/2021.1/matching.html?highlight=relationshipmatcher">API for Node and relationship matching</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/14/Coding/Python/python%20%E5%A4%9A%E8%BF%9B%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/14/Coding/Python/python%20%E5%A4%9A%E8%BF%9B%E7%A8%8B/" class="post-title-link" itemprop="url">python å¤šè¿›ç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-14 10:57:32" itemprop="dateCreated datePublished" datetime="2021-02-14T10:57:32+08:00">2021-02-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>2.8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>14 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/111430051">34ã€pythonå¹¶å‘ç¼–ç¨‹ä¹‹å¤šè¿›ç¨‹ï¼ˆæ“ä½œç¯‡ï¼‰</a><br />
<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/493699150">ã€Pythonã€‘Pythonå¤šè¿›ç¨‹è¯¦è§£</a><br />
<a target="_blank" rel="noopener" href="http://www.cnblogs.com/Anker/p/3271773.html">åƒµå°¸è¿›ç¨‹ä¸å­¤å„¿è¿›ç¨‹ï¼ˆäº†è§£ï¼‰</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/fengf233/p/11506337.html">pythonå¤šè¿›ç¨‹æ€»ç»“</a></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/02/14/Coding/Python/python%20%E5%A4%9A%E8%BF%9B%E7%A8%8B/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/33/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><span class="page-number current">34</span><a class="page-number" href="/page/35/">35</a><a class="page-number" href="/page/36/">36</a><a class="extend next" rel="next" href="/page/35/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">A foolish, slow learner.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">354</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/YiandLi" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;YiandLi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/yiliiiii" title="Zhihu â†’ https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yiliiiii" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">604k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">50:20</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
