<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":20,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="LLAVA https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2304.08485.pdf https:&#x2F;&#x2F;github.com&#x2F;haotian-liu&#x2F;LLaVA https:&#x2F;&#x2F;llava-vl.github.io&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="LLAVA">
<meta property="og:url" content="http://example.com/2023/10/26/%E5%A4%9A%E6%A8%A1%E6%80%81/multi-moddal%20backbones/LLAVA/index.html">
<meta property="og:site_name" content="Yili">
<meta property="og:description" content="LLAVA https:&#x2F;&#x2F;arxiv.org&#x2F;pdf&#x2F;2304.08485.pdf https:&#x2F;&#x2F;github.com&#x2F;haotian-liu&#x2F;LLaVA https:&#x2F;&#x2F;llava-vl.github.io&#x2F;">
<meta property="og:locale">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-f569f515e6ef896c4f0480cc89ea7a36_1440w.webp">
<meta property="og:image" content="https://cdn.mathpix.com/snip/images/v4pJGzlz_FGuD_EUeFPX4JDB8yoNay7dtghvhT5PVBs.original.fullsize.png">
<meta property="og:image" content="https://cdn.mathpix.com/snip/images/7G-5ioPnJEB8dyjNmc1c_wsvobtfXGVA0b50q2M3XPw.original.fullsize.png">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-7ca0607f507149faf423309f18a97a5a_1440w.webp">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-e0fc3040e881b78cd3ad82dff6ab8fb0_1440w.webp">
<meta property="article:published_time" content="2023-10-27T03:04:32.000Z">
<meta property="article:modified_time" content="2024-03-23T04:37:39.069Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic3.zhimg.com/80/v2-f569f515e6ef896c4f0480cc89ea7a36_1440w.webp">

<link rel="canonical" href="http://example.com/2023/10/26/%E5%A4%9A%E6%A8%A1%E6%80%81/multi-moddal%20backbones/LLAVA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>LLAVA | Yili</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Yili</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Suggest Google Chrome for better math Reading.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/10/26/%E5%A4%9A%E6%A8%A1%E6%80%81/multi-moddal%20backbones/LLAVA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="A foolish, slow learner.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yili">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LLAVA
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-10-26 20:04:32" itemprop="dateCreated datePublished" datetime="2023-10-26T20:04:32-07:00">2023-10-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MultiModal/" itemprop="url" rel="index"><span itemprop="name">MultiModal</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>10 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="llava"><a class="markdownIt-Anchor" href="#llava"></a> LLAVA</h1>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2304.08485.pdf">https://arxiv.org/pdf/2304.08485.pdf</a><br />
<a target="_blank" rel="noopener" href="https://github.com/haotian-liu/LLaVA">https://github.com/haotian-liu/LLaVA</a><br />
<a target="_blank" rel="noopener" href="https://llava-vl.github.io/">https://llava-vl.github.io/</a></p>
<span id="more"></span>
<p>有效利用预训练的 LLM 和 Vision model，架构为<br />
<img src="https://pic3.zhimg.com/80/v2-f569f515e6ef896c4f0480cc89ea7a36_1440w.webp" alt="" /></p>
<p>LLM：LLaMA（vicuna）<br />
Vision Model：CLIP - ViT-L/14 ，实验中使用的是最后一个 Transformer 层之前和之后的网格特征。</p>
<p>使用一个简单的线性层来将图像特征 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(X_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 转换到单词嵌入空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">H_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>H</mi><mi>v</mi></msub><mo>=</mo><mi>W</mi><mo>⋅</mo><msub><mi>Z</mi><mi>v</mi></msub><mtext> </mtext><mo separator="true">,</mo><mtext> with  </mtext><msub><mi>Z</mi><mi>v</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>v</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H_v = W\cdot Z_v\ , \ \text{with }\ Z_v = g(X_v)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">with </span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>这种简单投影方案具有轻量级、成本低等特点。<br />
也可以考虑连接图像和语言特征的更复杂的方案，例如 Flamingo 中的门控交叉注意力机制和 BLIP-2 中的 Q-former。</p>
<h2 id="data"><a class="markdownIt-Anchor" href="#data"></a> Data</h2>
<blockquote>
<p><strong>Multi-modal Instruction-Following Data:</strong><br />
we propose to leverage ChatGPT/GPT-4 for multi-modal instruction-following data collection, based on the widely existing image-pair data.</p>
</blockquote>
<p>基于 CoCo 数据集，使用 language-only GPT-4 构造了 158K 的 language-image instruction-following samples ，其中占比为：</p>
<ul>
<li>58K in conversations</li>
<li>23K in detailed description</li>
<li>77k in complex reasoning</li>
</ul>
<p>数据集位于 <a target="_blank" rel="noopener" href="https://huggingface.co/datasets/liuhaotian/LLaVA-Instruct-150K">HuggingFace Dataset</a></p>
<br>
<h3 id="构造方法"><a class="markdownIt-Anchor" href="#构造方法"></a> 构造方法</h3>
<p><u><b> Method 1 </u></b></p>
<p>对于一个 image-caption pair <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi mathvariant="bold">X</mi><mi>v</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mi>c</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\mathbf X_v, \mathbf X_c\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> ，<br />
可以构造一些 instruction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">X</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf X_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ，命令模型描述图片，于是指令数据集为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi mathvariant="bold">X</mi><mi>v</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mi>c</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mi>q</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\mathbf X_v, \mathbf X_c, \mathbf X_q\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 。<br />
然后填充到 Prompt 中，得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">X</mi><mi>q</mi></msub><msub><mi mathvariant="bold">X</mi><mi>v</mi></msub><mtext>&lt;STOP&gt; /n Assistant</mtext><mo>:</mo><msub><mi mathvariant="bold">X</mi><mi>c</mi></msub><mtext>&lt;STOP&gt; /n</mtext></mrow><annotation encoding="application/x-tex">\mathbf X_q \mathbf X_v \text{&lt;STOP&gt; /n Assistant} : \mathbf X_c \text{&lt;STOP&gt; /n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">&lt;STOP&gt; /n Assistant</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">&lt;STOP&gt; /n</span></span></span></span></span></p>
<p>但这种最直接的 instruct 比较简单，缺少了多样性和更进一步的推理能力，所以没使用这样的方法。<br />
为了缓解这个问题，使用 language-only GPT-4 or ChatGPT 构造其他类型的 Instruction。</p>
<p><u><b> Method 2 </u></b></p>
<p>首先考虑如何将视觉信息转化为 LM 看得懂的形式，也就是转化文本序列的形式，这里给出两种方法：</p>
<ol>
<li>直接用 Caption</li>
</ol>
<blockquote>
<p>prompt : What you see are provided with five sentences, describing the same image you<br />
are looking at.</p>
</blockquote>
<ol start="2">
<li>使用 Bounding boxes 进行目标检测，记录下每个 bounding box 的 object concept 和 spatial location。</li>
</ol>
<p><img src="https://cdn.mathpix.com/snip/images/v4pJGzlz_FGuD_EUeFPX4JDB8yoNay7dtghvhT5PVBs.original.fullsize.png" alt="" /></p>
<p>这里先使用人工标注的方法标注一些 seed examples ，然后用 in-context-learning + GPT4 构造。<br />
使用 CoCo 数据集，让 GPT-4 构造三种不同的 Instruction-following data ：</p>
<ol>
<li>
<p>Conversation : a conversation between the assistant and a person asking questions<br />
about this photo.</p>
<ul>
<li>content: object types, counting the objects, object actions, object locations, relative positions between objects.</li>
<li>Only questions that have definite answers are considered</li>
<li><strong>Table 10 for the detailed prompt.</strong></li>
</ul>
</li>
<li>
<p>Detailed description : a rich and comprehensive description</p>
<ul>
<li><strong>Table 9 for the detailed prompt.</strong></li>
<li>For each image, we randomly sample one question from the list to ask GPT-4 to generate the detailed description.</li>
</ul>
</li>
<li>
<p>Complex reasoning : in-depth reasoning questions</p>
<ul>
<li>The answers typically require a step-by-step reasoning process by following rigorous logic.</li>
</ul>
</li>
</ol>
<p>下面是构造的结果：<br />
<img src="https://cdn.mathpix.com/snip/images/7G-5ioPnJEB8dyjNmc1c_wsvobtfXGVA0b50q2M3XPw.original.fullsize.png" alt="" /></p>
<p>Prompt 模版可以参考论文</p>
<h2 id="训练"><a class="markdownIt-Anchor" href="#训练"></a> 训练</h2>
<p>首先预训练模型的模态认知对齐能力，然后微调模型生成能力。</p>
<ul>
<li>Stage 1: Pre-training for <strong>Feature Alignment</strong>, Only <strong>the projection matrix</strong> is updated, based on a subset of <strong>CC3M</strong> (including image-text pairs).
<ul>
<li>filter CC3M to <strong>595K</strong> image-text pairs: 这里对 CC3M 进行了处理，根据名词短语的出现频率进行过滤和去重，确保了样本数据的多样性和代表性。</li>
<li>将 image-text pair <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi mathvariant="bold">X</mi><mi>v</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mi>c</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\mathbf X_v, \mathbf X_c\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 通过「Method 1 : Instructions for brief image description」构造为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi mathvariant="bold">X</mi><mi>v</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mi>c</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mi>q</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\mathbf X_v, \mathbf X_c, \mathbf X_q\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 的形式。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">X</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf X_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 是从 table 8 中随机选的一条。</li>
<li>然后就可以被当作 one-turn conversation 进行预训练了。</li>
<li><strong>这一步其实和外部 GPT4 无关，就是多选择一个 prompt ，来构造对话数据。自回归损失来进行多模态对齐预训练倒是没见过，挺有新意。</strong></li>
</ul>
</li>
<li>Stage 2: Fine-tuning <strong>End-to-End</strong>, Both <strong>the projection matrix</strong> and <strong>LLM</strong> are updated for two different use scenarios:
<ul>
<li>Multi-modal Chatbot: fine-tuned on <strong>generated 158K multi-modal instruction-following data</strong> for daily user-oriented applications.</li>
<li>Science QA: fine-tuned on <strong>multi-modal reasoning dataset</strong> for the science domain.<br />
也是将多选题转换为单轮对话输入，进行训练。</li>
</ul>
</li>
</ul>
<h2 id="特点"><a class="markdownIt-Anchor" href="#特点"></a> 特点</h2>
<ul>
<li>
<p>重点在于如何构造多模态指令数据集， present the first attempt to use language-only GPT-4 to generate multi-modal language-image instruction-following data.</p>
</li>
<li>
<p>和 BLIP 2 不同，LLAVA 需要训练 LLM</p>
</li>
<li>
<p>虽然同样是两个阶段的范式，但是LLAVA 两阶段的任务是相同的，仅仅为 soft-token prefixed auto-regression Loss 。</p>
</li>
<li>
<p>LLaVA可以做出来GPT-4 文章里的 visual reasoning example的结果，还有较强的OCR的能力。<br />
Why OCR? 可能是使用了 CLIP 作为 visual backbone ，因为 CLIP 中有 OCR 的样本，所以视觉编码中蕴含了信息。<br />
感觉是因为CLIP。CLIP训练时对齐文本 token 的特征，那么视觉 backbone 出来的 token 特征是与文本相似的，从而有一种隐式的 OCR 能力吧。<br />
应该是clip本身的训练集，那个大规模的img-text pair应该是有ocr相关的数据的，clip的vision model应该是能提取到ocr相关的特征的，然后你们是用的freeze的clip vision model，所以感觉能做ocr并不奇怪.</p>
</li>
<li>
<p>最后要澄清的是关注点，这些项目都是 Data-Centric Project, 不是 Model-Centric Project. 随着现在及其以后模型上的差异逐渐在缩小，而影响结果是 data quality。我们release了自己的当下精调过的 multi-modal instruction following data, 以后大家可以利用起来来复现 multi-modal GPT-4的一些惊艳的能力；以及，利用我们构造数据的方案继续扩大规模，和提升质量。</p>
</li>
</ul>
<h1 id="llava-15"><a class="markdownIt-Anchor" href="#llava-15"></a> LLAVA 1.5</h1>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2310.03744">https://arxiv.org/abs/2310.03744</a></p>
<p>LLaVA 的挑战：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2307.01003">the inability to balance between short- and long-form VQA </a>。原因有两点</p>
<ol>
<li>ambiguous prompts on the response format. 所以这里额外添加了一句 prompt 。<br />
<img src="https://pic3.zhimg.com/80/v2-7ca0607f507149faf423309f18a97a5a_1440w.webp" alt="" /></li>
<li>not fine tuning the LLM. 比例 BLIP2/Instruct BLIP，没有训练 LLM，那么只能希望 QFormer 可以输出LLM理解的指令，但是这往往很难。</li>
</ol>
<p><strong>模型上：</strong></p>
<p>LLM模型：LLM语言模型升级为Vicuna v1.5 13B，语言模型参数量更大，效果更好<br />
Connector：也就是插值层，由原来的单个线性层替换为MLP层（多层线性层叠加）<br />
Vision Encoder: 输入图像分辨率由224增大为336，使用CLIP ViT-L/336px，对图像细节理解能力更强</p>
<p><strong>数据上：</strong></p>
<p>增加数据集/Academic task oriented data：添加了 VQA 数据集，还专注于 OCR 和区域级别识别的四个数据集。这些数据集包括需要广泛知识的 VQA（如 OKVQA 和 A-OKVQA）、需要 OCR 的 VQA（如 OCRVQA 和 TextCaps）等。同时，加入region-level VQA datasets (Visual Genome, RefCOCO).</p>
<p>额外拓展/Additional scaling：增加 GQA 数据集， ShareGPT 数据集，将LLM增大到13B ，</p>
<blockquote>
<p>参考Paper：<br />
An empirical study of scaling instruct-tuned large multimodal models<br />
Unleashing multimodal llm’s referential dialogue magic<br />
Qwen-vl: A frontier large vision-language model with versatile abilities</p>
</blockquote>
<p>最终的 13B 模型使用了 1.2M 公开数据进行训练。</p>
<h1 id="llava-16"><a class="markdownIt-Anchor" href="#llava-16"></a> LLaVA 1.6</h1>
<table>
<thead>
<tr>
<th style="text-align:center">Name</th>
<th style="text-align:center"></th>
<th style="text-align:center">LLaVA-1.6-7B <br> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7.06</mn><mrow><mtext> </mtext><mi mathvariant="normal">B</mi></mrow></mrow><annotation encoding="application/x-tex">7.06 \mathrm{~B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">.</span><span class="mord">0</span><span class="mord">6</span><span class="mord"><span class="mspace nobreak"> </span><span class="mord mathrm">B</span></span></span></span></span></th>
<th style="text-align:center">LLaVA-1.6-13B <br> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>13.35</mn><mi>B</mi></mrow><annotation encoding="application/x-tex">13.35 B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mord">.</span><span class="mord">3</span><span class="mord">5</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></th>
<th style="text-align:center">LLaVA-1.6-34B <br> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>34.75</mn><mrow><mtext> </mtext><mi mathvariant="normal">B</mi></mrow></mrow><annotation encoding="application/x-tex">34.75 \mathrm{~B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">4</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span><span class="mord"><span class="mspace nobreak"> </span><span class="mord mathrm">B</span></span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Model Size</td>
<td style="text-align:center">Total</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Vision Encoder</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>303.5</mn><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">303.5 \mathrm{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">3</span><span class="mord">.</span><span class="mord">5</span><span class="mord"><span class="mord mathrm">M</span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>303.5</mn><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">303.5 \mathrm{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">3</span><span class="mord">.</span><span class="mord">5</span><span class="mord"><span class="mord mathrm">M</span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>303.5</mn><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">303.5 \mathrm{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">3</span><span class="mord">.</span><span class="mord">5</span><span class="mord"><span class="mord mathrm">M</span></span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Connector</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>21</mn><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">21 \mathrm{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">1</span><span class="mord"><span class="mord mathrm">M</span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>31.5</mn><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">31.5 \mathrm{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord"><span class="mord mathrm">M</span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>58.7</mn><mi mathvariant="normal">M</mi></mrow><annotation encoding="application/x-tex">58.7 \mathrm{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">8</span><span class="mord">.</span><span class="mord">7</span><span class="mord"><span class="mord mathrm">M</span></span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">LLM</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6.74</mn><mrow><mtext> </mtext><mi mathvariant="normal">B</mi></mrow></mrow><annotation encoding="application/x-tex">6.74 \mathrm{~B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord">.</span><span class="mord">7</span><span class="mord">4</span><span class="mord"><span class="mspace nobreak"> </span><span class="mord mathrm">B</span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>13</mn><mi>B</mi></mrow><annotation encoding="application/x-tex">13 B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>34.39</mn><mi>B</mi></mrow><annotation encoding="application/x-tex">34.39 B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">4</span><span class="mord">.</span><span class="mord">3</span><span class="mord">9</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Resolution</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>336</mn><mo>×</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>4</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">336 \times[(2,2),(1,2),(2,1),(1,3),(3,1),(1,4),(4,1)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Stage-1</td>
<td style="text-align:center">Training Data</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>558</mn><mrow><mtext> </mtext><mi mathvariant="normal">K</mi></mrow></mrow><annotation encoding="application/x-tex">558 \mathrm{~K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">5</span><span class="mord">8</span><span class="mord"><span class="mspace nobreak"> </span><span class="mord mathrm">K</span></span></span></span></span></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Trainable Module</td>
<td style="text-align:center">Connector</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Stage-2</td>
<td style="text-align:center">Training Data</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>760</mn><mrow><mtext> </mtext><mi mathvariant="normal">K</mi></mrow></mrow><annotation encoding="application/x-tex">760 \mathrm{~K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">6</span><span class="mord">0</span><span class="mord"><span class="mspace nobreak"> </span><span class="mord mathrm">K</span></span></span></span></span></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Trainable Module</td>
<td style="text-align:center">Full model</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Compute (#GPU x #Hours)</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>×</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">8 \times 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn><mo>×</mo><mn>24</mn></mrow><annotation encoding="application/x-tex">16 \times 24</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">4</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn><mo>×</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">32 \times 30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">0</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Training Data (#Samples)</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1318</mn><mi>K</mi></mrow><annotation encoding="application/x-tex">1318 K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mord">1</span><span class="mord">8</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p><strong>模型参数量：</strong> LLM 参数量从原本的 13B 来到了 34B</p>
<p><strong>动态高分辨率：</strong> 分辨率提升到4倍，即允许672x672, 336x1344, 1344x336 几种分辨率的输入 。<br />
将原本的高分辨率图片切分为 smaller image patches （和训练时分辨率一致），然后独立地将他们进行编码 ，然后作为 visual token 给到 LLM 。</p>
<p><strong>数据混合：</strong></p>
<ul>
<li>LAION-GPT-V 和 ShareGPT-4V 的数据，这些数据是GPT-4V生成的，质量很高；</li>
<li>为了增强多样性，他们通过demo收集了15k大家的问题，通过他们的llava demo，在保证用户隐私的情况下，用GPT-4V生成了一些答案</li>
<li>TextCaps和TextVQA用了完全相同训练图片，所以在TextCaps上训练之后就不能测试TextVQA的结果了，他们去掉了TextCaps的数据</li>
<li>为了增强OCR的能力他们加入了DocVQA和SynDog-EN两个OCR数据集；</li>
<li>为了加强图表理解能力，他们加入了ChartQA, DVQA, 和 AI2D</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-e0fc3040e881b78cd3ad82dff6ab8fb0_1440w.webp" alt="" /></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/10/20/NLP/LLM/BaiChuan/" rel="prev" title="BaiChuan">
      <i class="fa fa-chevron-left"></i> BaiChuan
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/11/03/NLP/LLM/Transformer%20%E5%8F%82%E6%95%B0%E9%87%8F%EF%BC%9B%E6%98%BE%E5%AD%98%EF%BC%9BFlops%20%E5%88%86%E6%9E%90/" rel="next" title="Transformer 参数量；显存；Flops 分析">
      Transformer 参数量；显存；Flops 分析 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#llava"><span class="nav-number">1.</span> <span class="nav-text"> LLAVA</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#data"><span class="nav-number">1.1.</span> <span class="nav-text"> Data</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="nav-number">1.1.1.</span> <span class="nav-text"> 构造方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%AD%E7%BB%83"><span class="nav-number">1.2.</span> <span class="nav-text"> 训练</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">1.3.</span> <span class="nav-text"> 特点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#llava-15"><span class="nav-number">2.</span> <span class="nav-text"> LLAVA 1.5</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#llava-16"><span class="nav-number">3.</span> <span class="nav-text"> LLaVA 1.6</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">A foolish, slow learner.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">338</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/YiandLi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;YiandLi" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/yiliiiii" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yiliiiii" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">578k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">48:11</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
